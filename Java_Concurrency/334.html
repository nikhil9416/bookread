<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p334" style="overflow: hidden; position: relative; background-color: white; width: 662px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_334{left:57px;bottom:942px;letter-spacing:0.2px;}
#t2_334{left:72px;bottom:942px;}
#t3_334{left:76px;bottom:942px;}
#t4_334{left:84px;bottom:942px;letter-spacing:0.1px;word-spacing:5.41px;}
#t5_334{left:584px;bottom:942px;letter-spacing:0.2px;}
#t6_334{left:57px;bottom:893px;letter-spacing:0.08px;word-spacing:0.71px;}
#t7_334{left:57px;bottom:852px;letter-spacing:-0.25px;}
#t8_334{left:73px;bottom:852px;}
#t9_334{left:78px;bottom:852px;}
#ta_334{left:86px;bottom:852px;}
#tb_334{left:90px;bottom:852px;}
#tc_334{left:115px;bottom:852px;letter-spacing:-0.21px;word-spacing:0.77px;}
#td_334{left:57px;bottom:825px;letter-spacing:0.05px;}
#te_334{left:158px;bottom:824px;letter-spacing:0.08px;word-spacing:2.05px;}
#tf_334{left:230px;bottom:824px;letter-spacing:0.2px;}
#tg_334{left:245px;bottom:824px;}
#th_334{left:249px;bottom:824px;letter-spacing:0.2px;}
#ti_334{left:270px;bottom:824px;letter-spacing:0.11px;word-spacing:1.87px;}
#tj_334{left:57px;bottom:806px;letter-spacing:0.05px;word-spacing:2.41px;}
#tk_334{left:206px;bottom:807px;letter-spacing:0.05px;}
#tl_334{left:252px;bottom:806px;letter-spacing:0.14px;}
#tm_334{left:284px;bottom:807px;letter-spacing:0.05px;}
#tn_334{left:331px;bottom:806px;letter-spacing:0.09px;word-spacing:2.42px;}
#to_334{left:57px;bottom:788px;letter-spacing:0.05px;word-spacing:0.2px;}
#tp_334{left:409px;bottom:789px;letter-spacing:0.05px;}
#tq_334{left:452px;bottom:788px;letter-spacing:0.08px;word-spacing:-0.06px;}
#tr_334{left:57px;bottom:770px;letter-spacing:0.07px;word-spacing:0.32px;}
#ts_334{left:361px;bottom:770px;letter-spacing:0.05px;}
#tt_334{left:409px;bottom:770px;letter-spacing:0.09px;}
#tu_334{left:57px;bottom:751px;letter-spacing:0.08px;word-spacing:0.63px;}
#tv_334{left:57px;bottom:716px;letter-spacing:0.05px;}
#tw_334{left:57px;bottom:698px;letter-spacing:0.05px;word-spacing:5.25px;}
#tx_334{left:89px;bottom:680px;letter-spacing:0.06px;word-spacing:4.97px;}
#ty_334{left:89px;bottom:643px;letter-spacing:0.09px;word-spacing:4.87px;}
#tz_334{left:89px;bottom:606px;letter-spacing:0.06px;word-spacing:5.05px;}
#t10_334{left:470px;bottom:606px;}
#t11_334{left:120px;bottom:588px;letter-spacing:0.11px;}
#t12_334{left:89px;bottom:570px;}
#t13_334{left:89px;bottom:534px;letter-spacing:0.06px;word-spacing:5.09px;}
#t14_334{left:518px;bottom:534px;}
#t15_334{left:120px;bottom:515px;letter-spacing:0.09px;word-spacing:5px;}
#t16_334{left:152px;bottom:497px;letter-spacing:0.05px;word-spacing:4.97px;}
#t17_334{left:152px;bottom:479px;letter-spacing:0.08px;word-spacing:4.83px;}
#t18_334{left:120px;bottom:460px;}
#t19_334{left:120px;bottom:424px;letter-spacing:0.09px;word-spacing:5.01px;}
#t1a_334{left:152px;bottom:406px;letter-spacing:0.1px;}
#t1b_334{left:256px;bottom:406px;letter-spacing:0.05px;word-spacing:4.91px;}
#t1c_334{left:152px;bottom:387px;letter-spacing:0.07px;word-spacing:5.2px;}
#t1d_334{left:256px;bottom:387px;letter-spacing:0.05px;word-spacing:4.95px;}
#t1e_334{left:120px;bottom:351px;}
#t1f_334{left:89px;bottom:333px;}
#t1g_334{left:57px;bottom:314px;}
#t1h_334{left:112px;bottom:285px;}
#t1i_334{left:121px;bottom:285px;letter-spacing:0.15px;word-spacing:0.24px;}
#t1j_334{left:184px;bottom:285px;}
#t1k_334{left:188px;bottom:285px;letter-spacing:0.2px;}
#t1l_334{left:203px;bottom:285px;letter-spacing:0.12px;word-spacing:0.78px;}
#t1m_334{left:340px;bottom:286px;letter-spacing:0.1px;}
#t1n_334{left:547px;bottom:285px;}
#t1o_334{left:80px;bottom:236px;letter-spacing:0.1px;}
#t1p_334{left:99px;bottom:237px;letter-spacing:0.05px;}
#t1q_334{left:194px;bottom:236px;letter-spacing:0.1px;word-spacing:1.91px;}
#t1r_334{left:57px;bottom:218px;letter-spacing:0.1px;word-spacing:4.89px;}
#t1s_334{left:135px;bottom:219px;letter-spacing:0.05px;}
#t1t_334{left:180px;bottom:218px;letter-spacing:0.1px;word-spacing:1.9px;}
#t1u_334{left:273px;bottom:219px;letter-spacing:0.1px;}
#t1v_334{left:486px;bottom:218px;letter-spacing:0.1px;word-spacing:1.75px;}
#t1w_334{left:57px;bottom:199px;letter-spacing:0.09px;word-spacing:0.96px;}
#t1x_334{left:176px;bottom:200px;letter-spacing:0.08px;}
#t1y_334{left:309px;bottom:199px;letter-spacing:0.08px;word-spacing:1.06px;}
#t1z_334{left:383px;bottom:200px;letter-spacing:0.05px;}
#t20_334{left:478px;bottom:199px;letter-spacing:0.09px;word-spacing:3.24px;}
#t21_334{left:519px;bottom:200px;letter-spacing:0.05px;}
#t22_334{left:57px;bottom:182px;letter-spacing:0.05px;}
#t23_334{left:109px;bottom:181px;letter-spacing:0.08px;word-spacing:0.2px;}
#t24_334{left:57px;bottom:163px;letter-spacing:0.09px;word-spacing:0.93px;}
#t25_334{left:425px;bottom:164px;letter-spacing:0.06px;}
#t26_334{left:557px;bottom:163px;letter-spacing:0.14px;}
#t27_334{left:57px;bottom:145px;letter-spacing:0.08px;word-spacing:1.4px;}
#t28_334{left:57px;bottom:126px;letter-spacing:0.1px;word-spacing:2.05px;}
#t29_334{left:300px;bottom:127px;letter-spacing:0.1px;}
#t2a_334{left:513px;bottom:126px;letter-spacing:0.06px;word-spacing:1.66px;}
#t2b_334{left:57px;bottom:108px;letter-spacing:0.09px;word-spacing:1.85px;}
#t2c_334{left:57px;bottom:90px;letter-spacing:-0.01px;word-spacing:2.31px;}
#t2d_334{left:185px;bottom:91px;letter-spacing:0.05px;}
#t2e_334{left:238px;bottom:90px;letter-spacing:0.09px;}
#t2f_334{left:272px;bottom:91px;letter-spacing:0.05px;}
#t2g_334{left:374px;bottom:90px;letter-spacing:0.11px;word-spacing:1.49px;}
#t2h_334{left:479px;bottom:91px;letter-spacing:0.06px;}
#t2i_334{left:57px;bottom:72px;letter-spacing:0.1px;word-spacing:1.15px;}
#t2j_334{left:200px;bottom:72px;letter-spacing:0.08px;}
#t2k_334{left:332px;bottom:72px;letter-spacing:0.08px;word-spacing:0.88px;}
#t2l_334{left:57px;bottom:53px;letter-spacing:0.09px;word-spacing:1.03px;}

.s0_334{font-size:15px;font-family:TeXPalladioL-ItalicOsF_amn;color:#000;}
.s1_334{font-size:15px;font-family:Palatino-Italic_amd;color:#000;}
.s2_334{font-size:15px;font-family:TeXPalladioL-SC_amc;color:#000;}
.s3_334{font-size:15px;font-family:Palatino-Roman_ame;color:#000;}
.s4_334{font-size:17px;font-family:TeXPalladioL-BoldOsF_aml;color:#000;}
.s5_334{font-size:17px;font-family:Palatino-Bold_amf;color:#000;}
.s6_334{font-size:13px;font-family:LucidaSansTypewriter_amm;color:#000;}
.s7_334{font-size:13px;font-family:LucidaSansTypewriter-Obl_amo;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts334" type="text/css" >

@font-face {
	font-family: LucidaSansTypewriter-Obl_amo;
	src: url("fonts/LucidaSansTypewriter-Obl_amo.woff") format("woff");
}

@font-face {
	font-family: LucidaSansTypewriter_amm;
	src: url("fonts/LucidaSansTypewriter_amm.woff") format("woff");
}

@font-face {
	font-family: Palatino-Bold_amf;
	src: url("fonts/Palatino-Bold_amf.woff") format("woff");
}

@font-face {
	font-family: Palatino-Italic_amd;
	src: url("fonts/Palatino-Italic_amd.woff") format("woff");
}

@font-face {
	font-family: Palatino-Roman_ame;
	src: url("fonts/Palatino-Roman_ame.woff") format("woff");
}

@font-face {
	font-family: TeXPalladioL-BoldOsF_aml;
	src: url("fonts/TeXPalladioL-BoldOsF_aml.woff") format("woff");
}

@font-face {
	font-family: TeXPalladioL-ItalicOsF_amn;
	src: url("fonts/TeXPalladioL-ItalicOsF_amn.woff") format("woff");
}

@font-face {
	font-family: TeXPalladioL-SC_amc;
	src: url("fonts/TeXPalladioL-SC_amc.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg334Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg334" style="-webkit-user-select: none;"><object width="662" height="1017" data="334/334.svg" type="image/svg+xml" id="pdf334" style="width:662px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_334" class="t s0_334">14</span><span id="t2_334" class="t s1_334">.</span><span id="t3_334" class="t s0_334">5</span><span id="t4_334" class="t s1_334">. AbstractQueuedSynchronizer </span><span id="t5_334" class="t s2_334">313 </span>
<span id="t6_334" class="t s3_334">associated with synchronizers. </span>
<span id="t7_334" class="t s4_334">14</span><span id="t8_334" class="t s5_334">.</span><span id="t9_334" class="t s4_334">5</span><span id="ta_334" class="t s5_334">.</span><span id="tb_334" class="t s4_334">1 </span><span id="tc_334" class="t s5_334">A simple latch </span>
<span id="td_334" class="t s6_334">OneShotLatch </span><span id="te_334" class="t s3_334">in Listing </span><span id="tf_334" class="t s2_334">14</span><span id="tg_334" class="t s3_334">.</span><span id="th_334" class="t s2_334">14 </span><span id="ti_334" class="t s3_334">is a binary latch implemented using AQS. It has </span>
<span id="tj_334" class="t s3_334">two public methods, </span><span id="tk_334" class="t s6_334">await </span><span id="tl_334" class="t s3_334">and </span><span id="tm_334" class="t s6_334">signal</span><span id="tn_334" class="t s3_334">, that correspond to acquisition and re- </span>
<span id="to_334" class="t s3_334">lease. Initially, the latch is closed; any thread calling </span><span id="tp_334" class="t s6_334">await </span><span id="tq_334" class="t s3_334">blocks until the latch is </span>
<span id="tr_334" class="t s3_334">opened. Once the latch is opened by a call to </span><span id="ts_334" class="t s6_334">signal</span><span id="tt_334" class="t s3_334">, waiting threads are released </span>
<span id="tu_334" class="t s3_334">and threads that subsequently arrive at the latch will be allowed to proceed. </span>
<span id="tv_334" class="t s6_334">@ThreadSafe </span>
<span id="tw_334" class="t s6_334">public class OneShotLatch { </span>
<span id="tx_334" class="t s6_334">private final Sync sync = new Sync(); </span>
<span id="ty_334" class="t s6_334">public void signal() { sync.releaseShared(0); } </span>
<span id="tz_334" class="t s6_334">public void await() throws InterruptedException </span><span id="t10_334" class="t s6_334">{ </span>
<span id="t11_334" class="t s6_334">sync.acquireSharedInterruptibly(0); </span>
<span id="t12_334" class="t s6_334">} </span>
<span id="t13_334" class="t s6_334">private class Sync extends AbstractQueuedSynchronizer </span><span id="t14_334" class="t s6_334">{ </span>
<span id="t15_334" class="t s6_334">protected int tryAcquireShared(int ignored) { </span>
<span id="t16_334" class="t s7_334">// Succeed if latch is open (state == 1), else fail </span>
<span id="t17_334" class="t s6_334">return (getState() == 1) ? 1 : -1; </span>
<span id="t18_334" class="t s6_334">} </span>
<span id="t19_334" class="t s6_334">protected boolean tryReleaseShared(int ignored) { </span>
<span id="t1a_334" class="t s6_334">setState(1); </span><span id="t1b_334" class="t s7_334">// Latch is now open </span>
<span id="t1c_334" class="t s6_334">return true; </span><span id="t1d_334" class="t s7_334">// Other threads may now be able to acquire </span>
<span id="t1e_334" class="t s6_334">} </span>
<span id="t1f_334" class="t s6_334">} </span>
<span id="t1g_334" class="t s6_334">} </span>
<span id="t1h_334" class="t s3_334">L</span><span id="t1i_334" class="t s2_334">isting 14</span><span id="t1j_334" class="t s3_334">.</span><span id="t1k_334" class="t s2_334">14</span><span id="t1l_334" class="t s3_334">. Binary latch using </span><span id="t1m_334" class="t s6_334">AbstractQueuedSynchronizer</span><span id="t1n_334" class="t s3_334">. </span>
<span id="t1o_334" class="t s3_334">In </span><span id="t1p_334" class="t s6_334">OneShotLatch</span><span id="t1q_334" class="t s3_334">, the AQS state holds the latch state—closed (zero) or open </span>
<span id="t1r_334" class="t s3_334">(one). The </span><span id="t1s_334" class="t s6_334">await </span><span id="t1t_334" class="t s3_334">method calls </span><span id="t1u_334" class="t s6_334">acquireSharedInterruptibly </span><span id="t1v_334" class="t s3_334">in AQS, which in </span>
<span id="t1w_334" class="t s3_334">turn consults the </span><span id="t1x_334" class="t s6_334">tryAcquireShared </span><span id="t1y_334" class="t s3_334">method in </span><span id="t1z_334" class="t s6_334">OneShotLatch</span><span id="t20_334" class="t s3_334">. The </span><span id="t21_334" class="t s6_334">tryAcquire- </span>
<span id="t22_334" class="t s6_334">Shared </span><span id="t23_334" class="t s3_334">implementation must return a value indicating whether or not acquisition </span>
<span id="t24_334" class="t s3_334">can proceed. If the latch has been previously opened, </span><span id="t25_334" class="t s6_334">tryAcquireShared </span><span id="t26_334" class="t s3_334">returns </span>
<span id="t27_334" class="t s3_334">success, allowing the thread to pass; otherwise it returns a value indicating that </span>
<span id="t28_334" class="t s3_334">the acquisition attempt failed. The </span><span id="t29_334" class="t s6_334">acquireSharedInterruptibly </span><span id="t2a_334" class="t s3_334">method inter- </span>
<span id="t2b_334" class="t s3_334">prets failure to mean that the thread should be placed on the queue of waiting </span>
<span id="t2c_334" class="t s3_334">threads. Similarly, </span><span id="t2d_334" class="t s6_334">signal </span><span id="t2e_334" class="t s3_334">calls </span><span id="t2f_334" class="t s6_334">releaseShared</span><span id="t2g_334" class="t s3_334">, which causes </span><span id="t2h_334" class="t s6_334">tryReleaseShared </span>
<span id="t2i_334" class="t s3_334">to be consulted. The </span><span id="t2j_334" class="t s6_334">tryReleaseShared </span><span id="t2k_334" class="t s3_334">implementation unconditionally sets the </span>
<span id="t2l_334" class="t s3_334">latch state to open and indicates (through its return value) that the synchronizer </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
