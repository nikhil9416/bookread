<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p595" style="overflow: hidden; position: relative; background-color: white; width: 770px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_595{left:492px;bottom:947px;letter-spacing:1.63px;}
#t2_595{left:533px;bottom:947px;letter-spacing:1.67px;word-spacing:-0.28px;}
#t3_595{left:681px;bottom:946px;letter-spacing:-0.17px;}
#t4_595{left:121px;bottom:893px;letter-spacing:0.07px;word-spacing:2.62px;}
#t5_595{left:121px;bottom:874px;letter-spacing:0.08px;word-spacing:3.55px;}
#t6_595{left:121px;bottom:856px;letter-spacing:0.08px;word-spacing:1.84px;}
#t7_595{left:121px;bottom:838px;letter-spacing:0.07px;word-spacing:0.45px;}
#t8_595{left:121px;bottom:819px;letter-spacing:0.09px;word-spacing:1.31px;}
#t9_595{left:105px;bottom:786px;}
#ta_595{left:121px;bottom:786px;letter-spacing:0.11px;word-spacing:0.14px;}
#tb_595{left:279px;bottom:786px;letter-spacing:0.08px;word-spacing:-0.33px;}
#tc_595{left:121px;bottom:768px;letter-spacing:0.07px;word-spacing:0.45px;}
#td_595{left:121px;bottom:749px;letter-spacing:0.08px;word-spacing:1.79px;}
#te_595{left:121px;bottom:731px;letter-spacing:0.09px;word-spacing:2.24px;}
#tf_595{left:121px;bottom:713px;letter-spacing:0.05px;word-spacing:1.3px;}
#tg_595{left:121px;bottom:695px;letter-spacing:0.09px;word-spacing:2.56px;}
#th_595{left:121px;bottom:676px;letter-spacing:0.07px;word-spacing:2.11px;}
#ti_595{left:121px;bottom:658px;letter-spacing:0.07px;word-spacing:1.85px;}
#tj_595{left:121px;bottom:640px;letter-spacing:0.09px;word-spacing:1.29px;}
#tk_595{left:105px;bottom:606px;}
#tl_595{left:121px;bottom:606px;letter-spacing:0.05px;word-spacing:3.08px;}
#tm_595{left:557px;bottom:606px;letter-spacing:0.01px;word-spacing:2.89px;}
#tn_595{left:121px;bottom:588px;letter-spacing:0.06px;word-spacing:0.36px;}
#to_595{left:121px;bottom:570px;letter-spacing:0.08px;word-spacing:0.98px;}
#tp_595{left:121px;bottom:552px;letter-spacing:0.05px;word-spacing:0.29px;}
#tq_595{left:224px;bottom:552px;}
#tr_595{left:236px;bottom:552px;letter-spacing:0.06px;word-spacing:0.27px;}
#ts_595{left:121px;bottom:533px;letter-spacing:0.06px;word-spacing:0.59px;}
#tt_595{left:121px;bottom:515px;letter-spacing:0.04px;word-spacing:0.46px;}
#tu_595{left:121px;bottom:497px;letter-spacing:0.07px;word-spacing:1.3px;}
#tv_595{left:121px;bottom:479px;letter-spacing:0.05px;word-spacing:1.65px;}
#tw_595{left:121px;bottom:460px;letter-spacing:0.1px;word-spacing:0.65px;}
#tx_595{left:121px;bottom:442px;letter-spacing:0.1px;word-spacing:1.28px;}
#ty_595{left:121px;bottom:416px;letter-spacing:0.08px;word-spacing:2.88px;}
#tz_595{left:121px;bottom:398px;letter-spacing:0.09px;word-spacing:2.44px;}
#t10_595{left:121px;bottom:380px;letter-spacing:0.09px;word-spacing:1.29px;}
#t11_595{left:105px;bottom:346px;}
#t12_595{left:121px;bottom:346px;word-spacing:2.64px;}
#t13_595{left:121px;bottom:328px;letter-spacing:0.12px;}
#t14_595{left:168px;bottom:328px;letter-spacing:0.04px;word-spacing:3.43px;}
#t15_595{left:121px;bottom:310px;letter-spacing:0.08px;word-spacing:2.58px;}
#t16_595{left:121px;bottom:291px;letter-spacing:0.08px;word-spacing:1.3px;}
#t17_595{left:121px;bottom:273px;letter-spacing:0.09px;word-spacing:1.25px;}
#t18_595{left:121px;bottom:255px;letter-spacing:0.08px;word-spacing:1.32px;}
#t19_595{left:121px;bottom:229px;letter-spacing:0.07px;word-spacing:1.93px;}
#t1a_595{left:121px;bottom:211px;letter-spacing:0.1px;word-spacing:2.89px;}
#t1b_595{left:549px;bottom:211px;}
#t1c_595{left:564px;bottom:211px;letter-spacing:0.09px;word-spacing:2.9px;}
#t1d_595{left:121px;bottom:192px;letter-spacing:0.11px;}
#t1e_595{left:186px;bottom:192px;letter-spacing:0.1px;}
#t1f_595{left:226px;bottom:192px;}
#t1g_595{left:239px;bottom:192px;letter-spacing:0.06px;}
#t1h_595{left:253px;bottom:192px;}
#t1i_595{left:266px;bottom:192px;letter-spacing:0.11px;word-spacing:1.09px;}
#t1j_595{left:488px;bottom:192px;}
#t1k_595{left:497px;bottom:192px;letter-spacing:0.09px;word-spacing:1.11px;}
#t1l_595{left:533px;bottom:192px;letter-spacing:0.61px;}
#t1m_595{left:575px;bottom:192px;}
#t1n_595{left:581px;bottom:192px;}
#t1o_595{left:588px;bottom:192px;letter-spacing:0.52px;word-spacing:0.26px;}
#t1p_595{left:121px;bottom:174px;letter-spacing:0.06px;word-spacing:0.68px;}
#t1q_595{left:418px;bottom:174px;}
#t1r_595{left:433px;bottom:174px;letter-spacing:0.07px;word-spacing:0.68px;}
#t1s_595{left:585px;bottom:174px;}
#t1t_595{left:593px;bottom:174px;letter-spacing:0.1px;word-spacing:0.61px;}
#t1u_595{left:121px;bottom:156px;letter-spacing:0.06px;word-spacing:1.37px;}
#t1v_595{left:239px;bottom:156px;}
#t1w_595{left:258px;bottom:156px;letter-spacing:0.08px;word-spacing:1.33px;}
#t1x_595{left:516px;bottom:156px;}
#t1y_595{left:525px;bottom:156px;letter-spacing:-0.22px;}
#t1z_595{left:550px;bottom:156px;}
#t20_595{left:566px;bottom:156px;}
#t21_595{left:579px;bottom:156px;}
#t22_595{left:595px;bottom:156px;}
#t23_595{left:604px;bottom:156px;letter-spacing:-0.25px;}
#t24_595{left:121px;bottom:138px;letter-spacing:0.12px;}
#t25_595{left:150px;bottom:138px;}
#t26_595{left:158px;bottom:137px;letter-spacing:-0.22px;}
#t27_595{left:183px;bottom:138px;}
#t28_595{left:199px;bottom:138px;}
#t29_595{left:211px;bottom:138px;}
#t2a_595{left:227px;bottom:138px;}
#t2b_595{left:235px;bottom:137px;letter-spacing:-0.25px;}
#t2c_595{left:263px;bottom:138px;letter-spacing:-0.05px;word-spacing:1.58px;}
#t2d_595{left:117px;bottom:108px;}
#t2e_595{left:132px;bottom:108px;}
#t2f_595{left:145px;bottom:108px;letter-spacing:0.52px;}
#t2g_595{left:180px;bottom:108px;}
#t2h_595{left:185px;bottom:108px;}
#t2i_595{left:193px;bottom:108px;letter-spacing:0.1px;}
#t2j_595{left:214px;bottom:108px;letter-spacing:2.24px;}
#t2k_595{left:226px;bottom:108px;letter-spacing:0.1px;}
#t2l_595{left:248px;bottom:108px;}
#t2m_595{left:255px;bottom:108px;}
#t2n_595{left:268px;bottom:108px;letter-spacing:0.52px;}
#t2o_595{left:303px;bottom:108px;}
#t2p_595{left:308px;bottom:108px;}
#t2q_595{left:316px;bottom:108px;letter-spacing:0.1px;}
#t2r_595{left:337px;bottom:108px;letter-spacing:2.24px;}
#t2s_595{left:349px;bottom:108px;letter-spacing:0.09px;}
#t2t_595{left:368px;bottom:108px;}
#t2u_595{left:376px;bottom:108px;}
#t2v_595{left:389px;bottom:108px;letter-spacing:0.52px;}
#t2w_595{left:424px;bottom:108px;}
#t2x_595{left:429px;bottom:108px;}
#t2y_595{left:436px;bottom:108px;letter-spacing:0.09px;}
#t2z_595{left:456px;bottom:108px;letter-spacing:2.26px;}
#t30_595{left:468px;bottom:108px;letter-spacing:0.1px;}
#t31_595{left:489px;bottom:108px;letter-spacing:3.01px;}
#t32_595{left:510px;bottom:108px;letter-spacing:0.52px;}
#t33_595{left:545px;bottom:108px;}
#t34_595{left:550px;bottom:108px;}
#t35_595{left:557px;bottom:108px;letter-spacing:0.09px;}
#t36_595{left:576px;bottom:108px;letter-spacing:2.24px;}
#t37_595{left:589px;bottom:108px;letter-spacing:0.09px;}
#t38_595{left:608px;bottom:108px;}

.s1_595{font-size:12px;font-family:CMR8_dy;color:#000;}
.s2_595{font-size:14px;font-family:CMBX10_e1;color:#000;}
.s3_595{font-size:15px;font-family:CMR10_fh;color:#000;}
.s4_595{font-size:15px;font-family:CMSY10_f9;color:#000;}
.s5_595{font-size:15px;font-family:CMTI10_fd;color:#000;}
.s6_595{font-size:15px;font-family:CMMI10_ib;color:#000;}
.s7_595{font-size:11px;font-family:CMR7_ij;color:#000;}
.s8_595{font-size:12px;font-family:CMMI8_1dq;color:#000;}
.s9_595{font-size:9px;font-family:CMR6_e6;color:#000;}
.sa_595{font-size:12px;font-family:CMSY8_lr;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts595" type="text/css" >

@font-face {
	font-family: CMBX10_e1;
	src: url("fonts/CMBX10_e1.woff") format("woff");
}

@font-face {
	font-family: CMMI10_ib;
	src: url("fonts/CMMI10_ib.woff") format("woff");
}

@font-face {
	font-family: CMMI8_1dq;
	src: url("fonts/CMMI8_1dq.woff") format("woff");
}

@font-face {
	font-family: CMR10_fh;
	src: url("fonts/CMR10_fh.woff") format("woff");
}

@font-face {
	font-family: CMR6_e6;
	src: url("fonts/CMR6_e6.woff") format("woff");
}

@font-face {
	font-family: CMR7_ij;
	src: url("fonts/CMR7_ij.woff") format("woff");
}

@font-face {
	font-family: CMR8_dy;
	src: url("fonts/CMR8_dy.woff") format("woff");
}

@font-face {
	font-family: CMSY10_f9;
	src: url("fonts/CMSY10_f9.woff") format("woff");
}

@font-face {
	font-family: CMSY8_lr;
	src: url("fonts/CMSY8_lr.woff") format("woff");
}

@font-face {
	font-family: CMTI10_fd;
	src: url("fonts/CMTI10_fd.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg595Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg595" style="-webkit-user-select: none;"><object width="770" height="1017" data="595/595.svg" type="image/svg+xml" id="pdf595" style="width:770px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_595" class="t s1_595">17.6 </span><span id="t2_595" class="t s1_595">RANGE SEARCH </span><span id="t3_595" class="t s2_595">585 </span>
<span id="t4_595" class="t s3_595">When querying against a nonconvex polygon, it will pay to partition your </span>
<span id="t5_595" class="t s3_595">polygon into convex pieces or (even better) triangles and then query the </span>
<span id="t6_595" class="t s3_595">point set against each one of the pieces. This works because it is quick and </span>
<span id="t7_595" class="t s3_595">easy to test whether a point lies inside a convex polygon. Algorithms for such </span>
<span id="t8_595" class="t s3_595">convex decompositions are discussed in Section 17.11 (page 601). </span>
<span id="t9_595" class="t s4_595">• </span><span id="ta_595" class="t s5_595">How many dimensions? </span><span id="tb_595" class="t s3_595">– A general approach to range queries builds a kd-tree </span>
<span id="tc_595" class="t s3_595">on the point set, as discussed in Section 12.6 (page 389). A depth-ﬁrst traver- </span>
<span id="td_595" class="t s3_595">sal of the kd-tree is performed for the query, with each tree node expanded </span>
<span id="te_595" class="t s3_595">only if the associated rectangle intersects the query region. The entire tree </span>
<span id="tf_595" class="t s3_595">might have to be traversed for suﬃciently large or misaligned query regions, </span>
<span id="tg_595" class="t s3_595">but in general kd-trees lead to an eﬃcient solution. Algorithms with more </span>
<span id="th_595" class="t s3_595">eﬃcient worst-case performance are known in two dimensions, but kd-trees </span>
<span id="ti_595" class="t s3_595">are likely to work just ﬁne in the plane. In higher dimensions, they provide </span>
<span id="tj_595" class="t s3_595">the only viable solution to the problem. </span>
<span id="tk_595" class="t s4_595">• </span><span id="tl_595" class="t s5_595">Is your point set static, or might there be insertions/deletions? </span><span id="tm_595" class="t s3_595">– A clever </span>
<span id="tn_595" class="t s3_595">practical approach to range search and many other geometric searching prob- </span>
<span id="to_595" class="t s3_595">lems is based on Delaunay triangulations. Delaunay triangulation edges con- </span>
<span id="tp_595" class="t s3_595">nect each point </span><span id="tq_595" class="t s6_595">p </span><span id="tr_595" class="t s3_595">to nearby points, including its nearest neighbor. To perform </span>
<span id="ts_595" class="t s3_595">a range query, we start by using planar point location (see Section 17.7 (page </span>
<span id="tt_595" class="t s3_595">587)) to quickly identify a triangle within the region of interest. We then do a </span>
<span id="tu_595" class="t s3_595">depth-ﬁrst search around a vertex of this triangle, pruning the search when- </span>
<span id="tv_595" class="t s3_595">ever it visits a point too distant to have interesting undiscovered neighbors. </span>
<span id="tw_595" class="t s3_595">This should be eﬃcient, because the total number of points visited should be </span>
<span id="tx_595" class="t s3_595">roughly proportional to the number within the query region. </span>
<span id="ty_595" class="t s3_595">One nice thing about this approach is that it is relatively easy to employ </span>
<span id="tz_595" class="t s3_595">“edge-ﬂip” operations to ﬁx up a Delaunay triangulation following a point </span>
<span id="t10_595" class="t s3_595">insertion or deletion. See Section 17.3 (page 572) for more details. </span>
<span id="t11_595" class="t s4_595">• </span><span id="t12_595" class="t s5_595">Can I just count the number of points in a region, or do I have to identify </span>
<span id="t13_595" class="t s5_595">them? </span><span id="t14_595" class="t s3_595">– For many applications, it suﬃces to count the number of points </span>
<span id="t15_595" class="t s3_595">in a region instead of returning them. Harkening back to the introductory </span>
<span id="t16_595" class="t s3_595">example, we may want to know whether there are more thin/poor people or </span>
<span id="t17_595" class="t s3_595">rich/fat ones. The need to ﬁnd the densest or emptiest region in space often </span>
<span id="t18_595" class="t s3_595">arises, and this problem can be solved by counting range queries. </span>
<span id="t19_595" class="t s3_595">A nice data structure for eﬃciently answering such aggregate range queries </span>
<span id="t1a_595" class="t s3_595">is based on the dominance ordering of the point set. A point </span><span id="t1b_595" class="t s6_595">x </span><span id="t1c_595" class="t s3_595">is said to </span>
<span id="t1d_595" class="t s5_595">dominate </span><span id="t1e_595" class="t s3_595">point </span><span id="t1f_595" class="t s6_595">y </span><span id="t1g_595" class="t s3_595">if </span><span id="t1h_595" class="t s6_595">y </span><span id="t1i_595" class="t s3_595">lies both below and to the left of </span><span id="t1j_595" class="t s6_595">x</span><span id="t1k_595" class="t s3_595">. Let </span><span id="t1l_595" class="t s6_595">DOM </span><span id="t1m_595" class="t s3_595">(</span><span id="t1n_595" class="t s6_595">p</span><span id="t1o_595" class="t s3_595">) be a </span>
<span id="t1p_595" class="t s3_595">function that counts the number of points in </span><span id="t1q_595" class="t s6_595">S </span><span id="t1r_595" class="t s3_595">that are dominated by </span><span id="t1s_595" class="t s6_595">p</span><span id="t1t_595" class="t s3_595">. The </span>
<span id="t1u_595" class="t s3_595">number of points </span><span id="t1v_595" class="t s6_595">m </span><span id="t1w_595" class="t s3_595">in the orthogonal rectangle deﬁned by </span><span id="t1x_595" class="t s6_595">x </span>
<span id="t1y_595" class="t s7_595">min </span>
<span id="t1z_595" class="t s4_595">≤ </span><span id="t20_595" class="t s6_595">x </span><span id="t21_595" class="t s4_595">≤ </span><span id="t22_595" class="t s6_595">x </span>
<span id="t23_595" class="t s7_595">max </span>
<span id="t24_595" class="t s3_595">and </span><span id="t25_595" class="t s6_595">y </span>
<span id="t26_595" class="t s7_595">min </span>
<span id="t27_595" class="t s4_595">≤ </span><span id="t28_595" class="t s6_595">y </span><span id="t29_595" class="t s4_595">≤ </span><span id="t2a_595" class="t s6_595">y </span>
<span id="t2b_595" class="t s7_595">max </span>
<span id="t2c_595" class="t s3_595">is given by </span>
<span id="t2d_595" class="t s8_595">m </span><span id="t2e_595" class="t s1_595">= </span><span id="t2f_595" class="t s8_595">DOM</span><span id="t2g_595" class="t s1_595">(</span><span id="t2h_595" class="t s8_595">x</span><span id="t2i_595" class="t s9_595">max</span><span id="t2j_595" class="t s8_595">,y</span><span id="t2k_595" class="t s9_595">max</span><span id="t2l_595" class="t s1_595">) </span><span id="t2m_595" class="t sa_595">− </span><span id="t2n_595" class="t s8_595">DOM</span><span id="t2o_595" class="t s1_595">(</span><span id="t2p_595" class="t s8_595">x</span><span id="t2q_595" class="t s9_595">max</span><span id="t2r_595" class="t s8_595">,y </span>
<span id="t2s_595" class="t s9_595">min </span>
<span id="t2t_595" class="t s1_595">) </span><span id="t2u_595" class="t sa_595">− </span><span id="t2v_595" class="t s8_595">DOM</span><span id="t2w_595" class="t s1_595">(</span><span id="t2x_595" class="t s8_595">x </span>
<span id="t2y_595" class="t s9_595">min </span>
<span id="t2z_595" class="t s8_595">,y</span><span id="t30_595" class="t s9_595">max</span><span id="t31_595" class="t s1_595">)+ </span><span id="t32_595" class="t s8_595">DOM</span><span id="t33_595" class="t s1_595">(</span><span id="t34_595" class="t s8_595">x </span>
<span id="t35_595" class="t s9_595">min </span>
<span id="t36_595" class="t s8_595">,y </span>
<span id="t37_595" class="t s9_595">min </span>
<span id="t38_595" class="t s1_595">) </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
