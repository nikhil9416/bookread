<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p441" style="overflow: hidden; position: relative; background-color: white; width: 907px; height: 1045px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_441{left:698px;bottom:969px;letter-spacing:0.1px;}
#t2_441{left:725px;bottom:969px;letter-spacing:0.11px;}
#t3_441{left:765px;bottom:969px;letter-spacing:0.13px;}
#t4_441{left:670px;bottom:56px;letter-spacing:-0.11px;}
#t5_441{left:756px;bottom:56px;}
#t6_441{left:790px;bottom:55px;letter-spacing:0.17px;}
#t7_441{left:94px;bottom:896px;letter-spacing:-0.29px;}
#t8_441{left:126px;bottom:863px;letter-spacing:-0.29px;}
#t9_441{left:126px;bottom:847px;letter-spacing:-0.29px;}
#ta_441{left:126px;bottom:830px;letter-spacing:-0.29px;}
#tb_441{left:126px;bottom:814px;letter-spacing:-0.29px;}
#tc_441{left:126px;bottom:781px;letter-spacing:-0.29px;}
#td_441{left:126px;bottom:764px;letter-spacing:-0.29px;}
#te_441{left:126px;bottom:731px;letter-spacing:-0.29px;}
#tf_441{left:158px;bottom:715px;letter-spacing:-0.29px;}
#tg_441{left:158px;bottom:698px;letter-spacing:-0.29px;}
#th_441{left:158px;bottom:682px;letter-spacing:-0.29px;}
#ti_441{left:158px;bottom:665px;letter-spacing:-0.29px;}
#tj_441{left:158px;bottom:649px;letter-spacing:-0.29px;}
#tk_441{left:158px;bottom:632px;letter-spacing:-0.29px;}
#tl_441{left:190px;bottom:616px;letter-spacing:-0.29px;}
#tm_441{left:158px;bottom:599px;}
#tn_441{left:126px;bottom:583px;}
#to_441{left:126px;bottom:550px;letter-spacing:-0.29px;}
#tp_441{left:158px;bottom:533px;letter-spacing:-0.29px;}
#tq_441{left:126px;bottom:517px;}
#tr_441{left:126px;bottom:484px;letter-spacing:-0.29px;}
#ts_441{left:158px;bottom:467px;letter-spacing:-0.29px;}
#tt_441{left:126px;bottom:451px;}
#tu_441{left:126px;bottom:418px;letter-spacing:-0.29px;}
#tv_441{left:158px;bottom:401px;letter-spacing:-0.29px;}
#tw_441{left:158px;bottom:385px;letter-spacing:-0.29px;}
#tx_441{left:126px;bottom:368px;}
#ty_441{left:126px;bottom:335px;letter-spacing:-0.29px;}
#tz_441{left:158px;bottom:319px;letter-spacing:-0.29px;}
#t10_441{left:126px;bottom:302px;}
#t11_441{left:126px;bottom:269px;letter-spacing:-0.29px;}
#t12_441{left:158px;bottom:253px;letter-spacing:-0.29px;}
#t13_441{left:158px;bottom:236px;letter-spacing:-0.29px;}
#t14_441{left:190px;bottom:220px;letter-spacing:-0.29px;}
#t15_441{left:158px;bottom:203px;}
#t16_441{left:126px;bottom:187px;}
#t17_441{left:127px;bottom:156px;letter-spacing:-0.29px;}
#t18_441{left:92px;bottom:139px;}
#t19_441{left:93px;bottom:916px;letter-spacing:0.68px;word-spacing:-0.54px;}
#t1a_441{left:480.5px;bottom:875.5px;letter-spacing:-0.04px;}
#t1b_441{left:503.1px;bottom:845.2px;letter-spacing:-0.04px;}
#t1c_441{left:557.7px;bottom:819px;letter-spacing:-0.04px;}
#t1d_441{left:558.4px;bottom:800.6px;letter-spacing:-0.04px;}
#t1e_441{left:558.4px;bottom:782.2px;letter-spacing:-0.04px;}
#t1f_441{left:587.3px;bottom:742.1px;letter-spacing:-0.04px;}
#t1g_441{left:589.3px;bottom:723.9px;letter-spacing:-0.04px;}
#t1h_441{left:590.8px;bottom:705.6px;letter-spacing:-0.04px;}
#t1i_441{left:592.7px;bottom:677.7px;letter-spacing:-0.03px;}
#t1j_441{left:614.5px;bottom:679.5px;letter-spacing:-0.04px;}
#t1k_441{left:594.5px;bottom:659.5px;letter-spacing:-0.04px;}
#t1l_441{left:573.6px;bottom:628.4px;letter-spacing:-0.04px;}
#t1m_441{left:573.2px;bottom:610.1px;letter-spacing:-0.04px;}
#t1n_441{left:572px;bottom:591.8px;letter-spacing:-0.05px;}
#t1o_441{left:566px;bottom:543.2px;letter-spacing:-0.04px;}
#t1p_441{left:701.6px;bottom:560.2px;letter-spacing:-0.04px;}
#t1q_441{left:568.5px;bottom:525px;letter-spacing:-0.05px;}
#t1r_441{left:768.6px;bottom:550.1px;letter-spacing:-0.04px;}
#t1s_441{left:569.7px;bottom:506.7px;letter-spacing:-0.04px;}
#t1t_441{left:561.6px;bottom:462.9px;letter-spacing:-0.04px;}
#t1u_441{left:562.1px;bottom:444.5px;letter-spacing:-0.04px;}
#t1v_441{left:561.7px;bottom:426.2px;letter-spacing:-0.04px;}
#t1w_441{left:562.7px;bottom:407.9px;letter-spacing:-0.04px;}
#t1x_441{left:563px;bottom:389.5px;letter-spacing:-0.04px;}
#t1y_441{left:563px;bottom:371.2px;letter-spacing:-0.04px;}
#t1z_441{left:562.7px;bottom:352.9px;letter-spacing:-0.05px;}
#t20_441{left:492.7px;bottom:211.5px;letter-spacing:-0.04px;}
#t21_441{left:494.6px;bottom:193.2px;letter-spacing:-0.04px;}
#t22_441{left:494.5px;bottom:174.8px;letter-spacing:-0.04px;}
#t23_441{left:571.5px;bottom:317.3px;letter-spacing:-0.04px;}
#t24_441{left:573.6px;bottom:299px;letter-spacing:-0.04px;}
#t25_441{left:574px;bottom:280.7px;letter-spacing:-0.04px;}
#t26_441{left:316.1px;bottom:123.7px;letter-spacing:-0.04px;}
#t27_441{left:318.1px;bottom:105.4px;letter-spacing:-0.04px;}

.s1_441{font-size:15px;font-family:Arial-BoldItalic_10g;color:#000;}
.s2_441{font-size:15px;font-family:Arial-BoldItalic_10g;color:#525252;}
.s3_441{font-size:14px;font-family:Arial-BoldItalic_10g;color:#939393;}
.s4_441{font-size:14px;font-family:Webdings_10p;color:#939393;}
.s5_441{font-size:15px;font-family:ArialRoundedMTBold_7g;color:#000;}
.s6_441{font-size:14px;font-family:CourierNew_146;color:#000;}
.s7_441{font-size:18px;font-family:MarkerFelt-Thin_68;color:#000;}
.s8_441{font-size:20px;font-family:SkippySharp_6e;color:#606060;}
.t.m0_441{transform:matrix(0.996,-0.08,0.08,1,0,0);}
.t.m1_441{transform:matrix(0.999,-0.01,0.01,1,0,0);}
.t.m2_441{transform:matrix(0.999,0.04,-0.04,1,0,0);}
.t.m3_441{transform:matrix(0.992,-0.12,0.12,0.99,0,0);}
.t.m4_441{transform:matrix(0.999,0,0,1,0,0);}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts441" type="text/css" >

@font-face {
	font-family: Arial-BoldItalic_10g;
	src: url("fonts/Arial-BoldItalic_10g.woff") format("woff");
}

@font-face {
	font-family: ArialRoundedMTBold_7g;
	src: url("fonts/ArialRoundedMTBold_7g.woff") format("woff");
}

@font-face {
	font-family: CourierNew_146;
	src: url("fonts/CourierNew_146.woff") format("woff");
}

@font-face {
	font-family: MarkerFelt-Thin_68;
	src: url("fonts/MarkerFelt-Thin_68.woff") format("woff");
}

@font-face {
	font-family: SkippySharp_6e;
	src: url("fonts/SkippySharp_6e.woff") format("woff");
}

@font-face {
	font-family: Webdings_10p;
	src: url("fonts/Webdings_10p.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg441Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg441" style="-webkit-user-select: none;"><object width="907" height="1045" data="441/441.svg" type="image/svg+xml" id="pdf441" style="width:907px; height:1045px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_441" class="t s1_441">the </span><span id="t2_441" class="t s2_441">state </span><span id="t3_441" class="t s1_441">pattern </span>
<span id="t4_441" class="t s3_441">you are here </span><span id="t5_441" class="t s4_441">4 </span><span id="t6_441" class="t s5_441">403 </span>
<span id="t7_441" class="t s6_441">public class GumballMachine { </span>
<span id="t8_441" class="t s6_441">State soldOutState; </span>
<span id="t9_441" class="t s6_441">State noQuarterState; </span>
<span id="ta_441" class="t s6_441">State hasQuarterState; </span>
<span id="tb_441" class="t s6_441">State soldState; </span>
<span id="tc_441" class="t s6_441">State state = soldOutState; </span>
<span id="td_441" class="t s6_441">int count = 0; </span>
<span id="te_441" class="t s6_441">public GumballMachine(int numberGumballs) { </span>
<span id="tf_441" class="t s6_441">soldOutState = new SoldOutState(this); </span>
<span id="tg_441" class="t s6_441">noQuarterState = new NoQuarterState(this); </span>
<span id="th_441" class="t s6_441">hasQuarterState = new HasQuarterState(this); </span>
<span id="ti_441" class="t s6_441">soldState = new SoldState(this); </span>
<span id="tj_441" class="t s6_441">this.count = numberGumballs; </span>
<span id="tk_441" class="t s6_441">if (numberGumballs &gt; 0) { </span>
<span id="tl_441" class="t s6_441">state = noQuarterState; </span>
<span id="tm_441" class="t s6_441">} </span>
<span id="tn_441" class="t s6_441">} </span>
<span id="to_441" class="t s6_441">public void insertQuarter() { </span>
<span id="tp_441" class="t s6_441">state.insertQuarter(); </span>
<span id="tq_441" class="t s6_441">} </span>
<span id="tr_441" class="t s6_441">public void ejectQuarter() { </span>
<span id="ts_441" class="t s6_441">state.ejectQuarter(); </span>
<span id="tt_441" class="t s6_441">} </span>
<span id="tu_441" class="t s6_441">public void turnCrank() { </span>
<span id="tv_441" class="t s6_441">state.turnCrank(); </span>
<span id="tw_441" class="t s6_441">state.dispense(); </span>
<span id="tx_441" class="t s6_441">} </span>
<span id="ty_441" class="t s6_441">void setState(State state) { </span>
<span id="tz_441" class="t s6_441">this.state = state; </span>
<span id="t10_441" class="t s6_441">} </span>
<span id="t11_441" class="t s6_441">void releaseBall() { </span>
<span id="t12_441" class="t s6_441">System.out.println(“A gumball comes rolling out the slot...”); </span>
<span id="t13_441" class="t s6_441">if (count != 0) { </span>
<span id="t14_441" class="t s6_441">count = count - 1; </span>
<span id="t15_441" class="t s6_441">} </span>
<span id="t16_441" class="t s6_441">} </span>
<span id="t17_441" class="t s6_441">// More methods here including getters for each State... </span>
<span id="t18_441" class="t s6_441">} </span>
<span id="t19_441" class="t s7_441">Now, let’s look at the complete GumballMachine class... </span>
<span id="t1a_441" class="t m0_441 s8_441">Here are all the States again... </span>
<span id="t1b_441" class="t m1_441 s8_441">...and the State instance variable. </span>
<span id="t1c_441" class="t m2_441 s8_441">The count instance variable holds </span>
<span id="t1d_441" class="t m2_441 s8_441">the count of gumballs – initially the </span>
<span id="t1e_441" class="t m2_441 s8_441">machine is empty. </span>
<span id="t1f_441" class="t m0_441 s8_441">Our constructor takes the </span>
<span id="t1g_441" class="t m0_441 s8_441">initial number of gumballs and </span>
<span id="t1h_441" class="t m0_441 s8_441">stores it in an instance variable. </span>
<span id="t1i_441" class="t m0_441 s8_441">It </span><span id="t1j_441" class="t m0_441 s8_441">also creates the State </span>
<span id="t1k_441" class="t m0_441 s8_441">instances, one of each. </span>
<span id="t1l_441" class="t m2_441 s8_441">If there are more than 0 </span>
<span id="t1m_441" class="t m2_441 s8_441">gumballs we set the state to the </span>
<span id="t1n_441" class="t m2_441 s8_441">NoQuarterState. </span>
<span id="t1o_441" class="t m3_441 s8_441">Now for the actions. </span><span id="t1p_441" class="t m3_441 s8_441">These are </span>
<span id="t1q_441" class="t m3_441 s8_441">VERY EASY to implement now. </span><span id="t1r_441" class="t m3_441 s8_441">We </span>
<span id="t1s_441" class="t m3_441 s8_441">just delegate to the current state. </span>
<span id="t1t_441" class="t m1_441 s8_441">Note that we don’t need an </span>
<span id="t1u_441" class="t m1_441 s8_441">action method for dispense() in </span>
<span id="t1v_441" class="t m1_441 s8_441">GumballMachine because it’s just an </span>
<span id="t1w_441" class="t m1_441 s8_441">internal action; a user can’t ask the </span>
<span id="t1x_441" class="t m1_441 s8_441">machine to dispense directly. But we </span>
<span id="t1y_441" class="t m1_441 s8_441">do call dispense() on the State object </span>
<span id="t1z_441" class="t m1_441 s8_441">from the turnCrank() method. </span>
<span id="t20_441" class="t m4_441 s8_441">The machine supports a releaseBall() </span>
<span id="t21_441" class="t m4_441 s8_441">helper method that releases the ball and </span>
<span id="t22_441" class="t m4_441 s8_441">decrements the count instance variable. </span>
<span id="t23_441" class="t m1_441 s8_441">This method allows other objects (like </span>
<span id="t24_441" class="t m1_441 s8_441">our State objects) to transition the </span>
<span id="t25_441" class="t m1_441 s8_441">machine to a different state. </span>
<span id="t26_441" class="t m4_441 s8_441">This includes methods like getNoQuarterState() for getting each </span>
<span id="t27_441" class="t m4_441 s8_441">state object, and getCount() for getting the gumball count. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
