<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p519" style="overflow: hidden; position: relative; background-color: white; width: 907px; height: 1045px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_519{left:692px;bottom:969px;letter-spacing:0.1px;}
#t2_519{left:719px;bottom:969px;letter-spacing:0.13px;}
#t3_519{left:765px;bottom:969px;letter-spacing:0.13px;}
#t4_519{left:670px;bottom:56px;letter-spacing:-0.11px;}
#t5_519{left:756px;bottom:56px;}
#t6_519{left:790px;bottom:55px;letter-spacing:0.17px;}
#t7_519{left:90px;bottom:662px;letter-spacing:-0.29px;}
#t8_519{left:91px;bottom:629px;letter-spacing:-0.28px;}
#t9_519{left:123px;bottom:613px;letter-spacing:-0.29px;}
#ta_519{left:123px;bottom:580px;letter-spacing:-0.29px;}
#tb_519{left:156px;bottom:563px;letter-spacing:-0.29px;}
#tc_519{left:123px;bottom:547px;}
#td_519{left:123px;bottom:514px;letter-spacing:-0.28px;}
#te_519{left:188px;bottom:497px;letter-spacing:-0.29px;}
#tf_519{left:156px;bottom:464px;letter-spacing:-0.29px;}
#tg_519{left:188px;bottom:448px;letter-spacing:-0.29px;}
#th_519{left:221px;bottom:431px;letter-spacing:-0.29px;}
#ti_519{left:188px;bottom:415px;letter-spacing:-0.29px;}
#tj_519{left:221px;bottom:398px;letter-spacing:-0.29px;}
#tk_519{left:188px;bottom:382px;letter-spacing:-0.29px;}
#tl_519{left:221px;bottom:365px;letter-spacing:-0.29px;}
#tm_519{left:188px;bottom:349px;}
#tn_519{left:156px;bottom:332px;letter-spacing:-0.29px;}
#to_519{left:188px;bottom:316px;letter-spacing:-0.29px;}
#tp_519{left:156px;bottom:299px;}
#tq_519{left:156px;bottom:283px;letter-spacing:-0.29px;}
#tr_519{left:123px;bottom:266px;}
#ts_519{left:89px;bottom:250px;}
#tt_519{left:91px;bottom:905px;letter-spacing:0.86px;word-spacing:-1.07px;}
#tu_519{left:91px;bottom:862px;letter-spacing:0.03px;word-spacing:0.08px;}
#tv_519{left:90px;bottom:844px;letter-spacing:0.04px;word-spacing:0.07px;}
#tw_519{left:91px;bottom:826px;letter-spacing:0.09px;word-spacing:0.02px;}
#tx_519{left:500px;bottom:826px;letter-spacing:0.07px;word-spacing:0.04px;}
#ty_519{left:92px;bottom:807px;letter-spacing:0.08px;word-spacing:0.04px;}
#tz_519{left:118.8px;bottom:732.8px;letter-spacing:-0.04px;}
#t10_519{left:120px;bottom:714.6px;letter-spacing:-0.04px;}
#t11_519{left:515px;bottom:751.1px;letter-spacing:-0.04px;}
#t12_519{left:514.7px;bottom:732.7px;letter-spacing:-0.04px;}
#t13_519{left:513.1px;bottom:714.4px;letter-spacing:-0.04px;}
#t14_519{left:512.6px;bottom:696.1px;letter-spacing:-0.04px;}
#t15_519{left:650.2px;bottom:667px;letter-spacing:-0.04px;}
#t16_519{left:648.7px;bottom:648.8px;letter-spacing:-0.04px;}
#t17_519{left:647.7px;bottom:630.5px;letter-spacing:-0.04px;}
#t18_519{left:646.7px;bottom:612.2px;letter-spacing:-0.04px;}
#t19_519{left:671.7px;bottom:572.8px;letter-spacing:-0.04px;}
#t1a_519{left:671.7px;bottom:554.5px;letter-spacing:-0.04px;}
#t1b_519{left:671.7px;bottom:536.1px;letter-spacing:-0.04px;}
#t1c_519{left:671.7px;bottom:517.8px;letter-spacing:-0.04px;}
#t1d_519{left:671.4px;bottom:499.5px;letter-spacing:-0.04px;}
#t1e_519{left:678.9px;bottom:463.8px;letter-spacing:-0.04px;}
#t1f_519{left:679.2px;bottom:445.4px;letter-spacing:-0.04px;}
#t1g_519{left:678.9px;bottom:427.1px;letter-spacing:-0.04px;}
#t1h_519{left:679.3px;bottom:408.8px;letter-spacing:-0.04px;}
#t1i_519{left:659.9px;bottom:371.5px;letter-spacing:-0.04px;}
#t1j_519{left:660.5px;bottom:353.1px;letter-spacing:-0.04px;}
#t1k_519{left:660.6px;bottom:334.8px;letter-spacing:-0.04px;}
#t1l_519{left:660.4px;bottom:316.5px;letter-spacing:-0.04px;}
#t1m_519{left:660.1px;bottom:298.1px;letter-spacing:-0.04px;}
#t1n_519{left:539.3px;bottom:277.2px;letter-spacing:-0.04px;}
#t1o_519{left:537.5px;bottom:258.9px;letter-spacing:-0.04px;}
#t1p_519{left:536.6px;bottom:240.6px;letter-spacing:-0.04px;}
#t1q_519{left:535.5px;bottom:222.3px;letter-spacing:-0.04px;}
#t1r_519{left:533.9px;bottom:204px;letter-spacing:-0.04px;}
#t1s_519{left:532.8px;bottom:185.7px;letter-spacing:-0.04px;}
#t1t_519{left:531.5px;bottom:167.5px;letter-spacing:-0.04px;}
#t1u_519{left:155.5px;bottom:215.1px;letter-spacing:-0.04px;}
#t1v_519{left:154px;bottom:196.8px;letter-spacing:-0.04px;}
#t1w_519{left:153.3px;bottom:178.5px;letter-spacing:-0.04px;}
#t1x_519{left:374.7px;bottom:273.1px;letter-spacing:-0.04px;}
#t1y_519{left:374.8px;bottom:254.7px;letter-spacing:-0.04px;}
#t1z_519{left:373.5px;bottom:236.4px;letter-spacing:-0.04px;}

.s1_519{font-size:15px;font-family:Arial-BoldItalic_10g;color:#000;}
.s2_519{font-size:15px;font-family:Arial-BoldItalic_10g;color:#525252;}
.s3_519{font-size:14px;font-family:Arial-BoldItalic_10g;color:#939393;}
.s4_519{font-size:14px;font-family:Webdings_10p;color:#939393;}
.s5_519{font-size:15px;font-family:ArialRoundedMTBold_7g;color:#000;}
.s6_519{font-size:14px;font-family:CourierNew_146;color:#000;}
.s7_519{font-size:28px;font-family:MarkerFelt-Thin_68;color:#000;}
.s8_519{font-size:15px;font-family:Baskerville_x;color:#000;}
.s9_519{font-size:20px;font-family:SkippySharp_6e;color:#606060;}
.t.m0_519{transform:matrix(0.998,-0.05,0.05,1,0,0);}
.t.m1_519{transform:matrix(0.998,0.06,-0.06,1,0,0);}
.t.m2_519{transform:scale(1);}
.t.m3_519{transform:matrix(0.997,0.07,-0.07,1,0,0);}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts519" type="text/css" >

@font-face {
	font-family: Arial-BoldItalic_10g;
	src: url("fonts/Arial-BoldItalic_10g.woff") format("woff");
}

@font-face {
	font-family: ArialRoundedMTBold_7g;
	src: url("fonts/ArialRoundedMTBold_7g.woff") format("woff");
}

@font-face {
	font-family: Baskerville_x;
	src: url("fonts/Baskerville_x.woff") format("woff");
}

@font-face {
	font-family: CourierNew_146;
	src: url("fonts/CourierNew_146.woff") format("woff");
}

@font-face {
	font-family: MarkerFelt-Thin_68;
	src: url("fonts/MarkerFelt-Thin_68.woff") format("woff");
}

@font-face {
	font-family: SkippySharp_6e;
	src: url("fonts/SkippySharp_6e.woff") format("woff");
}

@font-face {
	font-family: Webdings_10p;
	src: url("fonts/Webdings_10p.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg519Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg519" style="-webkit-user-select: none;"><object width="907" height="1045" data="519/519.svg" type="image/svg+xml" id="pdf519" style="width:907px; height:1045px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_519" class="t s1_519">the </span><span id="t2_519" class="t s2_519">proxy </span><span id="t3_519" class="t s1_519">pattern </span>
<span id="t4_519" class="t s3_519">you are here </span><span id="t5_519" class="t s4_519">4 </span><span id="t6_519" class="t s5_519">481 </span>
<span id="t7_519" class="t s6_519">import java.lang.reﬂect.*; </span>
<span id="t8_519" class="t s6_519">public class OwnerInvocationHandler implements InvocationHandler { </span>
<span id="t9_519" class="t s6_519">PersonBean person; </span>
<span id="ta_519" class="t s6_519">public OwnerInvocationHandler(PersonBean person) { </span>
<span id="tb_519" class="t s6_519">this.person = person; </span>
<span id="tc_519" class="t s6_519">} </span>
<span id="td_519" class="t s6_519">public Object invoke(Object proxy, Method method, Object[] args) </span>
<span id="te_519" class="t s6_519">throws IllegalAccessException { </span>
<span id="tf_519" class="t s6_519">try { </span>
<span id="tg_519" class="t s6_519">if (method.getName().startsWith(“get”)) { </span>
<span id="th_519" class="t s6_519">return method.invoke(person, args); </span>
<span id="ti_519" class="t s6_519">} else if (method.getName().equals(“setHotOrNotRating”)) { </span>
<span id="tj_519" class="t s6_519">throw new IllegalAccessException(); </span>
<span id="tk_519" class="t s6_519">} else if (method.getName().startsWith(“set”)) { </span>
<span id="tl_519" class="t s6_519">return method.invoke(person, args); </span>
<span id="tm_519" class="t s6_519">} </span>
<span id="tn_519" class="t s6_519">} catch (InvocationTargetException e) { </span>
<span id="to_519" class="t s6_519">e.printStackTrace(); </span>
<span id="tp_519" class="t s6_519">} </span>
<span id="tq_519" class="t s6_519">return null; </span>
<span id="tr_519" class="t s6_519">} </span>
<span id="ts_519" class="t s6_519">} </span>
<span id="tt_519" class="t s7_519">Creating Invocation Handlers continued... </span>
<span id="tu_519" class="t s8_519">When invoke() is called by the proxy, how do you know what to do with the call? </span>
<span id="tv_519" class="t s8_519">Typically, you’ll examine the method that was called on the proxy and make </span>
<span id="tw_519" class="t s8_519">decisions based on the method’s name and possibly its arguments. </span><span id="tx_519" class="t s8_519">Let’s implement </span>
<span id="ty_519" class="t s8_519">the OwnerInvocationHandler to see how this works: </span>
<span id="tz_519" class="t m0_519 s9_519">InvocationHandler is part of the java.lang.reflect </span>
<span id="t10_519" class="t m0_519 s9_519">package, so we need to import it. </span>
<span id="t11_519" class="t m1_519 s9_519">All invocation </span>
<span id="t12_519" class="t m1_519 s9_519">handlers implement </span>
<span id="t13_519" class="t m1_519 s9_519">the InvocationHandler </span>
<span id="t14_519" class="t m1_519 s9_519">interface. </span>
<span id="t15_519" class="t m1_519 s9_519">We’re passed the </span>
<span id="t16_519" class="t m1_519 s9_519">Real Subject in the </span>
<span id="t17_519" class="t m1_519 s9_519">constructor and we </span>
<span id="t18_519" class="t m1_519 s9_519">keep a reference to it. </span>
<span id="t19_519" class="t m2_519 s9_519">Here’s the invoke </span>
<span id="t1a_519" class="t m2_519 s9_519">method that gets </span>
<span id="t1b_519" class="t m2_519 s9_519">called every time a </span>
<span id="t1c_519" class="t m2_519 s9_519">method is invoked </span>
<span id="t1d_519" class="t m2_519 s9_519">on the proxy. </span>
<span id="t1e_519" class="t m2_519 s9_519">If the method is a </span>
<span id="t1f_519" class="t m2_519 s9_519">getter, we go ahead </span>
<span id="t1g_519" class="t m2_519 s9_519">and invoke it on the </span>
<span id="t1h_519" class="t m2_519 s9_519">real subject. </span>
<span id="t1i_519" class="t m2_519 s9_519">Otherwise, if it is the </span>
<span id="t1j_519" class="t m2_519 s9_519">setHotOrNotRating() </span>
<span id="t1k_519" class="t m2_519 s9_519">method we disallow </span>
<span id="t1l_519" class="t m2_519 s9_519">it by throwing a </span>
<span id="t1m_519" class="t m2_519 s9_519">IllegalAccessException. </span>
<span id="t1n_519" class="t m3_519 s9_519">Because we are </span>
<span id="t1o_519" class="t m3_519 s9_519">the owner any </span>
<span id="t1p_519" class="t m3_519 s9_519">other set method </span>
<span id="t1q_519" class="t m3_519 s9_519">is fine and we go </span>
<span id="t1r_519" class="t m3_519 s9_519">ahead and invoke </span>
<span id="t1s_519" class="t m3_519 s9_519">it on the real </span>
<span id="t1t_519" class="t m3_519 s9_519">subject. </span>
<span id="t1u_519" class="t m3_519 s9_519">If any other method is called, </span>
<span id="t1v_519" class="t m3_519 s9_519">we’re just going to return null </span>
<span id="t1w_519" class="t m3_519 s9_519">rather than take a chance. </span>
<span id="t1x_519" class="t m3_519 s9_519">This will happen if </span>
<span id="t1y_519" class="t m3_519 s9_519">the real subject </span>
<span id="t1z_519" class="t m3_519 s9_519">throws an exception. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
