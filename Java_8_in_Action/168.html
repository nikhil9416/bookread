<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p168" style="overflow: hidden; position: relative; background-color: white; width: 909px; height: 1286px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_168{left:450px;bottom:46px;letter-spacing:-0.13px;}
#t2_168{left:65px;bottom:1188px;letter-spacing:0.14px;word-spacing:0.45px;}
#t3_168{left:241px;bottom:1188px;letter-spacing:0.16px;word-spacing:0.17px;}
#t4_168{left:384px;bottom:1188px;letter-spacing:0.15px;word-spacing:0.46px;}
#t5_168{left:65px;bottom:1159px;letter-spacing:0.16px;word-spacing:3.2px;}
#t6_168{left:65px;bottom:1130px;letter-spacing:0.15px;word-spacing:0.97px;}
#t7_168{left:65px;bottom:1101px;letter-spacing:0.14px;word-spacing:-0.08px;}
#t8_168{left:318px;bottom:1101px;letter-spacing:0.13px;word-spacing:0.03px;}
#t9_168{left:418px;bottom:1101px;letter-spacing:0.15px;word-spacing:-0.14px;}
#ta_168{left:65px;bottom:1004px;letter-spacing:-0.01px;word-spacing:0.19px;}
#tb_168{left:65px;bottom:953px;letter-spacing:0.15px;word-spacing:0.15px;}
#tc_168{left:65px;bottom:924px;letter-spacing:0.16px;word-spacing:5.12px;}
#td_168{left:65px;bottom:895px;letter-spacing:0.15px;word-spacing:4.6px;}
#te_168{left:65px;bottom:866px;letter-spacing:0.14px;word-spacing:-0.12px;}
#tf_168{left:65px;bottom:815px;letter-spacing:0.15px;word-spacing:-0.12px;}
#tg_168{left:65px;bottom:786px;letter-spacing:0.16px;word-spacing:-0.17px;}
#th_168{left:349px;bottom:757px;letter-spacing:0.16px;word-spacing:-0.14px;}
#ti_168{left:349px;bottom:728px;letter-spacing:0.14px;word-spacing:-0.14px;}
#tj_168{left:441px;bottom:699px;letter-spacing:0.14px;}
#tk_168{left:441px;bottom:670px;letter-spacing:0.13px;word-spacing:-0.22px;}
#tl_168{left:349px;bottom:641px;letter-spacing:0.15px;word-spacing:-0.16px;}
#tm_168{left:441px;bottom:612px;letter-spacing:0.15px;}
#tn_168{left:441px;bottom:583px;letter-spacing:0.15px;word-spacing:-0.23px;}
#to_168{left:65px;bottom:532px;letter-spacing:0.16px;word-spacing:1.23px;}
#tp_168{left:65px;bottom:503px;letter-spacing:0.15px;word-spacing:1.41px;}
#tq_168{left:65px;bottom:474px;letter-spacing:0.16px;word-spacing:2.62px;}
#tr_168{left:65px;bottom:445px;letter-spacing:0.15px;word-spacing:1.26px;}
#ts_168{left:65px;bottom:416px;letter-spacing:0.16px;word-spacing:3.19px;}
#tt_168{left:65px;bottom:387px;letter-spacing:0.14px;word-spacing:0.17px;}
#tu_168{left:65px;bottom:358px;letter-spacing:0.15px;word-spacing:1.82px;}
#tv_168{left:65px;bottom:329px;letter-spacing:0.15px;word-spacing:0.32px;}
#tw_168{left:65px;bottom:300px;letter-spacing:0.14px;word-spacing:1.86px;}
#tx_168{left:65px;bottom:271px;letter-spacing:0.15px;word-spacing:2.14px;}
#ty_168{left:65px;bottom:242px;letter-spacing:0.17px;word-spacing:3.16px;}
#tz_168{left:65px;bottom:213px;letter-spacing:0.14px;word-spacing:-0.14px;}
#t10_168{left:390px;bottom:3px;letter-spacing:0.13px;}

.s1_168{font-size:14px;font-family:TimesNewRomanPSMT_g;color:#000;}
.s2_168{font-size:18px;font-family:Georgia_11;color:#000;}
.s3_168{font-size:18px;font-family:Georgia-Italic_16;color:#000;}
.s4_168{font-size:18px;font-family:Georgia_11;color:#00F;}
.s5_168{font-size:16px;font-family:Georgia-Bold_l;color:#000;}
.s6_168{font-size:15px;font-family:Helvetica, Arial, sans-serif;color:#00F;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts168" type="text/css" >

@font-face {
	font-family: Georgia-Bold_l;
	src: url("fonts/Georgia-Bold_l.woff") format("woff");
}

@font-face {
	font-family: Georgia-Italic_16;
	src: url("fonts/Georgia-Italic_16.woff") format("woff");
}

@font-face {
	font-family: Georgia_11;
	src: url("fonts/Georgia_11.woff") format("woff");
}

@font-face {
	font-family: TimesNewRomanPSMT_g;
	src: url("fonts/TimesNewRomanPSMT_g.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg168Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg168" style="-webkit-user-select: none;"><object width="909" height="1286" data="168/168.svg" type="image/svg+xml" id="pdf168" style="width:909px; height:1286px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_168" class="t s1_168">168 </span>
<span id="t2_168" class="t s2_168">starting point and an </span><span id="t3_168" class="t s3_168">identity function </span><span id="t4_168" class="t s2_168">(that is, a function doing nothing more than returning its </span>
<span id="t5_168" class="t s2_168">input argument as is) as a transformation function. This also implies that the one-argument </span>
<span id="t6_168" class="t s2_168">reducing collector won’t have any starting point when passed to the collect method of an empty </span>
<span id="t7_168" class="t s2_168">stream and, as we explained in </span><span id="t8_168" class="t s4_168">section 6.2.1 </span><span id="t9_168" class="t s2_168">, for this reason it returns an Optional&lt;Dish&gt; object. </span>
<span id="ta_168" class="t s5_168">Collect vs. reduce </span>
<span id="tb_168" class="t s2_168">We’ve discussed reductions a lot in the previous chapter and this one. You may naturally wonder </span>
<span id="tc_168" class="t s2_168">what the differences between the collect and reduce methods of the Stream interface are, </span>
<span id="td_168" class="t s2_168">because often you can obtain the same results using either method. For instance, you can </span>
<span id="te_168" class="t s2_168">achieve what is done by the toList Collector using the reduce method as follows: </span>
<span id="tf_168" class="t s2_168">Stream&lt;Integer&gt; stream = Arrays.asList(1, 2, 3, 4, 5, 6).stream(); </span>
<span id="tg_168" class="t s2_168">List&lt;Integer&gt; numbers = stream.reduce( </span>
<span id="th_168" class="t s2_168">new ArrayList&lt;Integer&gt;(), </span>
<span id="ti_168" class="t s2_168">(List&lt;Integer&gt; l, Integer e) -&gt; { </span>
<span id="tj_168" class="t s2_168">l.add(e); </span>
<span id="tk_168" class="t s2_168">return l; }, </span>
<span id="tl_168" class="t s2_168">(List&lt;Integer&gt; l1, List&lt;Integer&gt; l2) -&gt; { </span>
<span id="tm_168" class="t s2_168">l1.addAll(l2); </span>
<span id="tn_168" class="t s2_168">return l1; }); </span>
<span id="to_168" class="t s2_168">This solution has two problems: a semantic one and a practical one. The semantic problem lies </span>
<span id="tp_168" class="t s2_168">in the fact that the reduce method is meant to combine two values and produce a new one; it’s </span>
<span id="tq_168" class="t s2_168">an immutable reduction. In contrast, the collect method is designed to mutate a container to </span>
<span id="tr_168" class="t s2_168">accumulate the result it’s supposed to produce. This means that the previous snippet of code is </span>
<span id="ts_168" class="t s2_168">misusing the reduce method because it’s mutating in place the List used as accumulator. As </span>
<span id="tt_168" class="t s2_168">you’ll see in more detail in the next chapter, using the reduce method with the wrong semantic is </span>
<span id="tu_168" class="t s2_168">also the cause of a practical problem: this reduction process can’t work in parallel because the </span>
<span id="tv_168" class="t s2_168">concurrent modification of the same data structure operated by multiple threads can corrupt the </span>
<span id="tw_168" class="t s2_168">List itself. In this case, if you want thread safety, you’ll need to allocate a new List every time, </span>
<span id="tx_168" class="t s2_168">which would impair performance by object allocation. This is the main reason why the collect </span>
<span id="ty_168" class="t s2_168">method is useful for expressing reduction working on a mutable container but crucially in a </span>
<span id="tz_168" class="t s2_168">parallel-friendly way, as you’ll learn later in the chapter. </span>
<span id="t10_168" class="t s6_168">www.it-ebooks.info </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
