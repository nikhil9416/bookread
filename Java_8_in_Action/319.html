<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p319" style="overflow: hidden; position: relative; background-color: white; width: 909px; height: 1286px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_319{left:450px;bottom:46px;letter-spacing:-0.13px;}
#t2_319{left:65px;bottom:1188px;letter-spacing:0.15px;word-spacing:-0.14px;}
#t3_319{left:102px;bottom:1159px;letter-spacing:0.16px;word-spacing:-0.29px;}
#t4_319{left:102px;bottom:1130px;letter-spacing:0.17px;word-spacing:-0.29px;}
#t5_319{left:102px;bottom:1101px;letter-spacing:0.18px;word-spacing:-0.23px;}
#t6_319{left:102px;bottom:1072px;letter-spacing:0.16px;word-spacing:-0.29px;}
#t7_319{left:65px;bottom:1014px;letter-spacing:0.23px;word-spacing:-0.01px;}
#t8_319{left:65px;bottom:951px;letter-spacing:0.17px;word-spacing:2.3px;}
#t9_319{left:65px;bottom:922px;letter-spacing:0.16px;word-spacing:2.76px;}
#ta_319{left:65px;bottom:893px;letter-spacing:0.16px;word-spacing:5.11px;}
#tb_319{left:65px;bottom:864px;letter-spacing:0.16px;word-spacing:1.85px;}
#tc_319{left:648px;bottom:864px;letter-spacing:0.14px;word-spacing:1.83px;}
#td_319{left:743px;bottom:864px;letter-spacing:0.16px;word-spacing:1.76px;}
#te_319{left:65px;bottom:835px;letter-spacing:0.15px;word-spacing:-0.17px;}
#tf_319{left:65px;bottom:777px;letter-spacing:0.21px;word-spacing:5.55px;}
#tg_319{left:339px;bottom:779px;letter-spacing:0.21px;}
#th_319{left:534px;bottom:777px;letter-spacing:0.26px;word-spacing:5.53px;}
#ti_319{left:640px;bottom:779px;letter-spacing:0.2px;}
#tj_319{left:769px;bottom:777px;letter-spacing:0.22px;}
#tk_319{left:65px;bottom:730px;letter-spacing:0.27px;}
#tl_319{left:65px;bottom:667px;letter-spacing:0.16px;word-spacing:-0.19px;}
#tm_319{left:102px;bottom:638px;letter-spacing:0.16px;word-spacing:-0.18px;}
#tn_319{left:65px;bottom:609px;}
#to_319{left:65px;bottom:559px;letter-spacing:0.16px;word-spacing:0.31px;}
#tp_319{left:65px;bottom:530px;letter-spacing:0.17px;word-spacing:5.02px;}
#tq_319{left:65px;bottom:501px;letter-spacing:0.16px;word-spacing:0.6px;}
#tr_319{left:65px;bottom:472px;letter-spacing:0.16px;word-spacing:2.71px;}
#ts_319{left:65px;bottom:443px;letter-spacing:0.16px;word-spacing:3.39px;}
#tt_319{left:65px;bottom:414px;letter-spacing:0.15px;word-spacing:2.7px;}
#tu_319{left:418px;bottom:414px;letter-spacing:0.14px;word-spacing:2.94px;}
#tv_319{left:529px;bottom:414px;letter-spacing:0.16px;word-spacing:2.72px;}
#tw_319{left:65px;bottom:385px;letter-spacing:0.16px;word-spacing:5.6px;}
#tx_319{left:65px;bottom:356px;letter-spacing:0.15px;}
#ty_319{left:65px;bottom:305px;letter-spacing:0.17px;word-spacing:2.59px;}
#tz_319{left:740px;bottom:305px;letter-spacing:0.14px;word-spacing:2.56px;}
#t10_319{left:835px;bottom:305px;letter-spacing:0.08px;}
#t11_319{left:65px;bottom:276px;letter-spacing:0.17px;word-spacing:3.32px;}
#t12_319{left:656px;bottom:276px;letter-spacing:0.15px;word-spacing:3.3px;}
#t13_319{left:745px;bottom:276px;letter-spacing:0.16px;word-spacing:3.41px;}
#t14_319{left:65px;bottom:247px;letter-spacing:0.15px;word-spacing:-0.12px;}
#t15_319{left:65px;bottom:197px;letter-spacing:0.15px;word-spacing:1.39px;}
#t16_319{left:65px;bottom:168px;letter-spacing:0.15px;word-spacing:2.86px;}
#t17_319{left:65px;bottom:139px;letter-spacing:0.16px;word-spacing:2.83px;}
#t18_319{left:65px;bottom:110px;letter-spacing:0.16px;word-spacing:3.28px;}
#t19_319{left:390px;bottom:3px;letter-spacing:0.13px;}

.s1_319{font-size:14px;font-family:TimesNewRomanPSMT_g;color:#000;}
.s2_319{font-size:18px;font-family:Georgia_11;color:#000;}
.s3_319{font-size:21px;font-family:Georgia-Bold_l;color:#000;}
.s4_319{font-size:18px;font-family:Georgia_11;color:#00F;}
.s5_319{font-size:18px;font-family:Georgia-Bold_l;color:#000;}
.s6_319{font-size:15px;font-family:Helvetica, Arial, sans-serif;color:#00F;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts319" type="text/css" >

@font-face {
	font-family: Georgia-Bold_l;
	src: url("fonts/Georgia-Bold_l.woff") format("woff");
}

@font-face {
	font-family: Georgia_11;
	src: url("fonts/Georgia_11.woff") format("woff");
}

@font-face {
	font-family: TimesNewRomanPSMT_g;
	src: url("fonts/TimesNewRomanPSMT_g.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg319Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg319" style="-webkit-user-select: none;"><object width="909" height="1286" data="319/319.svg" type="image/svg+xml" id="pdf319" style="width:909px; height:1286px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_319" class="t s1_319">319 </span>
<span id="t2_319" class="t s2_319">Caused by: java.lang.RuntimeException: product not available </span>
<span id="t3_319" class="t s2_319">at lambdasinaction.chap11.AsyncShop.calculatePrice(AsyncShop.java:36) </span>
<span id="t4_319" class="t s2_319">at lambdasinaction.chap11.AsyncShop.lambda$getPrice$0(AsyncShop.java:23) </span>
<span id="t5_319" class="t s2_319">at lambdasinaction.chap11.AsyncShop$$Lambda$1/24071475.run(Unknown Source) </span>
<span id="t6_319" class="t s2_319">at java.lang.Thread.run(Thread.java:744) </span>
<span id="t7_319" class="t s3_319">Creating a CompletableFuture with the supplyAsync factory method </span>
<span id="t8_319" class="t s2_319">Until now you’ve created CompletableFutures and completed them programmatically, when it </span>
<span id="t9_319" class="t s2_319">seemed convenient to do so, but the CompletableFuture class itself comes with lots of handy </span>
<span id="ta_319" class="t s2_319">factory methods that can make this process far easier and less verbose. For example, the </span>
<span id="tb_319" class="t s2_319">supplyAsync method can let you rewrite the getPriceAsync method in </span><span id="tc_319" class="t s4_319">listing 11.4 </span><span id="td_319" class="t s2_319">with a single </span>
<span id="te_319" class="t s2_319">statement, as shown in the following listing. </span>
<span id="tf_319" class="t s3_319">Listing 11.7. Creating a </span><span id="tg_319" class="t s5_319">CompletableFuture </span><span id="th_319" class="t s3_319">with the </span><span id="ti_319" class="t s5_319">supplyAsync </span><span id="tj_319" class="t s3_319">factory </span>
<span id="tk_319" class="t s3_319">method </span>
<span id="tl_319" class="t s2_319">public Future&lt;Double&gt; getPriceAsync(String product) { </span>
<span id="tm_319" class="t s2_319">return CompletableFuture.supplyAsync(() -&gt; calculatePrice(product)); </span>
<span id="tn_319" class="t s2_319">} </span>
<span id="to_319" class="t s2_319">The supplyAsync method accepts a Supplier as argument and returns a Completable-Future that </span>
<span id="tp_319" class="t s2_319">will be asynchronously completed with the value obtained by invoking that Supplier. This </span>
<span id="tq_319" class="t s2_319">Supplier will be run by one of the Executors in the ForkJoinPool, but you can specify a different </span>
<span id="tr_319" class="t s2_319">Executor by passing it as a second argument to the overloaded version of this method. More </span>
<span id="ts_319" class="t s2_319">generally, it’s possible to optionally pass an Executor to all other CompletableFuture factory </span>
<span id="tt_319" class="t s2_319">methods, and you’ll use this capability in </span><span id="tu_319" class="t s4_319">section 11.3.4 </span><span id="tv_319" class="t s2_319">, where we demonstrate that using an </span>
<span id="tw_319" class="t s2_319">Executor that fits the characteristics of your application can have a positive effect on its </span>
<span id="tx_319" class="t s2_319">performance. </span>
<span id="ty_319" class="t s2_319">Also note that the CompletableFuture returned by the getPriceAsync method in </span><span id="tz_319" class="t s4_319">listing 11.7 </span><span id="t10_319" class="t s2_319">is </span>
<span id="t11_319" class="t s2_319">totally equivalent to the one you created and completed manually in </span><span id="t12_319" class="t s4_319">listing 11.6 </span><span id="t13_319" class="t s2_319">, meaning it </span>
<span id="t14_319" class="t s2_319">provides the same error management you carefully added. </span>
<span id="t15_319" class="t s2_319">For the rest of this chapter, we’ll suppose you sadly have no control over the API implemented </span>
<span id="t16_319" class="t s2_319">by the Shop class and that it provides only synchronous blocking methods. This is also what </span>
<span id="t17_319" class="t s2_319">typically happens when you want to consume an HTTP API provided by some service. You’ll </span>
<span id="t18_319" class="t s2_319">learn how it’s still possible to query multiple shops asynchronously, thus avoiding becoming </span>
<span id="t19_319" class="t s6_319">www.it-ebooks.info </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
