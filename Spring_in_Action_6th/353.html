<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p353" style="overflow: hidden; position: relative; background-color: white; width: 811px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_353{left:87px;bottom:960px;letter-spacing:-0.13px;}
#t2_353{left:331px;bottom:961px;}
#t3_353{left:339px;bottom:962px;letter-spacing:-0.14px;}
#t4_353{left:379px;bottom:961px;letter-spacing:0.13px;}
#t5_353{left:406px;bottom:960px;letter-spacing:-0.11px;word-spacing:0.01px;}
#t6_353{left:167px;bottom:917px;letter-spacing:0.13px;word-spacing:2.52px;}
#t7_353{left:420px;bottom:918px;letter-spacing:0.21px;}
#t8_353{left:520px;bottom:917px;letter-spacing:0.15px;word-spacing:2.52px;}
#t9_353{left:142px;bottom:898px;letter-spacing:0.11px;word-spacing:0.58px;}
#ta_353{left:142px;bottom:878px;letter-spacing:0.11px;word-spacing:-0.12px;}
#tb_353{left:416px;bottom:878px;letter-spacing:0.19px;}
#tc_353{left:452px;bottom:878px;letter-spacing:0.1px;}
#td_353{left:470px;bottom:878px;letter-spacing:0.22px;}
#te_353{left:501px;bottom:878px;letter-spacing:0.12px;word-spacing:-0.1px;}
#tf_353{left:679px;bottom:878px;letter-spacing:0.22px;}
#tg_353{left:142px;bottom:858px;letter-spacing:0.1px;}
#th_353{left:162px;bottom:858px;letter-spacing:0.22px;}
#ti_353{left:198px;bottom:858px;letter-spacing:0.12px;word-spacing:0.72px;}
#tj_353{left:390px;bottom:858px;letter-spacing:0.22px;}
#tk_353{left:426px;bottom:858px;letter-spacing:0.1px;}
#tl_353{left:446px;bottom:858px;letter-spacing:0.24px;}
#tm_353{left:474px;bottom:858px;letter-spacing:0.12px;word-spacing:0.71px;}
#tn_353{left:142px;bottom:838px;letter-spacing:0.12px;word-spacing:0.01px;}
#to_353{left:167px;bottom:818px;letter-spacing:0.26px;word-spacing:1.77px;}
#tp_353{left:465px;bottom:819px;letter-spacing:0.38px;}
#tq_353{left:566px;bottom:818px;letter-spacing:0.26px;word-spacing:1.78px;}
#tr_353{left:142px;bottom:798px;letter-spacing:0.26px;word-spacing:1.28px;}
#ts_353{left:348px;bottom:799px;letter-spacing:0.38px;}
#tt_353{left:425px;bottom:798px;letter-spacing:0.27px;word-spacing:1.27px;}
#tu_353{left:611px;bottom:799px;letter-spacing:0.39px;}
#tv_353{left:707px;bottom:798px;}
#tw_353{left:142px;bottom:779px;letter-spacing:0.38px;}
#tx_353{left:220px;bottom:778px;letter-spacing:0.28px;word-spacing:1.63px;}
#ty_353{left:142px;bottom:759px;letter-spacing:0.28px;word-spacing:-0.01px;}
#tz_353{left:165px;bottom:739px;letter-spacing:0.11px;}
#t10_353{left:209px;bottom:739px;letter-spacing:0.21px;}
#t11_353{left:284px;bottom:739px;letter-spacing:0.12px;word-spacing:0.77px;}
#t12_353{left:479px;bottom:739px;letter-spacing:0.21px;}
#t13_353{left:572px;bottom:739px;letter-spacing:0.11px;word-spacing:0.79px;}
#t14_353{left:142px;bottom:719px;letter-spacing:0.12px;}
#t15_353{left:503px;bottom:719px;letter-spacing:0.21px;}
#t16_353{left:577px;bottom:719px;letter-spacing:0.12px;word-spacing:-0.02px;}
#t17_353{left:142px;bottom:699px;letter-spacing:0.12px;word-spacing:0.26px;}
#t18_353{left:142px;bottom:679px;letter-spacing:0.12px;word-spacing:-0.04px;}
#t19_353{left:232px;bottom:679px;letter-spacing:0.22px;}
#t1a_353{left:306px;bottom:679px;letter-spacing:0.11px;}
#t1b_353{left:166px;bottom:654px;}
#t1c_353{left:185px;bottom:653px;letter-spacing:0.12px;word-spacing:-0.04px;}
#t1d_353{left:329px;bottom:654px;letter-spacing:0.21px;}
#t1e_353{left:404px;bottom:653px;letter-spacing:0.1px;word-spacing:0.01px;}
#t1f_353{left:481px;bottom:654px;letter-spacing:0.22px;}
#t1g_353{left:555px;bottom:653px;letter-spacing:0.16px;}
#t1h_353{left:166px;bottom:633px;}
#t1i_353{left:185px;bottom:632px;letter-spacing:0.13px;word-spacing:-0.03px;}
#t1j_353{left:166px;bottom:611px;}
#t1k_353{left:185px;bottom:610px;letter-spacing:0.13px;word-spacing:-0.03px;}
#t1l_353{left:166px;bottom:590px;}
#t1m_353{left:185px;bottom:589px;letter-spacing:0.12px;word-spacing:0.01px;}
#t1n_353{left:166px;bottom:569px;}
#t1o_353{left:185px;bottom:568px;letter-spacing:0.13px;word-spacing:0.06px;}
#t1p_353{left:142px;bottom:540px;letter-spacing:0.12px;word-spacing:1.21px;}
#t1q_353{left:368px;bottom:540px;letter-spacing:0.21px;}
#t1r_353{left:443px;bottom:540px;letter-spacing:0.12px;word-spacing:1.16px;}
#t1s_353{left:679px;bottom:540px;letter-spacing:0.22px;}
#t1t_353{left:142px;bottom:521px;letter-spacing:0.21px;}
#t1u_353{left:193px;bottom:520px;letter-spacing:0.14px;word-spacing:-0.04px;}
#t1v_353{left:291px;bottom:521px;letter-spacing:0.24px;}
#t1w_353{left:319px;bottom:520px;letter-spacing:0.11px;}
#t1x_353{left:87px;bottom:486px;letter-spacing:-0.48px;}
#t1y_353{left:142px;bottom:486px;letter-spacing:0.01px;word-spacing:0.03px;}
#t1z_353{left:142px;bottom:461px;letter-spacing:-0.04px;word-spacing:2.74px;}
#t20_353{left:269px;bottom:461px;letter-spacing:0.06px;}
#t21_353{left:345px;bottom:461px;letter-spacing:-0.03px;word-spacing:2.74px;}
#t22_353{left:634px;bottom:461px;letter-spacing:0.05px;}
#t23_353{left:142px;bottom:441px;letter-spacing:-0.04px;word-spacing:0.21px;}
#t24_353{left:459px;bottom:441px;letter-spacing:0.05px;}
#t25_353{left:551px;bottom:441px;letter-spacing:-0.04px;word-spacing:0.18px;}
#t26_353{left:680px;bottom:441px;letter-spacing:0.05px;}
#t27_353{left:142px;bottom:421px;letter-spacing:0.05px;}
#t28_353{left:232px;bottom:421px;letter-spacing:-0.03px;word-spacing:1.3px;}
#t29_353{left:353px;bottom:421px;letter-spacing:0.06px;}
#t2a_353{left:422px;bottom:421px;letter-spacing:-0.03px;word-spacing:1.3px;}
#t2b_353{left:142px;bottom:401px;letter-spacing:-0.03px;word-spacing:-0.04px;}
#t2c_353{left:265px;bottom:401px;letter-spacing:0.05px;}
#t2d_353{left:299px;bottom:401px;letter-spacing:-0.04px;word-spacing:-0.02px;}
#t2e_353{left:419px;bottom:401px;letter-spacing:0.05px;}
#t2f_353{left:499px;bottom:401px;letter-spacing:-0.03px;word-spacing:-0.04px;}
#t2g_353{left:142px;bottom:371px;letter-spacing:0.14px;}
#t2h_353{left:172px;bottom:356px;letter-spacing:0.12px;}
#t2i_353{left:172px;bottom:340px;letter-spacing:0.14px;}
#t2j_353{left:172px;bottom:325px;letter-spacing:0.13px;}
#t2k_353{left:172px;bottom:310px;letter-spacing:0.13px;}
#t2l_353{left:142px;bottom:279px;letter-spacing:0.13px;word-spacing:0.01px;}
#t2m_353{left:142px;bottom:242px;letter-spacing:0.27px;word-spacing:0.53px;}
#t2n_353{left:300px;bottom:242px;letter-spacing:0.38px;}
#t2o_353{left:377px;bottom:242px;letter-spacing:0.27px;word-spacing:0.54px;}
#t2p_353{left:471px;bottom:242px;letter-spacing:0.39px;}
#t2q_353{left:534px;bottom:242px;letter-spacing:0.28px;word-spacing:0.48px;}
#t2r_353{left:640px;bottom:242px;letter-spacing:0.37px;}
#t2s_353{left:685px;bottom:242px;letter-spacing:0.29px;}
#t2t_353{left:142px;bottom:223px;letter-spacing:0.37px;}
#t2u_353{left:187px;bottom:222px;letter-spacing:0.27px;word-spacing:0.99px;}
#t2v_353{left:267px;bottom:223px;letter-spacing:0.34px;}
#t2w_353{left:297px;bottom:222px;letter-spacing:0.21px;word-spacing:1.08px;}
#t2x_353{left:142px;bottom:202px;letter-spacing:0.27px;word-spacing:2.52px;}
#t2y_353{left:491px;bottom:203px;letter-spacing:0.39px;}
#t2z_353{left:586px;bottom:202px;letter-spacing:0.27px;word-spacing:2.56px;}
#t30_353{left:631px;bottom:203px;letter-spacing:0.38px;}
#t31_353{left:142px;bottom:183px;letter-spacing:0.27px;word-spacing:0.02px;}
#t32_353{left:457px;bottom:183px;letter-spacing:0.39px;}
#t33_353{left:557px;bottom:183px;letter-spacing:0.27px;word-spacing:0.05px;}
#t34_353{left:142px;bottom:163px;letter-spacing:0.28px;word-spacing:1.4px;}
#t35_353{left:285px;bottom:163px;letter-spacing:0.38px;}
#t36_353{left:418px;bottom:163px;letter-spacing:0.29px;word-spacing:1.43px;}
#t37_353{left:142px;bottom:143px;letter-spacing:0.26px;}
#t38_353{left:186px;bottom:143px;letter-spacing:0.36px;}
#t39_353{left:222px;bottom:143px;letter-spacing:0.28px;}
#t3a_353{left:168px;bottom:123px;letter-spacing:0.13px;word-spacing:3.06px;}
#t3b_353{left:442px;bottom:123px;letter-spacing:0.22px;}
#t3c_353{left:481px;bottom:123px;letter-spacing:0.14px;word-spacing:2.97px;}
#t3d_353{left:587px;bottom:123px;letter-spacing:0.21px;}
#t3e_353{left:680px;bottom:123px;letter-spacing:0.07px;word-spacing:3.1px;}
#t3f_353{left:142px;bottom:103px;letter-spacing:0.12px;word-spacing:0.07px;}

.s1_353{font-size:14px;font-family:NewBaskerville-Bold_h-a;color:#000;}
.s2_353{font-size:12px;font-family:FranklinGothic-Demi_ib4;color:#656565;}
.s3_353{font-size:10px;font-family:FranklinGothic-Demi_ib4;color:#656565;}
.s4_353{font-size:14px;font-family:NewBaskerville-BoldItalic_h-c;color:#656565;}
.s5_353{font-size:15px;font-family:NewBaskerville-Roman_ib3;color:#252525;}
.s6_353{font-size:14px;font-family:Courier_h-e;color:#252525;}
.s7_353{font-size:13px;font-family:Wingdings2_hia;color:#CCA659;}
.s8_353{font-size:16px;font-family:FranklinGothic-DemiItal_ib5;color:#476B85;}
.s9_353{font-size:12px;font-family:Courier_h-e;color:#252525;}
.t.v0_353{transform:scaleX(0.907);}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts353" type="text/css" >

@font-face {
	font-family: Courier_h-e;
	src: url("fonts/Courier_h-e.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-DemiItal_ib5;
	src: url("fonts/FranklinGothic-DemiItal_ib5.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-Demi_ib4;
	src: url("fonts/FranklinGothic-Demi_ib4.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-BoldItalic_h-c;
	src: url("fonts/NewBaskerville-BoldItalic_h-c.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Bold_h-a;
	src: url("fonts/NewBaskerville-Bold_h-a.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Roman_ib3;
	src: url("fonts/NewBaskerville-Roman_ib3.woff") format("woff");
}

@font-face {
	font-family: Wingdings2_hia;
	src: url("fonts/Wingdings2_hia.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg353Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg353" style="-webkit-user-select: none;"><object width="811" height="1017" data="353/353.svg" type="image/svg+xml" id="pdf353" style="width:811px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_353" class="t s1_353">326 </span><span id="t2_353" class="t s2_353">C</span><span id="t3_353" class="t s3_353">HAPTER </span><span id="t4_353" class="t s2_353">12 </span><span id="t5_353" class="t s4_353">Developing reactive APIs </span>
<span id="t6_353" class="t s5_353">But all of the methods provided by </span><span id="t7_353" class="t v0_353 s6_353">RestTemplate </span><span id="t8_353" class="t s5_353">deal in nonreactive domain </span>
<span id="t9_353" class="t s5_353">types and collections. This means that if you want to work with a response’s data in a </span>
<span id="ta_353" class="t s5_353">reactive way, you’ll need to wrap it with a </span><span id="tb_353" class="t v0_353 s6_353">Flux </span><span id="tc_353" class="t s5_353">or </span><span id="td_353" class="t v0_353 s6_353">Mono</span><span id="te_353" class="t s5_353">. And if you already have a </span><span id="tf_353" class="t v0_353 s6_353">Flux </span>
<span id="tg_353" class="t s5_353">or </span><span id="th_353" class="t v0_353 s6_353">Mono </span><span id="ti_353" class="t s5_353">and you want to send it in a </span><span id="tj_353" class="t v0_353 s6_353">POST </span><span id="tk_353" class="t s5_353">or </span><span id="tl_353" class="t v0_353 s6_353">PUT </span><span id="tm_353" class="t s5_353">request, then you’ll need to extract </span>
<span id="tn_353" class="t s5_353">the data into a nonreactive type before making the request. </span>
<span id="to_353" class="t s5_353">It would be nice if there was a way to use </span><span id="tp_353" class="t v0_353 s6_353">RestTemplate </span><span id="tq_353" class="t s5_353">natively with reactive </span>
<span id="tr_353" class="t s5_353">types. Fear not. Spring offers </span><span id="ts_353" class="t v0_353 s6_353">WebClient </span><span id="tt_353" class="t s5_353">as a reactive alternative to </span><span id="tu_353" class="t v0_353 s6_353">RestTemplate</span><span id="tv_353" class="t s5_353">. </span>
<span id="tw_353" class="t v0_353 s6_353">WebClient </span><span id="tx_353" class="t s5_353">lets you both send and receive reactive types when making requests to </span>
<span id="ty_353" class="t s5_353">external APIs. </span>
<span id="tz_353" class="t s5_353">Using </span><span id="t10_353" class="t v0_353 s6_353">WebClient </span><span id="t11_353" class="t s5_353">is quite different from using </span><span id="t12_353" class="t v0_353 s6_353">RestTemplate</span><span id="t13_353" class="t s5_353">. Rather than having </span>
<span id="t14_353" class="t s5_353">several methods to handle different kinds of requests, </span><span id="t15_353" class="t v0_353 s6_353">WebClient </span><span id="t16_353" class="t s5_353">has a fluent builder- </span>
<span id="t17_353" class="t s5_353">style interface that lets you describe and send requests. The general usage pattern for </span>
<span id="t18_353" class="t s5_353">working with </span><span id="t19_353" class="t v0_353 s6_353">WebClient </span><span id="t1a_353" class="t s5_353">follows: </span>
<span id="t1b_353" class="t s7_353"> </span><span id="t1c_353" class="t s5_353">Create an instance of </span><span id="t1d_353" class="t v0_353 s6_353">WebClient </span><span id="t1e_353" class="t s5_353">(or inject a </span><span id="t1f_353" class="t v0_353 s6_353">WebClient </span><span id="t1g_353" class="t s5_353">bean) </span>
<span id="t1h_353" class="t s7_353"> </span><span id="t1i_353" class="t s5_353">Specify the HTTP method of the request to send </span>
<span id="t1j_353" class="t s7_353"> </span><span id="t1k_353" class="t s5_353">Specify the URI and any headers that should be in the request </span>
<span id="t1l_353" class="t s7_353"> </span><span id="t1m_353" class="t s5_353">Submit the request </span>
<span id="t1n_353" class="t s7_353"> </span><span id="t1o_353" class="t s5_353">Consume the response </span>
<span id="t1p_353" class="t s5_353">Let’s look at several examples of </span><span id="t1q_353" class="t v0_353 s6_353">WebClient </span><span id="t1r_353" class="t s5_353">in action, starting with how to use </span><span id="t1s_353" class="t v0_353 s6_353">Web- </span>
<span id="t1t_353" class="t v0_353 s6_353">Client </span><span id="t1u_353" class="t s5_353">to send HTTP </span><span id="t1v_353" class="t v0_353 s6_353">GET </span><span id="t1w_353" class="t s5_353">requests. </span>
<span id="t1x_353" class="t s8_353">12.4.1 </span><span id="t1y_353" class="t s8_353">GETting resources </span>
<span id="t1z_353" class="t s5_353">As an example of </span><span id="t20_353" class="t v0_353 s6_353">WebClient </span><span id="t21_353" class="t s5_353">usage, suppose that you need to fetch an </span><span id="t22_353" class="t v0_353 s6_353">Ingredient </span>
<span id="t23_353" class="t s5_353">object by its ID from the Taco Cloud API. Using </span><span id="t24_353" class="t v0_353 s6_353">RestTemplate</span><span id="t25_353" class="t s5_353">, you might use the </span><span id="t26_353" class="t v0_353 s6_353">get- </span>
<span id="t27_353" class="t v0_353 s6_353">ForObject() </span><span id="t28_353" class="t s5_353">method. But with </span><span id="t29_353" class="t v0_353 s6_353">WebClient</span><span id="t2a_353" class="t s5_353">, you build the request, retrieve a response, </span>
<span id="t2b_353" class="t s5_353">and then extract a </span><span id="t2c_353" class="t v0_353 s6_353">Mono </span><span id="t2d_353" class="t s5_353">that publishes the </span><span id="t2e_353" class="t v0_353 s6_353">Ingredient </span><span id="t2f_353" class="t s5_353">object, as shown here: </span>
<span id="t2g_353" class="t s9_353">Mono&lt;Ingredient&gt; ingredient = WebClient.create() </span>
<span id="t2h_353" class="t s9_353">.get() </span>
<span id="t2i_353" class="t s9_353">.uri("http://localhost:8080/ingredients/{id}", ingredientId) </span>
<span id="t2j_353" class="t s9_353">.retrieve() </span>
<span id="t2k_353" class="t s9_353">.bodyToMono(Ingredient.class); </span>
<span id="t2l_353" class="t s9_353">ingredient.subscribe(i -&gt; { ... }); </span>
<span id="t2m_353" class="t s5_353">Here you create a new </span><span id="t2n_353" class="t v0_353 s6_353">WebClient </span><span id="t2o_353" class="t s5_353">instance with </span><span id="t2p_353" class="t v0_353 s6_353">create()</span><span id="t2q_353" class="t s5_353">. Then you use </span><span id="t2r_353" class="t v0_353 s6_353">get() </span><span id="t2s_353" class="t s5_353">and </span>
<span id="t2t_353" class="t v0_353 s6_353">uri() </span><span id="t2u_353" class="t s5_353">to define a </span><span id="t2v_353" class="t v0_353 s6_353">GET </span><span id="t2w_353" class="t s5_353">request to http://localhost:8080/ingredients/{id}, where the </span>
<span id="t2x_353" class="t s5_353">{id} placeholder will be replaced by the value in </span><span id="t2y_353" class="t v0_353 s6_353">ingredientId</span><span id="t2z_353" class="t s5_353">. The </span><span id="t30_353" class="t v0_353 s6_353">retrieve() </span>
<span id="t31_353" class="t s5_353">method executes the request. Finally, a call to </span><span id="t32_353" class="t v0_353 s6_353">bodyToMono() </span><span id="t33_353" class="t s5_353">extracts the response’s </span>
<span id="t34_353" class="t s5_353">body payload into a </span><span id="t35_353" class="t v0_353 s6_353">Mono&lt;Ingredient&gt; </span><span id="t36_353" class="t s5_353">on which you can continue applying addi- </span>
<span id="t37_353" class="t s5_353">tional </span><span id="t38_353" class="t v0_353 s6_353">Mono </span><span id="t39_353" class="t s5_353">operations. </span>
<span id="t3a_353" class="t s5_353">To apply additional operations on the </span><span id="t3b_353" class="t v0_353 s6_353">Mono </span><span id="t3c_353" class="t s5_353">returned from </span><span id="t3d_353" class="t v0_353 s6_353">bodyToMono()</span><span id="t3e_353" class="t s5_353">, it’s </span>
<span id="t3f_353" class="t s5_353">important to subscribe to it before the request will even be sent. Making requests that </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
