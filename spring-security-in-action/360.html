<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p360" style="overflow: hidden; position: relative; background-color: white; width: 811px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_360{left:87px;bottom:960px;letter-spacing:-0.13px;}
#t2_360{left:231px;bottom:961px;}
#t3_360{left:239px;bottom:962px;letter-spacing:-0.14px;}
#t4_360{left:279px;bottom:961px;letter-spacing:0.13px;}
#t5_360{left:305px;bottom:960px;letter-spacing:-0.11px;word-spacing:0.01px;}
#t6_360{left:161px;bottom:900px;letter-spacing:0.22px;}
#t7_360{left:161px;bottom:880px;letter-spacing:0.22px;word-spacing:1.08px;}
#t8_360{left:161px;bottom:863px;letter-spacing:0.21px;word-spacing:0.71px;}
#t9_360{left:161px;bottom:846px;letter-spacing:0.21px;word-spacing:-0.4px;}
#ta_360{left:161px;bottom:829px;letter-spacing:0.21px;word-spacing:-0.19px;}
#tb_360{left:161px;bottom:811px;letter-spacing:0.2px;word-spacing:-0.53px;}
#tc_360{left:161px;bottom:794px;letter-spacing:0.21px;word-spacing:-0.02px;}
#td_360{left:185px;bottom:772px;}
#te_360{left:203px;bottom:771px;letter-spacing:0.21px;word-spacing:2.48px;}
#tf_360{left:688px;bottom:771px;}
#tg_360{left:203px;bottom:754px;letter-spacing:0.23px;word-spacing:-0.03px;}
#th_360{left:185px;bottom:736px;}
#ti_360{left:203px;bottom:735px;letter-spacing:0.17px;word-spacing:0.41px;}
#tj_360{left:366px;bottom:735px;}
#tk_360{left:375px;bottom:735px;letter-spacing:0.2px;word-spacing:0.39px;}
#tl_360{left:203px;bottom:718px;letter-spacing:0.21px;}
#tm_360{left:185px;bottom:700px;}
#tn_360{left:203px;bottom:700px;letter-spacing:0.19px;word-spacing:-0.25px;}
#to_360{left:379px;bottom:699px;}
#tp_360{left:387px;bottom:700px;letter-spacing:0.18px;word-spacing:-0.26px;}
#tq_360{left:203px;bottom:682px;letter-spacing:0.16px;word-spacing:0.05px;}
#tr_360{left:161px;bottom:655px;letter-spacing:0.24px;word-spacing:1.43px;}
#ts_360{left:161px;bottom:637px;letter-spacing:0.22px;word-spacing:-0.21px;}
#tt_360{left:161px;bottom:612px;letter-spacing:0.13px;}
#tu_360{left:212px;bottom:597px;letter-spacing:0.14px;}
#tv_360{left:212px;bottom:582px;letter-spacing:0.13px;}
#tw_360{left:212px;bottom:566px;letter-spacing:0.13px;}
#tx_360{left:227px;bottom:551px;letter-spacing:0.14px;}
#ty_360{left:227px;bottom:536px;letter-spacing:0.14px;}
#tz_360{left:212px;bottom:521px;letter-spacing:0.13px;}
#t10_360{left:161px;bottom:492px;letter-spacing:0.22px;word-spacing:-0.46px;}
#t11_360{left:161px;bottom:475px;letter-spacing:0.21px;word-spacing:-0.38px;}
#t12_360{left:161px;bottom:458px;letter-spacing:0.22px;word-spacing:0.98px;}
#t13_360{left:161px;bottom:441px;letter-spacing:0.22px;word-spacing:-0.23px;}
#t14_360{left:161px;bottom:424px;letter-spacing:0.21px;word-spacing:-0.07px;}
#t15_360{left:161px;bottom:406px;letter-spacing:0.25px;word-spacing:2.63px;}
#t16_360{left:161px;bottom:389px;letter-spacing:0.22px;word-spacing:-0.36px;}
#t17_360{left:161px;bottom:372px;letter-spacing:0.24px;word-spacing:-0.96px;}
#t18_360{left:161px;bottom:355px;letter-spacing:0.21px;word-spacing:0.58px;}
#t19_360{left:161px;bottom:338px;letter-spacing:0.22px;word-spacing:1.57px;}
#t1a_360{left:161px;bottom:321px;letter-spacing:0.22px;word-spacing:0.4px;}
#t1b_360{left:161px;bottom:304px;letter-spacing:0.22px;word-spacing:0.58px;}
#t1c_360{left:161px;bottom:287px;letter-spacing:0.21px;word-spacing:-0.88px;}
#t1d_360{left:161px;bottom:270px;letter-spacing:0.22px;word-spacing:0.01px;}
#t1e_360{left:161px;bottom:244px;letter-spacing:0.13px;}
#t1f_360{left:212px;bottom:229px;letter-spacing:0.14px;}
#t1g_360{left:212px;bottom:214px;letter-spacing:0.13px;}
#t1h_360{left:212px;bottom:199px;letter-spacing:0.14px;}
#t1i_360{left:212px;bottom:183px;letter-spacing:0.13px;}
#t1j_360{left:161px;bottom:155px;letter-spacing:0.22px;word-spacing:-1.07px;}
#t1k_360{left:161px;bottom:138px;letter-spacing:0.21px;word-spacing:-0.05px;}

.s1_360{font-size:14px;font-family:NewBaskerville-Bold_w3;color:#252525;}
.s2_360{font-size:12px;font-family:FranklinGothic-Demi_yq;color:#656565;}
.s3_360{font-size:10px;font-family:FranklinGothic-Demi_yq;color:#656565;}
.s4_360{font-size:14px;font-family:NewBaskerville-BoldItalic_zn;color:#656565;}
.s5_360{font-size:14px;font-family:FranklinGothic-DemiItal_15g;color:#476B85;}
.s6_360{font-size:14px;font-family:FranklinGothic-Book_16l;color:#252525;}
.s7_360{font-size:13px;font-family:Wingdings2_15e;color:#CCA659;}
.s8_360{font-size:14px;font-family:FranklinGothic-BookItal_yl;color:#252525;}
.s9_360{font-size:15px;font-family:NewBaskerville-Italic_vq;color:#252525;}
.sa_360{font-size:12px;font-family:Courier_166;color:#252525;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts360" type="text/css" >

@font-face {
	font-family: Courier_166;
	src: url("fonts/Courier_166.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-BookItal_yl;
	src: url("fonts/FranklinGothic-BookItal_yl.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-Book_16l;
	src: url("fonts/FranklinGothic-Book_16l.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-DemiItal_15g;
	src: url("fonts/FranklinGothic-DemiItal_15g.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-Demi_yq;
	src: url("fonts/FranklinGothic-Demi_yq.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-BoldItalic_zn;
	src: url("fonts/NewBaskerville-BoldItalic_zn.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Bold_w3;
	src: url("fonts/NewBaskerville-Bold_w3.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Italic_vq;
	src: url("fonts/NewBaskerville-Italic_vq.woff") format("woff");
}

@font-face {
	font-family: Wingdings2_15e;
	src: url("fonts/Wingdings2_15e.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg360Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg360" style="-webkit-user-select: none;"><object width="811" height="1017" data="360/360.svg" type="image/svg+xml" id="pdf360" style="width:811px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_360" class="t s1_360">330 </span><span id="t2_360" class="t s2_360">C</span><span id="t3_360" class="t s3_360">HAPTER </span><span id="t4_360" class="t s2_360">13 </span><span id="t5_360" class="t s4_360">OAuth 2: Implementing the authorization server </span>
<span id="t6_360" class="t s5_360">(continued) </span>
<span id="t7_360" class="t s6_360">In the OAuth 2 flow, the client, even if it’s an application, acts as an independent </span>
<span id="t8_360" class="t s6_360">component having its own credentials, which it uses to identify itself. Because you </span>
<span id="t9_360" class="t s6_360">don’t share user credentials, you shouldn’t share client credentials either. Even if all </span>
<span id="ta_360" class="t s6_360">applications that define clients are part of the same system, nothing stops you from </span>
<span id="tb_360" class="t s6_360">registering these as separate clients at the authorization server level. Registering cli- </span>
<span id="tc_360" class="t s6_360">ents individually with the authorization server brings the following benefits: </span>
<span id="td_360" class="t s7_360"> </span><span id="te_360" class="t s8_360">It provides the possibility to audit events individually from each application</span><span id="tf_360" class="t s9_360">. </span>
<span id="tg_360" class="t s6_360">When you log events, you know which client generated them. </span>
<span id="th_360" class="t s7_360"> </span><span id="ti_360" class="t s8_360">It allows stronger isolation</span><span id="tj_360" class="t s9_360">. </span><span id="tk_360" class="t s6_360">If one pair of credentials is lost, only one client is </span>
<span id="tl_360" class="t s6_360">affected. </span>
<span id="tm_360" class="t s7_360"> </span><span id="tn_360" class="t s8_360">It allows separation of scope</span><span id="to_360" class="t s9_360">. </span><span id="tp_360" class="t s6_360">You can assign different scopes (granted author- </span>
<span id="tq_360" class="t s6_360">ities) to a client that obtains the token in a specific way. </span>
<span id="tr_360" class="t s6_360">Scope separation is fundamental, and managing it incorrectly can lead to strange </span>
<span id="ts_360" class="t s6_360">scenarios. Let’s assume you defined a client as presented in the next code snippet: </span>
<span id="tt_360" class="t sa_360">clients.inMemory() </span>
<span id="tu_360" class="t sa_360">.withClient("client") </span>
<span id="tv_360" class="t sa_360">.secret("secret") </span>
<span id="tw_360" class="t sa_360">.authorizedGrantTypes( </span>
<span id="tx_360" class="t sa_360">"authorization_code", </span>
<span id="ty_360" class="t sa_360">"client_credentials") </span>
<span id="tz_360" class="t sa_360">.scopes("read") </span>
<span id="t10_360" class="t s6_360">This client is configured for the authorization code and client credentials grant types. </span>
<span id="t11_360" class="t s6_360">Using either of these, the client obtains an access token, which provides it with read </span>
<span id="t12_360" class="t s6_360">authority. What is strange here is that the client can get the same token either by </span>
<span id="t13_360" class="t s6_360">authenticating a user or by only using its own credentials. This doesn’t make sense, </span>
<span id="t14_360" class="t s6_360">and one could even argue this is a security breach. Even if it sounds strange to you, </span>
<span id="t15_360" class="t s6_360">I’ve seen this in practice in a system I was asked to audit. Why was the code </span>
<span id="t16_360" class="t s6_360">designed that way for that system? Most probably, the developers didn’t understand </span>
<span id="t17_360" class="t s6_360">the purpose of the grant types and used some code they’ve found somewhere around </span>
<span id="t18_360" class="t s6_360">the web. That’s the only thing I could imagine when I saw that all the clients in the </span>
<span id="t19_360" class="t s6_360">system were configured with the same list containing all the possible grant types </span>
<span id="t1a_360" class="t s6_360">(some of these being strings that don’t even exist as a grant type!). Make sure you </span>
<span id="t1b_360" class="t s6_360">avoid such mistakes. Be careful. To specify grant types, you use strings, not enum </span>
<span id="t1c_360" class="t s6_360">values, and this design could lead to mistakes. And yes, you can write a configuration </span>
<span id="t1d_360" class="t s6_360">like the one presented in this code snippet: </span>
<span id="t1e_360" class="t sa_360">clients.inMemory() </span>
<span id="t1f_360" class="t sa_360">.withClient("client") </span>
<span id="t1g_360" class="t sa_360">.secret("secret") </span>
<span id="t1h_360" class="t sa_360">.authorizedGrantTypes("password", "hocus_pocus") </span>
<span id="t1i_360" class="t sa_360">.scopes("read") </span>
<span id="t1j_360" class="t s6_360">As long as you don’t try to use the “hocus_pocus” grant type, the application will actu- </span>
<span id="t1k_360" class="t s6_360">ally work. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
