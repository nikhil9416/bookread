<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p320" style="overflow: hidden; position: relative; background-color: white; width: 811px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_320{left:87px;bottom:960px;letter-spacing:-0.13px;}
#t2_320{left:292px;bottom:961px;}
#t3_320{left:300px;bottom:962px;letter-spacing:-0.15px;}
#t4_320{left:340px;bottom:961px;letter-spacing:0.13px;}
#t5_320{left:366px;bottom:960px;letter-spacing:-0.13px;word-spacing:0.01px;}
#t6_320{left:142px;bottom:917px;letter-spacing:0.12px;word-spacing:-0.18px;}
#t7_320{left:142px;bottom:898px;letter-spacing:0.12px;word-spacing:3.64px;}
#t8_320{left:142px;bottom:878px;letter-spacing:0.12px;}
#t9_320{left:161px;bottom:844px;letter-spacing:-0.03px;}
#ta_320{left:208px;bottom:843px;letter-spacing:0.12px;word-spacing:1.45px;}
#tb_320{left:161px;bottom:824px;letter-spacing:0.14px;word-spacing:2.94px;}
#tc_320{left:161px;bottom:806px;letter-spacing:0.12px;word-spacing:0.29px;}
#td_320{left:161px;bottom:788px;letter-spacing:0.13px;word-spacing:1.67px;}
#te_320{left:161px;bottom:769px;letter-spacing:0.11px;word-spacing:2.05px;}
#tf_320{left:161px;bottom:751px;letter-spacing:0.12px;word-spacing:2.93px;}
#tg_320{left:161px;bottom:733px;letter-spacing:0.12px;word-spacing:2.6px;}
#th_320{left:596px;bottom:733px;letter-spacing:0.05px;word-spacing:2.58px;}
#ti_320{left:670px;bottom:733px;}
#tj_320{left:161px;bottom:714px;letter-spacing:0.12px;word-spacing:0.74px;}
#tk_320{left:161px;bottom:696px;letter-spacing:0.13px;word-spacing:4.61px;}
#tl_320{left:161px;bottom:678px;letter-spacing:0.13px;word-spacing:1.5px;}
#tm_320{left:161px;bottom:659px;letter-spacing:0.12px;word-spacing:0.02px;}
#tn_320{left:142px;bottom:626px;letter-spacing:0.11px;word-spacing:0.88px;}
#to_320{left:142px;bottom:606px;letter-spacing:0.12px;word-spacing:-0.01px;}
#tp_320{left:165px;bottom:587px;}
#tq_320{left:185px;bottom:584px;letter-spacing:0.12px;word-spacing:0.02px;}
#tr_320{left:165px;bottom:565px;}
#ts_320{left:185px;bottom:563px;letter-spacing:0.12px;word-spacing:-0.04px;}
#tt_320{left:165px;bottom:544px;}
#tu_320{left:185px;bottom:542px;letter-spacing:0.11px;word-spacing:0.06px;}
#tv_320{left:142px;bottom:515px;}
#tw_320{left:151px;bottom:516px;letter-spacing:-0.22px;}
#tx_320{left:176px;bottom:515px;letter-spacing:0.24px;word-spacing:-0.04px;}
#ty_320{left:206px;bottom:516px;letter-spacing:-0.22px;}
#tz_320{left:244px;bottom:516px;letter-spacing:-0.23px;}
#t10_320{left:269px;bottom:516px;letter-spacing:-0.23px;}
#t11_320{left:366px;bottom:516px;letter-spacing:-0.25px;}
#t12_320{left:420px;bottom:516px;letter-spacing:-0.25px;}
#t13_320{left:453px;bottom:516px;letter-spacing:-0.23px;}
#t14_320{left:478px;bottom:516px;letter-spacing:-0.24px;}
#t15_320{left:570px;bottom:516px;letter-spacing:-0.24px;}
#t16_320{left:604px;bottom:516px;letter-spacing:-0.26px;}
#t17_320{left:645px;bottom:516px;letter-spacing:-0.22px;}
#t18_320{left:142px;bottom:495px;letter-spacing:0.13px;word-spacing:1.55px;}
#t19_320{left:142px;bottom:475px;letter-spacing:0.12px;word-spacing:0.31px;}
#t1a_320{left:142px;bottom:455px;letter-spacing:0.1px;word-spacing:0.26px;}
#t1b_320{left:142px;bottom:435px;letter-spacing:0.13px;word-spacing:-0.22px;}
#t1c_320{left:142px;bottom:414px;letter-spacing:0.11px;word-spacing:0.03px;}
#t1d_320{left:161px;bottom:383px;letter-spacing:-0.03px;}
#t1e_320{left:208px;bottom:382px;letter-spacing:0.12px;word-spacing:4.13px;}
#t1f_320{left:161px;bottom:364px;letter-spacing:0.11px;word-spacing:1.15px;}
#t1g_320{left:161px;bottom:345px;letter-spacing:0.09px;word-spacing:0.03px;}
#t1h_320{left:142px;bottom:315px;letter-spacing:0.07px;word-spacing:0.09px;}
#t1i_320{left:142px;bottom:295px;letter-spacing:0.1px;word-spacing:-0.08px;}
#t1j_320{left:142px;bottom:275px;letter-spacing:0.14px;word-spacing:-0.01px;}
#t1k_320{left:166px;bottom:250px;}
#t1l_320{left:185px;bottom:249px;letter-spacing:0.3px;}
#t1m_320{left:302px;bottom:249px;letter-spacing:0.11px;word-spacing:0.7px;}
#t1n_320{left:400px;bottom:249px;letter-spacing:0.3px;}
#t1o_320{left:435px;bottom:249px;letter-spacing:0.12px;word-spacing:0.68px;}
#t1p_320{left:185px;bottom:229px;letter-spacing:0.12px;word-spacing:0.51px;}
#t1q_320{left:185px;bottom:209px;letter-spacing:0.11px;word-spacing:-0.02px;}
#t1r_320{left:166px;bottom:189px;}
#t1s_320{left:185px;bottom:188px;letter-spacing:0.29px;}
#t1t_320{left:269px;bottom:188px;letter-spacing:0.11px;word-spacing:2.69px;}
#t1u_320{left:185px;bottom:168px;letter-spacing:0.08px;}
#t1v_320{left:166px;bottom:148px;}
#t1w_320{left:185px;bottom:147px;letter-spacing:0.3px;}
#t1x_320{left:289px;bottom:147px;letter-spacing:0.12px;word-spacing:0.48px;}
#t1y_320{left:185px;bottom:127px;letter-spacing:0.12px;word-spacing:4.16px;}
#t1z_320{left:185px;bottom:107px;letter-spacing:0.1px;word-spacing:0.4px;}
#t20_320{left:185px;bottom:87px;letter-spacing:0.12px;word-spacing:-0.02px;}

.s1_320{font-size:14px;font-family:NewBaskerville-Bold_w3;color:#252525;}
.s2_320{font-size:12px;font-family:FranklinGothic-Demi_yq;color:#656565;}
.s3_320{font-size:10px;font-family:FranklinGothic-Demi_yq;color:#656565;}
.s4_320{font-size:14px;font-family:NewBaskerville-BoldItalic_zn;color:#656565;}
.s5_320{font-size:15px;font-family:NewBaskerville-Roman_xo;color:#252525;}
.s6_320{font-size:13px;font-family:FranklinGothic-Demi_yq;color:#476B85;}
.s7_320{font-size:15px;font-family:NewBaskerville-Italic_vq;color:#252525;}
.s8_320{font-size:11px;font-family:FranklinGothic-Demi_yq;color:#CCA659;}
.s9_320{font-size:14px;font-family:FranklinGothic-Demi_yq;color:#476B85;}
.sa_320{font-size:12px;font-family:FranklinGothic-Demi_yq;color:#476B85;}
.sb_320{font-size:13px;font-family:Wingdings2_15e;color:#CCA659;}
.sc_320{font-size:14px;font-family:Courier_166;color:#252525;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts320" type="text/css" >

@font-face {
	font-family: Courier_166;
	src: url("fonts/Courier_166.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-Demi_yq;
	src: url("fonts/FranklinGothic-Demi_yq.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-BoldItalic_zn;
	src: url("fonts/NewBaskerville-BoldItalic_zn.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Bold_w3;
	src: url("fonts/NewBaskerville-Bold_w3.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Italic_vq;
	src: url("fonts/NewBaskerville-Italic_vq.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Roman_xo;
	src: url("fonts/NewBaskerville-Roman_xo.woff") format("woff");
}

@font-face {
	font-family: Wingdings2_15e;
	src: url("fonts/Wingdings2_15e.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg320Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg320" style="-webkit-user-select: none;"><object width="811" height="1017" data="320/320.svg" type="image/svg+xml" id="pdf320" style="width:811px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_320" class="t s1_320">290 </span><span id="t2_320" class="t s2_320">C</span><span id="t3_320" class="t s3_320">HAPTER </span><span id="t4_320" class="t s2_320">12 </span><span id="t5_320" class="t s4_320">How does OAuth 2 work? </span>
<span id="t6_320" class="t s5_320">commonly used OAuth 2 flows, so it’s quite important to understand how it works and </span>
<span id="t7_320" class="t s5_320">how to apply it. There’s a high probability that you’ll use it in applications you </span>
<span id="t8_320" class="t s5_320">develop. </span>
<span id="t9_320" class="t s6_320">NOTE </span><span id="ta_320" class="t s5_320">The arrows in figure 12.5 don’t necessarily represent HTTP requests </span>
<span id="tb_320" class="t s5_320">and responses. These represent messages exchanged among the actors of </span>
<span id="tc_320" class="t s5_320">OAuth 2. For example, when the client tells the user (second arrow from the </span>
<span id="td_320" class="t s5_320">top of the diagram), “Tell the authorization server you allow me to do this </span>
<span id="te_320" class="t s5_320">action,” the client then redirects the user to the authorization server login </span>
<span id="tf_320" class="t s5_320">page. When the authorization server gives the client an access token, the </span>
<span id="tg_320" class="t s5_320">authorization server actually calls the client on what we call a </span><span id="th_320" class="t s7_320">redirect URI</span><span id="ti_320" class="t s5_320">. </span>
<span id="tj_320" class="t s5_320">You’ll learn all these details in chapters 12 through 15, so don’t worry about </span>
<span id="tk_320" class="t s5_320">them for now. With this note, I wanted to make you aware that these </span>
<span id="tl_320" class="t s5_320">sequence diagrams are not just representing HTTP requests and responses. </span>
<span id="tm_320" class="t s5_320">These are a simplified description of communication among OAuth 2 actors. </span>
<span id="tn_320" class="t s5_320">Here’s how the authorization code grant type works. Following this, we dive into the </span>
<span id="to_320" class="t s5_320">details about each step. </span>
<span id="tp_320" class="t s8_320">1 </span><span id="tq_320" class="t s5_320">Make the authentication request </span>
<span id="tr_320" class="t s8_320">2 </span><span id="ts_320" class="t s5_320">Obtain an access token </span>
<span id="tt_320" class="t s8_320">3 </span><span id="tu_320" class="t s5_320">Call the protected resource </span>
<span id="tv_320" class="t s9_320">S</span><span id="tw_320" class="t sa_320">TEP </span><span id="tx_320" class="t s9_320">1: M</span><span id="ty_320" class="t sa_320">AKING </span><span id="tz_320" class="t sa_320">THE </span><span id="t10_320" class="t sa_320">AUTHENTICATION </span><span id="t11_320" class="t sa_320">REQUEST </span><span id="t12_320" class="t sa_320">WITH </span><span id="t13_320" class="t sa_320">THE </span><span id="t14_320" class="t sa_320">AUTHORIZATION </span><span id="t15_320" class="t sa_320">CODE </span><span id="t16_320" class="t sa_320">GRANT </span><span id="t17_320" class="t sa_320">TYPE </span>
<span id="t18_320" class="t s5_320">The client redirects the user to an endpoint of the authorization server where they </span>
<span id="t19_320" class="t s5_320">need to authenticate. You can imagine you are using app X, and you need to access a </span>
<span id="t1a_320" class="t s5_320">protected resource. To access that resource for you, app X needs you to authenticate. </span>
<span id="t1b_320" class="t s5_320">It opens a page for you with a login form on the authorization server that you must fill </span>
<span id="t1c_320" class="t s5_320">in with your credentials. </span>
<span id="t1d_320" class="t s6_320">NOTE </span><span id="t1e_320" class="t s5_320">What’s really important to observe here is that the user interacts </span>
<span id="t1f_320" class="t s5_320">directly with the authorization server. The user doesn’t send the credentials </span>
<span id="t1g_320" class="t s5_320">to the client app. </span>
<span id="t1h_320" class="t s5_320">Technically, what happens here is that when the client redirects the user to the autho- </span>
<span id="t1i_320" class="t s5_320">rization server, the client calls the authorization endpoint with the following details in </span>
<span id="t1j_320" class="t s5_320">the request query: </span>
<span id="t1k_320" class="t sb_320"> </span><span id="t1l_320" class="t sc_320">response_type </span><span id="t1m_320" class="t s5_320">with the value </span><span id="t1n_320" class="t sc_320">code</span><span id="t1o_320" class="t s5_320">, which tells the authorization server that </span>
<span id="t1p_320" class="t s5_320">the client expects a code. The client needs the code to obtain an access token, </span>
<span id="t1q_320" class="t s5_320">as you’ll see in the second step. </span>
<span id="t1r_320" class="t sb_320"> </span><span id="t1s_320" class="t sc_320">client_id </span><span id="t1t_320" class="t s5_320">with the value of the client ID, which identifies the application </span>
<span id="t1u_320" class="t s5_320">itself. </span>
<span id="t1v_320" class="t sb_320"> </span><span id="t1w_320" class="t sc_320">redirect_uri</span><span id="t1x_320" class="t s5_320">, which tells the authorization server where to redirect the user </span>
<span id="t1y_320" class="t s5_320">after successful authentication. Sometimes the authorization server already </span>
<span id="t1z_320" class="t s5_320">knows a default redirect URI for each client. For this reason, the client doesn’t </span>
<span id="t20_320" class="t s5_320">need to send the redirect URI. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
