<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p217" style="overflow: hidden; position: relative; background-color: white; width: 770px; height: 1010px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_217{left:110px;bottom:906px;letter-spacing:-0.16px;word-spacing:-0.83px;}
#t2_217{left:284px;bottom:907px;letter-spacing:0.01px;}
#t3_217{left:308px;bottom:906px;letter-spacing:-0.17px;word-spacing:-0.83px;}
#t4_217{left:110px;bottom:887px;letter-spacing:-0.16px;}
#t5_217{left:138px;bottom:888px;letter-spacing:0.01px;}
#t6_217{left:163px;bottom:887px;letter-spacing:-0.16px;}
#t7_217{left:110px;bottom:861px;letter-spacing:-0.22px;}
#t8_217{left:138px;bottom:840px;letter-spacing:0.11px;}
#t9_217{left:235px;bottom:825px;letter-spacing:0.11px;}
#ta_217{left:138px;bottom:810px;letter-spacing:0.1px;}
#tb_217{left:235px;bottom:810px;letter-spacing:0.11px;}
#tc_217{left:235px;bottom:796px;letter-spacing:0.11px;}
#td_217{left:110px;bottom:767px;letter-spacing:-0.18px;word-spacing:0.89px;}
#te_217{left:527px;bottom:768px;letter-spacing:0.01px;}
#tf_217{left:562px;bottom:767px;letter-spacing:-0.16px;word-spacing:0.89px;}
#tg_217{left:110px;bottom:748px;letter-spacing:-0.18px;word-spacing:0.42px;}
#th_217{left:488px;bottom:749px;letter-spacing:0.01px;}
#ti_217{left:583px;bottom:748px;letter-spacing:-0.19px;word-spacing:0.42px;}
#tj_217{left:110px;bottom:730px;letter-spacing:0.01px;}
#tk_217{left:143px;bottom:729px;letter-spacing:-0.15px;}
#tl_217{left:194px;bottom:730px;letter-spacing:0.01px;}
#tm_217{left:227px;bottom:729px;letter-spacing:-0.17px;word-spacing:1.01px;}
#tn_217{left:521px;bottom:730px;letter-spacing:0.01px;}
#to_217{left:553px;bottom:729px;letter-spacing:-0.15px;}
#tp_217{left:604px;bottom:730px;letter-spacing:0.01px;}
#tq_217{left:637px;bottom:729px;letter-spacing:-0.12px;word-spacing:1.01px;}
#tr_217{left:110px;bottom:711px;letter-spacing:-0.17px;word-spacing:-0.22px;}
#ts_217{left:346px;bottom:711px;letter-spacing:0.01px;}
#tt_217{left:391px;bottom:711px;letter-spacing:-0.17px;word-spacing:-0.22px;}
#tu_217{left:110px;bottom:692px;letter-spacing:-0.18px;}
#tv_217{left:226px;bottom:693px;letter-spacing:0.01px;}
#tw_217{left:258px;bottom:692px;letter-spacing:-0.16px;}
#tx_217{left:110px;bottom:666px;letter-spacing:-0.19px;}
#ty_217{left:138px;bottom:644px;letter-spacing:0.11px;}
#tz_217{left:235px;bottom:630px;letter-spacing:0.11px;}
#t10_217{left:138px;bottom:615px;letter-spacing:0.11px;}
#t11_217{left:235px;bottom:600px;letter-spacing:0.11px;}
#t12_217{left:138px;bottom:586px;letter-spacing:0.11px;}
#t13_217{left:235px;bottom:571px;letter-spacing:0.11px;}
#t14_217{left:235px;bottom:556px;letter-spacing:0.11px;}
#t15_217{left:110px;bottom:528px;letter-spacing:-0.17px;}
#t16_217{left:141px;bottom:528px;letter-spacing:0.01px;}
#t17_217{left:196px;bottom:528px;letter-spacing:-0.18px;word-spacing:1.84px;}
#t18_217{left:110px;bottom:509px;letter-spacing:-0.18px;word-spacing:0.78px;}
#t19_217{left:110px;bottom:490px;letter-spacing:-0.18px;word-spacing:0.42px;}
#t1a_217{left:110px;bottom:471px;letter-spacing:-0.18px;}
#t1b_217{left:110px;bottom:453px;letter-spacing:-0.17px;word-spacing:1.4px;}
#t1c_217{left:252px;bottom:453px;letter-spacing:0.01px;}
#t1d_217{left:377px;bottom:453px;letter-spacing:-0.17px;word-spacing:1.4px;}
#t1e_217{left:110px;bottom:434px;letter-spacing:-0.17px;word-spacing:0.67px;}
#t1f_217{left:110px;bottom:415px;letter-spacing:-0.16px;}
#t1g_217{left:597px;bottom:416px;letter-spacing:0.01px;}
#t1h_217{left:110px;bottom:397px;letter-spacing:0.01px;}
#t1i_217{left:166px;bottom:397px;letter-spacing:-0.17px;word-spacing:-1.31px;}
#t1j_217{left:110px;bottom:378px;letter-spacing:-0.18px;}
#t1k_217{left:110px;bottom:352px;letter-spacing:0.01px;}
#t1l_217{left:207px;bottom:352px;letter-spacing:-0.18px;word-spacing:2.13px;}
#t1m_217{left:110px;bottom:333px;letter-spacing:-0.18px;word-spacing:1.23px;}
#t1n_217{left:110px;bottom:314px;letter-spacing:-0.17px;word-spacing:2.04px;}
#t1o_217{left:199px;bottom:315px;letter-spacing:0.01px;}
#t1p_217{left:318px;bottom:314px;}
#t1q_217{left:328px;bottom:315px;letter-spacing:0.01px;}
#t1r_217{left:405px;bottom:314px;}
#t1s_217{left:415px;bottom:315px;letter-spacing:0.01px;}
#t1t_217{left:484px;bottom:314px;letter-spacing:-0.16px;}
#t1u_217{left:514px;bottom:315px;letter-spacing:0.01px;}
#t1v_217{left:577px;bottom:314px;letter-spacing:-0.2px;word-spacing:2.04px;}
#t1w_217{left:110px;bottom:296px;letter-spacing:-0.16px;word-spacing:-0.25px;}
#t1x_217{left:573px;bottom:296px;letter-spacing:0.01px;}
#t1y_217{left:619px;bottom:296px;letter-spacing:-0.14px;word-spacing:-0.25px;}
#t1z_217{left:110px;bottom:277px;letter-spacing:-0.17px;}
#t20_217{left:110px;bottom:235px;letter-spacing:-0.03px;}
#t21_217{left:110px;bottom:212px;letter-spacing:-0.17px;word-spacing:-0.61px;}
#t22_217{left:110px;bottom:194px;letter-spacing:-0.18px;word-spacing:0.84px;}
#t23_217{left:110px;bottom:175px;letter-spacing:-0.18px;word-spacing:1.56px;}
#t24_217{left:386px;bottom:176px;letter-spacing:0.01px;}
#t25_217{left:512px;bottom:175px;letter-spacing:-0.17px;word-spacing:1.56px;}
#t26_217{left:110px;bottom:156px;letter-spacing:-0.18px;word-spacing:0.45px;}
#t27_217{left:338px;bottom:157px;letter-spacing:0.01px;}
#t28_217{left:485px;bottom:156px;letter-spacing:-0.17px;word-spacing:0.45px;}
#t29_217{left:110px;bottom:137px;letter-spacing:-0.18px;word-spacing:0.83px;}
#t2a_217{left:110px;bottom:119px;letter-spacing:-0.17px;word-spacing:0.09px;}
#t2b_217{left:534px;bottom:119px;letter-spacing:0.01px;}
#t2c_217{left:530px;bottom:60px;letter-spacing:-0.07px;}
#t2d_217{left:554px;bottom:60px;letter-spacing:-0.1px;}
#t2e_217{left:631px;bottom:60px;}
#t2f_217{left:643px;bottom:60px;letter-spacing:-0.1px;}

.s1_217{font-size:16px;font-family:CNCSGY-2bBirka_1c;color:#000;}
.s2_217{font-size:14px;font-family:CNCSGY-2bTheSansMonoCd-W5Reg_dv;color:#000;}
.s3_217{font-size:16px;font-family:CNCSGY-2bBirka-Bold_fj;color:#000;}
.s4_217{font-size:12px;font-family:CNCSGY-2bTheSansMonoCd-W5Reg_dv;color:#000;}
.s5_217{font-size:23px;font-family:CNCSGY-2bMyriadPro-SemiboldCo_q;color:#000;}
.s6_217{font-size:14px;font-family:CNCSGY-2bMyriadPro-SemiboldCo_q;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts217" type="text/css" >

@font-face {
	font-family: CNCSGY-2bBirka-Bold_fj;
	src: url("fonts/CNCSGY-2bBirka-Bold_fj.woff") format("woff");
}

@font-face {
	font-family: CNCSGY-2bBirka_1c;
	src: url("fonts/CNCSGY-2bBirka_1c.woff") format("woff");
}

@font-face {
	font-family: CNCSGY-2bMyriadPro-SemiboldCo_q;
	src: url("fonts/CNCSGY-2bMyriadPro-SemiboldCo_q.woff") format("woff");
}

@font-face {
	font-family: CNCSGY-2bTheSansMonoCd-W5Reg_dv;
	src: url("fonts/CNCSGY-2bTheSansMonoCd-W5Reg_dv.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg217Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg217" style="-webkit-user-select: none;"><object width="770" height="1010" data="217/217.svg" type="image/svg+xml" id="pdf217" style="width:770px; height:1010px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_217" class="t s1_217">succeed within its timeout, </span><span id="t2_217" class="t s2_217">add </span><span id="t3_217" class="t s1_217">throws an exception if it does not succeed immediately, </span>
<span id="t4_217" class="t s1_217">and </span><span id="t5_217" class="t s2_217">put </span><span id="t6_217" class="t s1_217">blocks until it succeeds. </span>
<span id="t7_217" class="t s3_217">Removing an Element </span>
<span id="t8_217" class="t s4_217">E poll(long timeout, TimeUnit unit) </span>
<span id="t9_217" class="t s4_217">// retrieve and remove the head, waiting up to the timeout </span>
<span id="ta_217" class="t s4_217">E take() </span><span id="tb_217" class="t s4_217">// retrieve and remove the head of this queue, waiting </span>
<span id="tc_217" class="t s4_217">// as long as necessary </span>
<span id="td_217" class="t s1_217">Again taking these methods together with those inherited from </span><span id="te_217" class="t s2_217">Queue</span><span id="tf_217" class="t s1_217">, there are four </span>
<span id="tg_217" class="t s1_217">ways in which the methods for removing elements from a </span><span id="th_217" class="t s2_217">BlockingQueue </span><span id="ti_217" class="t s1_217">can behave: </span>
<span id="tj_217" class="t s2_217">poll </span><span id="tk_217" class="t s1_217">returns </span><span id="tl_217" class="t s2_217">null </span><span id="tm_217" class="t s1_217">if it does not succeed immediately, blocking </span><span id="tn_217" class="t s2_217">poll </span><span id="to_217" class="t s1_217">returns </span><span id="tp_217" class="t s2_217">null </span><span id="tq_217" class="t s1_217">if it </span>
<span id="tr_217" class="t s1_217">does not succeed within its timeout, </span><span id="ts_217" class="t s2_217">remove </span><span id="tt_217" class="t s1_217">throws an exception if it does not succeed </span>
<span id="tu_217" class="t s1_217">immediately, and </span><span id="tv_217" class="t s2_217">take </span><span id="tw_217" class="t s1_217">blocks until it succeeds. </span>
<span id="tx_217" class="t s3_217">Retrieving or Querying the Contents of the Queue </span>
<span id="ty_217" class="t s4_217">int drainTo(Collection&lt;? super E&gt; c) </span>
<span id="tz_217" class="t s4_217">// clear the queue into c </span>
<span id="t10_217" class="t s4_217">int drainTo(Collection&lt;? super E&gt; c, int maxElements) </span>
<span id="t11_217" class="t s4_217">// clear at most the specified number of elements into c </span>
<span id="t12_217" class="t s4_217">int remainingCapacity() </span>
<span id="t13_217" class="t s4_217">// return the number of elements that would be accepted </span>
<span id="t14_217" class="t s4_217">// without blocking, or Integer.MAX_VALUE if unbounded </span>
<span id="t15_217" class="t s1_217">The </span><span id="t16_217" class="t s2_217">drainTo </span><span id="t17_217" class="t s1_217">methods perform atomically and efficiently, so the second overload is </span>
<span id="t18_217" class="t s1_217">useful in situations in which you know that you have processing capability available </span>
<span id="t19_217" class="t s1_217">immediately for a certain number of elements, and the first is useful—for example— </span>
<span id="t1a_217" class="t s1_217">when all producer threads have stopped working. Their return value is the number of </span>
<span id="t1b_217" class="t s1_217">elements transferred. </span><span id="t1c_217" class="t s2_217">RemainingCapacity </span><span id="t1d_217" class="t s1_217">reports the spare capacity of the queue, al- </span>
<span id="t1e_217" class="t s1_217">though as with any such value in multi-threaded contexts, the result of a call should </span>
<span id="t1f_217" class="t s1_217">not be used as part of a test-then-act sequence; between the test (the call of </span><span id="t1g_217" class="t s2_217">remaining </span>
<span id="t1h_217" class="t s2_217">Capacity</span><span id="t1i_217" class="t s1_217">) and the action (adding an element to the queue) of one thread, another thread </span>
<span id="t1j_217" class="t s1_217">might have intervened to add or remove elements. </span>
<span id="t1k_217" class="t s2_217">BlockingQueue </span><span id="t1l_217" class="t s1_217">guarantees that the queue operations of its implementations will be </span>
<span id="t1m_217" class="t s1_217">threadsafe and atomic. But this guarantee doesn’t extend to the bulk operations in- </span>
<span id="t1n_217" class="t s1_217">herited from </span><span id="t1o_217" class="t s2_217">Collection—addAll</span><span id="t1p_217" class="t s1_217">, </span><span id="t1q_217" class="t s2_217">containsAll</span><span id="t1r_217" class="t s1_217">, </span><span id="t1s_217" class="t s2_217">retainAll </span><span id="t1t_217" class="t s1_217">and </span><span id="t1u_217" class="t s2_217">removeAll</span><span id="t1v_217" class="t s1_217">—unless the </span>
<span id="t1w_217" class="t s1_217">individual implementation provides it. So it is possible, for example, for </span><span id="t1x_217" class="t s2_217">addAll </span><span id="t1y_217" class="t s1_217">to fail, </span>
<span id="t1z_217" class="t s1_217">throwing an exception, after adding only some of the elements in a collection. </span>
<span id="t20_217" class="t s5_217">14.3.1. Using the Methods of BlockingQueue </span>
<span id="t21_217" class="t s1_217">A to-do manager that works for just one person at a time is very limited; we really need </span>
<span id="t22_217" class="t s1_217">a cooperative solution—one that will allow us to share both the production and the </span>
<span id="t23_217" class="t s1_217">processing of tasks. Example 14-1 shows </span><span id="t24_217" class="t s2_217">StoppableTaskQueue</span><span id="t25_217" class="t s1_217">, a simple version of a </span>
<span id="t26_217" class="t s1_217">concurrent task manager based on </span><span id="t27_217" class="t s2_217">PriorityBlockingQueue</span><span id="t28_217" class="t s1_217">, that will allow its users— </span>
<span id="t29_217" class="t s1_217">us—to independently add tasks to the task queue as we discover the need for them, </span>
<span id="t2a_217" class="t s1_217">and to take them off for processing as we find the time. The class </span><span id="t2b_217" class="t s2_217">StoppableTaskQueue </span>
<span id="t2c_217" class="t s6_217">14.3 </span><span id="t2d_217" class="t s6_217">BlockingQueue </span><span id="t2e_217" class="t s6_217">| </span><span id="t2f_217" class="t s6_217">199 </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
