<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p163" style="overflow: hidden; position: relative; background-color: white; width: 809px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_163{left:109px;bottom:955px;letter-spacing:0.11px;word-spacing:0.05px;}
#t2_163{left:184px;bottom:955px;letter-spacing:0.13px;}
#t3_163{left:59px;bottom:952px;letter-spacing:0.11px;}
#t4_163{left:109px;bottom:902px;letter-spacing:-0.08px;word-spacing:-0.06px;}
#t5_163{left:144px;bottom:903px;letter-spacing:-0.16px;}
#t6_163{left:268px;bottom:902px;letter-spacing:-0.1px;word-spacing:-0.08px;}
#t7_163{left:109px;bottom:881px;letter-spacing:-0.08px;word-spacing:-0.04px;}
#t8_163{left:137px;bottom:859px;letter-spacing:-0.17px;word-spacing:0.05px;}
#t9_163{left:280px;bottom:861px;letter-spacing:-0.15px;}
#ta_163{left:326px;bottom:859px;letter-spacing:-0.08px;word-spacing:-0.01px;}
#tb_163{left:137px;bottom:826px;letter-spacing:-0.16px;word-spacing:-0.01px;}
#tc_163{left:109px;bottom:786px;letter-spacing:-0.09px;word-spacing:0.38px;}
#td_163{left:229px;bottom:787px;letter-spacing:-0.09px;}
#te_163{left:250px;bottom:786px;letter-spacing:-0.1px;}
#tf_163{left:279px;bottom:787px;letter-spacing:-0.18px;}
#tg_163{left:295px;bottom:786px;letter-spacing:-0.07px;word-spacing:0.39px;}
#th_163{left:329px;bottom:787px;}
#ti_163{left:342px;bottom:786px;letter-spacing:-0.08px;word-spacing:0.38px;}
#tj_163{left:109px;bottom:765px;letter-spacing:-0.09px;word-spacing:-0.01px;}
#tk_163{left:137px;bottom:731px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#tl_163{left:393px;bottom:714px;letter-spacing:-0.15px;word-spacing:-0.03px;}
#tm_163{left:109px;bottom:679px;letter-spacing:-0.07px;word-spacing:0.58px;}
#tn_163{left:327px;bottom:680px;letter-spacing:-0.18px;}
#to_163{left:376px;bottom:679px;}
#tp_163{left:385px;bottom:679px;letter-spacing:-0.1px;word-spacing:0.6px;}
#tq_163{left:109px;bottom:658px;letter-spacing:-0.15px;word-spacing:0.44px;}
#tr_163{left:206px;bottom:658px;letter-spacing:-0.09px;word-spacing:0.4px;}
#ts_163{left:109px;bottom:636px;letter-spacing:-0.1px;word-spacing:0.53px;}
#tt_163{left:109px;bottom:615px;letter-spacing:-0.09px;word-spacing:-0.01px;}
#tu_163{left:170px;bottom:582px;letter-spacing:-0.17px;word-spacing:0.04px;}
#tv_163{left:170px;bottom:565px;letter-spacing:-0.17px;}
#tw_163{left:277px;bottom:565px;letter-spacing:-0.16px;}
#tx_163{left:352px;bottom:565px;letter-spacing:-0.16px;word-spacing:0.01px;}
#ty_163{left:170px;bottom:548px;letter-spacing:-0.17px;}
#tz_163{left:277px;bottom:548px;letter-spacing:-0.16px;}
#t10_163{left:352px;bottom:548px;letter-spacing:-0.17px;word-spacing:0.08px;}
#t11_163{left:137px;bottom:512px;letter-spacing:-0.09px;word-spacing:0.05px;}
#t12_163{left:109px;bottom:491px;letter-spacing:-0.1px;word-spacing:1.15px;}
#t13_163{left:109px;bottom:470px;letter-spacing:-0.08px;word-spacing:0.57px;}
#t14_163{left:205px;bottom:470px;letter-spacing:-0.09px;word-spacing:0.58px;}
#t15_163{left:109px;bottom:448px;letter-spacing:-0.12px;word-spacing:0.04px;}
#t16_163{left:137px;bottom:427px;letter-spacing:-0.11px;word-spacing:0.67px;}
#t17_163{left:109px;bottom:405px;letter-spacing:-0.1px;word-spacing:0.08px;}
#t18_163{left:109px;bottom:384px;letter-spacing:-0.09px;word-spacing:-0.15px;}
#t19_163{left:244px;bottom:384px;letter-spacing:-0.19px;word-spacing:0.03px;}
#t1a_163{left:316px;bottom:384px;}
#t1b_163{left:325px;bottom:384px;letter-spacing:-0.08px;word-spacing:-0.14px;}
#t1c_163{left:454px;bottom:385px;}
#t1d_163{left:462px;bottom:384px;letter-spacing:-0.1px;word-spacing:-0.12px;}
#t1e_163{left:618px;bottom:385px;letter-spacing:-0.15px;}
#t1f_163{left:109px;bottom:363px;letter-spacing:-0.14px;word-spacing:0.11px;}
#t1g_163{left:294px;bottom:364px;letter-spacing:-0.16px;}
#t1h_163{left:384px;bottom:363px;letter-spacing:-0.08px;word-spacing:0.04px;}
#t1i_163{left:109px;bottom:341px;letter-spacing:-0.1px;word-spacing:1.13px;}
#t1j_163{left:547px;bottom:343px;letter-spacing:-0.18px;}
#t1k_163{left:602px;bottom:341px;letter-spacing:-0.11px;}
#t1l_163{left:109px;bottom:320px;letter-spacing:-0.11px;word-spacing:0.05px;}
#t1m_163{left:137px;bottom:287px;letter-spacing:-0.16px;word-spacing:0.01px;}
#t1n_163{left:203px;bottom:270px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t1o_163{left:426px;bottom:253px;}
#t1p_163{left:153px;bottom:236px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t1q_163{left:153px;bottom:219px;letter-spacing:-0.14px;}
#t1r_163{left:236px;bottom:219px;letter-spacing:-0.16px;}
#t1s_163{left:153px;bottom:203px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t1t_163{left:170px;bottom:186px;letter-spacing:-0.16px;word-spacing:0.03px;}
#t1u_163{left:170px;bottom:169px;letter-spacing:-0.17px;word-spacing:0.04px;}
#t1v_163{left:137px;bottom:133px;letter-spacing:-0.11px;word-spacing:1.14px;}
#t1w_163{left:109px;bottom:112px;letter-spacing:-0.09px;word-spacing:0.35px;}
#t1x_163{left:578px;bottom:112px;letter-spacing:-0.11px;word-spacing:0.41px;}

.s1_163{font-size:12px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
.s2_163{font-size:15px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s3_163{font-size:17px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s4_163{font-size:14px;font-family:NLEKDK-2bLucidaSans-2dTypew_6pu;color:#000;}
.s5_163{font-size:17px;font-family:NLEKCK-2bTimes-2dBold_6pt;color:#000;}
.s6_163{font-size:17px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts163" type="text/css" >

@font-face {
	font-family: NLEJCK-2bTimes-2dRoman_6ps;
	src: url("fonts/NLEJCK-2bTimes-2dRoman_6ps.woff") format("woff");
}

@font-face {
	font-family: NLEJCL-2bTimes-2dItalic_6pw;
	src: url("fonts/NLEJCL-2bTimes-2dItalic_6pw.woff") format("woff");
}

@font-face {
	font-family: NLEKCK-2bTimes-2dBold_6pt;
	src: url("fonts/NLEKCK-2bTimes-2dBold_6pt.woff") format("woff");
}

@font-face {
	font-family: NLEKDK-2bLucidaSans-2dTypew_6pu;
	src: url("fonts/NLEKDK-2bLucidaSans-2dTypew_6pu.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg163Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg163" style="-webkit-user-select: none;"><object width="809" height="1017" data="163/163.svg" type="image/svg+xml" id="pdf163" style="width:809px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_163" class="t s1_163">CHAPTER 5 </span><span id="t2_163" class="t s1_163">GENERICS </span>
<span id="t3_163" class="t s2_163">142 </span>
<span id="t4_163" class="t s3_163">for a </span><span id="t5_163" class="t s4_163">Chooser&lt;Number&gt;</span><span id="t6_163" class="t s3_163">. This would not compile with the original declaration, but </span>
<span id="t7_163" class="t s3_163">it does once you add the bounded wildcard type to the declaration. </span>
<span id="t8_163" class="t s3_163">Now let’s look at the </span><span id="t9_163" class="t s4_163">union </span><span id="ta_163" class="t s3_163">method from Item 30. Here is the declaration: </span>
<span id="tb_163" class="t s4_163">public static &lt;E&gt; Set&lt;E&gt; union(Set&lt;E&gt; s1, Set&lt;E&gt; s2) </span>
<span id="tc_163" class="t s3_163">Both parameters, </span><span id="td_163" class="t s4_163">s1 </span><span id="te_163" class="t s3_163">and </span><span id="tf_163" class="t s4_163">s2</span><span id="tg_163" class="t s3_163">, are </span><span id="th_163" class="t s4_163">E </span><span id="ti_163" class="t s3_163">producers, so the PECS mnemonic tells us that </span>
<span id="tj_163" class="t s3_163">the declaration should be as follows: </span>
<span id="tk_163" class="t s4_163">public static &lt;E&gt; Set&lt;E&gt; union(Set&lt;? extends E&gt; s1, </span>
<span id="tl_163" class="t s4_163">Set&lt;? extends E&gt; s2) </span>
<span id="tm_163" class="t s3_163">Note that the return type is still </span><span id="tn_163" class="t s4_163">Set&lt;E&gt;</span><span id="to_163" class="t s3_163">. </span><span id="tp_163" class="t s5_163">Do not use bounded wildcard types as </span>
<span id="tq_163" class="t s5_163">return types. </span><span id="tr_163" class="t s3_163">Rather than providing additional flexibility for your users, it would </span>
<span id="ts_163" class="t s3_163">force them to use wildcard types in client code. With the revised declaration, this </span>
<span id="tt_163" class="t s3_163">code will compile cleanly: </span>
<span id="tu_163" class="t s4_163">Set&lt;Integer&gt; integers = Set.of(1, 3, 5); </span>
<span id="tv_163" class="t s4_163">Set&lt;Double&gt; </span><span id="tw_163" class="t s4_163">doubles </span><span id="tx_163" class="t s4_163">= Set.of(2.0, 4.0, 6.0); </span>
<span id="ty_163" class="t s4_163">Set&lt;Number&gt; </span><span id="tz_163" class="t s4_163">numbers </span><span id="t10_163" class="t s4_163">= union(integers, doubles); </span>
<span id="t11_163" class="t s3_163">Properly used, wildcard types are nearly invisible to the users of a class. They </span>
<span id="t12_163" class="t s3_163">cause methods to accept the parameters they should accept and reject those they </span>
<span id="t13_163" class="t s3_163">should reject. </span><span id="t14_163" class="t s5_163">If the user of a class has to think about wildcard types, there is </span>
<span id="t15_163" class="t s5_163">probably something wrong with its API. </span>
<span id="t16_163" class="t s3_163">Prior to Java 8, the type inference rules were not clever enough to handle the </span>
<span id="t17_163" class="t s3_163">previous code fragment, which requires the compiler to use the contextually spec- </span>
<span id="t18_163" class="t s3_163">ified return type (or </span><span id="t19_163" class="t s6_163">target type</span><span id="t1a_163" class="t s3_163">) </span><span id="t1b_163" class="t s3_163">to infer the type of </span><span id="t1c_163" class="t s4_163">E</span><span id="t1d_163" class="t s3_163">. The target type of the </span><span id="t1e_163" class="t s4_163">union </span>
<span id="t1f_163" class="t s3_163">invocation shown earlier is </span><span id="t1g_163" class="t s4_163">Set&lt;Number&gt;</span><span id="t1h_163" class="t s3_163">. If you try to compile the fragment in an </span>
<span id="t1i_163" class="t s3_163">earlier version of Java (with an appropriate replacement for the </span><span id="t1j_163" class="t s4_163">Set.of </span><span id="t1k_163" class="t s3_163">factory), </span>
<span id="t1l_163" class="t s3_163">you’ll get a long, convoluted error message like this: </span>
<span id="t1m_163" class="t s4_163">Union.java:14: error: incompatible types </span>
<span id="t1n_163" class="t s4_163">Set&lt;Number&gt; numbers = union(integers, doubles); </span>
<span id="t1o_163" class="t s4_163">^ </span>
<span id="t1p_163" class="t s4_163">required: Set&lt;Number&gt; </span>
<span id="t1q_163" class="t s4_163">found: </span><span id="t1r_163" class="t s4_163">Set&lt;INT#1&gt; </span>
<span id="t1s_163" class="t s4_163">where INT#1,INT#2 are intersection types: </span>
<span id="t1t_163" class="t s4_163">INT#1 extends Number,Comparable&lt;? extends INT#2&gt; </span>
<span id="t1u_163" class="t s4_163">INT#2 extends Number,Comparable&lt;?&gt; </span>
<span id="t1v_163" class="t s3_163">Luckily there is a way to deal with this sort of error. If the compiler doesn’t </span>
<span id="t1w_163" class="t s3_163">infer the correct type, you can always tell it what type to use with an </span><span id="t1x_163" class="t s6_163">explicit type </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
