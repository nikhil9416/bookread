<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p344" style="overflow: hidden; position: relative; background-color: white; width: 809px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_344{left:333px;bottom:955px;letter-spacing:0.11px;word-spacing:-0.01px;}
#t2_344{left:728px;bottom:953px;letter-spacing:0.15px;}
#t3_344{left:150px;bottom:896px;letter-spacing:-0.08px;word-spacing:0.02px;}
#t4_344{left:233px;bottom:896px;letter-spacing:-0.07px;word-spacing:0.01px;}
#t5_344{left:150px;bottom:857px;letter-spacing:-0.09px;word-spacing:1.16px;}
#t6_344{left:549px;bottom:857px;letter-spacing:-0.1px;word-spacing:1.21px;}
#t7_344{left:634px;bottom:857px;letter-spacing:-0.1px;}
#t8_344{left:150px;bottom:836px;letter-spacing:-0.1px;word-spacing:0.07px;}
#t9_344{left:150px;bottom:814px;letter-spacing:-0.1px;word-spacing:1.21px;}
#ta_344{left:150px;bottom:793px;letter-spacing:-0.11px;word-spacing:0.44px;}
#tb_344{left:150px;bottom:771px;letter-spacing:-0.1px;word-spacing:-0.36px;}
#tc_344{left:150px;bottom:750px;letter-spacing:-0.12px;word-spacing:-0.33px;}
#td_344{left:150px;bottom:729px;letter-spacing:-0.1px;word-spacing:1.35px;}
#te_344{left:150px;bottom:707px;letter-spacing:-0.11px;word-spacing:0.03px;}
#tf_344{left:178px;bottom:686px;letter-spacing:-0.09px;word-spacing:-0.48px;}
#tg_344{left:535px;bottom:687px;letter-spacing:-0.16px;}
#th_344{left:150px;bottom:664px;letter-spacing:-0.11px;word-spacing:-0.37px;}
#ti_344{left:484px;bottom:664px;letter-spacing:-0.19px;word-spacing:-0.35px;}
#tj_344{left:625px;bottom:664px;letter-spacing:-0.09px;word-spacing:-0.34px;}
#tk_344{left:150px;bottom:643px;letter-spacing:-0.12px;word-spacing:-0.51px;}
#tl_344{left:150px;bottom:622px;letter-spacing:-0.11px;word-spacing:0.09px;}
#tm_344{left:150px;bottom:600px;letter-spacing:-0.09px;word-spacing:0.02px;}
#tn_344{left:178px;bottom:567px;letter-spacing:-0.16px;word-spacing:0.05px;}
#to_344{left:150px;bottom:527px;letter-spacing:-0.11px;word-spacing:-0.01px;}
#tp_344{left:178px;bottom:494px;letter-spacing:-0.16px;}
#tq_344{left:150px;bottom:454px;letter-spacing:-0.09px;word-spacing:-0.38px;}
#tr_344{left:150px;bottom:432px;letter-spacing:-0.1px;word-spacing:0.02px;}
#ts_344{left:178px;bottom:399px;letter-spacing:-0.16px;}
#tt_344{left:178px;bottom:359px;letter-spacing:-0.35px;word-spacing:0.37px;}
#tu_344{left:258px;bottom:359px;letter-spacing:-0.1px;}
#tv_344{left:299px;bottom:359px;letter-spacing:-0.11px;word-spacing:0.13px;}
#tw_344{left:150px;bottom:337px;letter-spacing:-0.09px;word-spacing:0.56px;}
#tx_344{left:471px;bottom:339px;letter-spacing:-0.18px;}
#ty_344{left:500px;bottom:337px;letter-spacing:-0.11px;word-spacing:0.45px;}
#tz_344{left:150px;bottom:316px;letter-spacing:-0.08px;word-spacing:0.76px;}
#t10_344{left:150px;bottom:295px;letter-spacing:-0.04px;}
#t11_344{left:176px;bottom:296px;letter-spacing:-0.17px;}
#t12_344{left:256px;bottom:295px;letter-spacing:-0.04px;}
#t13_344{left:276px;bottom:296px;letter-spacing:-0.17px;}
#t14_344{left:355px;bottom:295px;letter-spacing:-0.1px;word-spacing:1.23px;}
#t15_344{left:150px;bottom:273px;letter-spacing:-0.08px;word-spacing:1.25px;}
#t16_344{left:293px;bottom:275px;letter-spacing:-0.16px;}
#t17_344{left:430px;bottom:273px;letter-spacing:-0.11px;word-spacing:1.24px;}
#t18_344{left:150px;bottom:252px;letter-spacing:-0.09px;word-spacing:0.56px;}
#t19_344{left:454px;bottom:253px;letter-spacing:-0.16px;}
#t1a_344{left:661px;bottom:252px;letter-spacing:-0.11px;word-spacing:0.59px;}
#t1b_344{left:150px;bottom:231px;letter-spacing:-0.09px;word-spacing:3.38px;}
#t1c_344{left:150px;bottom:210px;letter-spacing:-0.16px;}
#t1d_344{left:374px;bottom:209px;letter-spacing:-0.08px;word-spacing:-0.01px;}
#t1e_344{left:178px;bottom:188px;letter-spacing:-0.1px;word-spacing:0.63px;}
#t1f_344{left:150px;bottom:166px;letter-spacing:-0.1px;word-spacing:-0.11px;}
#t1g_344{left:150px;bottom:145px;}
#t1h_344{left:164px;bottom:145px;letter-spacing:-0.17px;word-spacing:2.03px;}
#t1i_344{left:243px;bottom:145px;letter-spacing:-0.15px;word-spacing:1.97px;}
#t1j_344{left:150px;bottom:124px;letter-spacing:-0.09px;word-spacing:2.77px;}
#t1k_344{left:243px;bottom:125px;letter-spacing:-0.16px;}
#t1l_344{left:498px;bottom:124px;letter-spacing:-0.09px;word-spacing:2.68px;}
#t1m_344{left:150px;bottom:102px;letter-spacing:-0.14px;word-spacing:0.84px;}

.s1_344{font-size:12px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
.s2_344{font-size:15px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s3_344{font-size:20px;font-family:NLEKCK-2bTimes-2dBold_6pt;color:#000;}
.s4_344{font-size:17px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s5_344{font-size:17px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
.s6_344{font-size:14px;font-family:NLEKDK-2bLucidaSans-2dTypew_6pu;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts344" type="text/css" >

@font-face {
	font-family: NLEJCK-2bTimes-2dRoman_6ps;
	src: url("fonts/NLEJCK-2bTimes-2dRoman_6ps.woff") format("woff");
}

@font-face {
	font-family: NLEJCL-2bTimes-2dItalic_6pw;
	src: url("fonts/NLEJCL-2bTimes-2dItalic_6pw.woff") format("woff");
}

@font-face {
	font-family: NLEKCK-2bTimes-2dBold_6pt;
	src: url("fonts/NLEKCK-2bTimes-2dBold_6pt.woff") format("woff");
}

@font-face {
	font-family: NLEKDK-2bLucidaSans-2dTypew_6pu;
	src: url("fonts/NLEKDK-2bLucidaSans-2dTypew_6pu.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg344Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg344" style="-webkit-user-select: none;"><object width="809" height="1017" data="344/344.svg" type="image/svg+xml" id="pdf344" style="width:809px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_344" class="t s1_344">ITEM 80: PREFER EXECUTORS, TASKS, AND STREAMS TO THREADS </span><span id="t2_344" class="t s2_344">323 </span>
<span id="t3_344" class="t s3_344">Item 80: </span><span id="t4_344" class="t s3_344">Prefer executors, tasks, and streams to threads </span>
<span id="t5_344" class="t s4_344">The first edition of this book contained code for a simple </span><span id="t6_344" class="t s5_344">work queue </span><span id="t7_344" class="t s4_344">[Bloch01, </span>
<span id="t8_344" class="t s4_344">Item 49]. This class allowed clients to enqueue work for asynchronous processing </span>
<span id="t9_344" class="t s4_344">by a background thread. When the work queue was no longer needed, the client </span>
<span id="ta_344" class="t s4_344">could invoke a method to ask the background thread to terminate itself gracefully </span>
<span id="tb_344" class="t s4_344">after completing any work that was already on the queue. The implementation was </span>
<span id="tc_344" class="t s4_344">little more than a toy, but even so, it required a full page of subtle, delicate code, of </span>
<span id="td_344" class="t s4_344">the sort that is prone to safety and liveness failures if you don’t get it just right. </span>
<span id="te_344" class="t s4_344">Luckily, there is no reason to write this sort of code anymore. </span>
<span id="tf_344" class="t s4_344">By the time the second edition of this book came out, </span><span id="tg_344" class="t s6_344">java.util.concurrent </span>
<span id="th_344" class="t s4_344">had been added to Java. This package contains an </span><span id="ti_344" class="t s5_344">Executor Framework</span><span id="tj_344" class="t s4_344">, which is a </span>
<span id="tk_344" class="t s4_344">flexible interface-based task execution facility. Creating a work queue that is better </span>
<span id="tl_344" class="t s4_344">in every way than the one in the first edition of this book requires but a single line </span>
<span id="tm_344" class="t s4_344">of code: </span>
<span id="tn_344" class="t s6_344">ExecutorService exec = Executors.newSingleThreadExecutor(); </span>
<span id="to_344" class="t s4_344">Here is how to submit a runnable for execution: </span>
<span id="tp_344" class="t s6_344">exec.execute(runnable); </span>
<span id="tq_344" class="t s4_344">And here is how to tell the executor to terminate gracefully (if you fail to do this, it </span>
<span id="tr_344" class="t s4_344">is likely that your VM will not exit): </span>
<span id="ts_344" class="t s6_344">exec.shutdown(); </span>
<span id="tt_344" class="t s4_344">You can do </span><span id="tu_344" class="t s5_344">many </span><span id="tv_344" class="t s4_344">more things with an executor service. For example, you can </span>
<span id="tw_344" class="t s4_344">wait for a particular task to complete (with the </span><span id="tx_344" class="t s6_344">get </span><span id="ty_344" class="t s4_344">method, as shown in Item 79, </span>
<span id="tz_344" class="t s4_344">page 319), you can wait for any or all of a collection of tasks to complete (using </span>
<span id="t10_344" class="t s4_344">the </span><span id="t11_344" class="t s6_344">invokeAny </span><span id="t12_344" class="t s4_344">or </span><span id="t13_344" class="t s6_344">invokeAll </span><span id="t14_344" class="t s4_344">methods), you can wait for the executor service to </span>
<span id="t15_344" class="t s4_344">terminate (using the </span><span id="t16_344" class="t s6_344">awaitTermination </span><span id="t17_344" class="t s4_344">method), you can retrieve the results of </span>
<span id="t18_344" class="t s4_344">tasks one by one as they complete (using an </span><span id="t19_344" class="t s6_344">ExecutorCompletionService</span><span id="t1a_344" class="t s4_344">), you </span>
<span id="t1b_344" class="t s4_344">can schedule tasks to run at a particular time or to run periodically (using a </span>
<span id="t1c_344" class="t s6_344">ScheduledThreadPoolExecutor</span><span id="t1d_344" class="t s4_344">), and so on. </span>
<span id="t1e_344" class="t s4_344">If you want more than one thread to process requests from the queue, simply </span>
<span id="t1f_344" class="t s4_344">call a different static factory that creates a different kind of executor service called </span>
<span id="t1g_344" class="t s4_344">a </span><span id="t1h_344" class="t s5_344">thread pool</span><span id="t1i_344" class="t s4_344">. You can create a thread pool with a fixed or variable number of </span>
<span id="t1j_344" class="t s4_344">threads. The </span><span id="t1k_344" class="t s6_344">java.util.concurrent.Executors </span><span id="t1l_344" class="t s4_344">class contains static factories </span>
<span id="t1m_344" class="t s4_344">that provide most of the executors you’ll ever need. If, however, you want some- </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
