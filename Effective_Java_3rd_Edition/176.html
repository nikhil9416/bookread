<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p176" style="overflow: hidden; position: relative; background-color: white; width: 809px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_176{left:349px;bottom:955px;letter-spacing:0.12px;}
#t2_176{left:728px;bottom:953px;letter-spacing:0.15px;}
#t3_176{left:150px;bottom:900px;letter-spacing:-0.11px;word-spacing:0.32px;}
#t4_176{left:253px;bottom:901px;letter-spacing:-0.16px;}
#t5_176{left:369px;bottom:900px;letter-spacing:-0.09px;word-spacing:0.31px;}
#t6_176{left:150px;bottom:878px;letter-spacing:-0.1px;word-spacing:0.76px;}
#t7_176{left:150px;bottom:857px;letter-spacing:-0.08px;}
#t8_176{left:168px;bottom:858px;letter-spacing:-0.18px;}
#t9_176{left:201px;bottom:857px;letter-spacing:-0.09px;word-spacing:-0.29px;}
#ta_176{left:150px;bottom:836px;letter-spacing:-0.1px;word-spacing:0.01px;}
#tb_176{left:178px;bottom:814px;letter-spacing:-0.11px;word-spacing:1.81px;}
#tc_176{left:433px;bottom:816px;letter-spacing:-0.16px;}
#td_176{left:505px;bottom:814px;letter-spacing:-0.09px;word-spacing:1.79px;}
#te_176{left:150px;bottom:793px;letter-spacing:-0.09px;word-spacing:1.64px;}
#tf_176{left:513px;bottom:794px;letter-spacing:-0.16px;}
#tg_176{left:620px;bottom:793px;letter-spacing:-0.31px;word-spacing:1.8px;}
#th_176{left:150px;bottom:771px;letter-spacing:-0.07px;word-spacing:0.08px;}
#ti_176{left:268px;bottom:773px;letter-spacing:-0.16px;}
#tj_176{left:330px;bottom:773px;letter-spacing:-0.15px;}
#tk_176{left:393px;bottom:773px;letter-spacing:-0.16px;}
#tl_176{left:484px;bottom:771px;letter-spacing:-0.1px;word-spacing:0.12px;}
#tm_176{left:150px;bottom:750px;letter-spacing:-0.12px;word-spacing:0.79px;}
#tn_176{left:596px;bottom:751px;letter-spacing:-0.15px;}
#to_176{left:643px;bottom:750px;letter-spacing:-0.13px;}
#tp_176{left:150px;bottom:729px;letter-spacing:-0.09px;word-spacing:1.18px;}
#tq_176{left:150px;bottom:707px;letter-spacing:-0.09px;word-spacing:-0.12px;}
#tr_176{left:264px;bottom:709px;letter-spacing:-0.17px;}
#ts_176{left:347px;bottom:707px;letter-spacing:-0.06px;word-spacing:-0.13px;}
#tt_176{left:458px;bottom:709px;letter-spacing:-0.15px;}
#tu_176{left:504px;bottom:707px;letter-spacing:-0.08px;word-spacing:-0.15px;}
#tv_176{left:150px;bottom:686px;letter-spacing:-0.09px;word-spacing:0.32px;}
#tw_176{left:150px;bottom:664px;letter-spacing:-0.1px;word-spacing:0.01px;}
#tx_176{left:512px;bottom:666px;letter-spacing:-0.16px;}
#ty_176{left:661px;bottom:664px;}
#tz_176{left:178px;bottom:643px;letter-spacing:-0.16px;word-spacing:-0.09px;}
#t10_176{left:339px;bottom:644px;letter-spacing:-0.16px;}
#t11_176{left:425px;bottom:643px;letter-spacing:-0.09px;word-spacing:-0.12px;}
#t12_176{left:150px;bottom:622px;letter-spacing:-0.1px;}
#t13_176{left:178px;bottom:584px;letter-spacing:-0.16px;word-spacing:0.01px;}
#t14_176{left:178px;bottom:567px;letter-spacing:-0.16px;word-spacing:0.02px;}
#t15_176{left:443px;bottom:550px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t16_176{left:211px;bottom:533px;letter-spacing:-0.16px;word-spacing:-0.01px;}
#t17_176{left:409px;bottom:533px;letter-spacing:-0.16px;}
#t18_176{left:211px;bottom:517px;letter-spacing:-0.18px;}
#t19_176{left:244px;bottom:500px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t1a_176{left:211px;bottom:483px;letter-spacing:-0.16px;word-spacing:0.01px;}
#t1b_176{left:244px;bottom:466px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t1c_176{left:211px;bottom:449px;}
#t1d_176{left:211px;bottom:433px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t1e_176{left:244px;bottom:416px;letter-spacing:-0.16px;}
#t1f_176{left:600px;bottom:416px;letter-spacing:-0.18px;}
#t1g_176{left:178px;bottom:399px;}
#t1h_176{left:178px;bottom:359px;letter-spacing:-0.12px;word-spacing:0.5px;}
#t1i_176{left:150px;bottom:337px;letter-spacing:-0.14px;word-spacing:2.88px;}
#t1j_176{left:150px;bottom:316px;letter-spacing:-0.09px;word-spacing:1.86px;}
#t1k_176{left:150px;bottom:295px;letter-spacing:-0.24px;word-spacing:2.77px;}
#t1l_176{left:316px;bottom:296px;letter-spacing:-0.15px;}
#t1m_176{left:364px;bottom:295px;letter-spacing:-0.1px;word-spacing:2.66px;}
#t1n_176{left:150px;bottom:273px;letter-spacing:-0.09px;word-spacing:-0.25px;}
#t1o_176{left:244px;bottom:275px;letter-spacing:-0.18px;}
#t1p_176{left:289px;bottom:273px;letter-spacing:-0.13px;word-spacing:-0.23px;}
#t1q_176{left:150px;bottom:252px;letter-spacing:-0.13px;word-spacing:1.23px;}
#t1r_176{left:530px;bottom:253px;letter-spacing:-0.16px;}
#t1s_176{left:626px;bottom:252px;letter-spacing:-0.09px;word-spacing:1.22px;}
#t1t_176{left:150px;bottom:231px;letter-spacing:-0.1px;}
#t1u_176{left:540px;bottom:232px;letter-spacing:-0.15px;}
#t1v_176{left:619px;bottom:231px;letter-spacing:-0.26px;word-spacing:0.21px;}

.s1_176{font-size:12px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
.s2_176{font-size:15px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s3_176{font-size:17px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s4_176{font-size:14px;font-family:NLEKDK-2bLucidaSans-2dTypew_6pu;color:#000;}
.s5_176{font-size:14px;font-family:NLEMHM-2bLucidaSans-2dTypew_6qf;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts176" type="text/css" >

@font-face {
	font-family: NLEJCK-2bTimes-2dRoman_6ps;
	src: url("fonts/NLEJCK-2bTimes-2dRoman_6ps.woff") format("woff");
}

@font-face {
	font-family: NLEJCL-2bTimes-2dItalic_6pw;
	src: url("fonts/NLEJCL-2bTimes-2dItalic_6pw.woff") format("woff");
}

@font-face {
	font-family: NLEKDK-2bLucidaSans-2dTypew_6pu;
	src: url("fonts/NLEKDK-2bLucidaSans-2dTypew_6pu.woff") format("woff");
}

@font-face {
	font-family: NLEMHM-2bLucidaSans-2dTypew_6qf;
	src: url("fonts/NLEMHM-2bLucidaSans-2dTypew_6qf.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg176Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg176" style="-webkit-user-select: none;"><object width="809" height="1017" data="176/176.svg" type="image/svg+xml" id="pdf176" style="width:809px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_176" class="t s1_176">ITEM 33: CONSIDER TYPESAFE HETEROGENEOUS CONTAINERS </span><span id="t2_176" class="t s2_176">155 </span>
<span id="t3_176" class="t s3_176">The argument, </span><span id="t4_176" class="t s4_176">annotationType</span><span id="t5_176" class="t s3_176">, is a bounded type token representing an annota- </span>
<span id="t6_176" class="t s3_176">tion type. The method returns the element’s annotation of that type, if it has one, </span>
<span id="t7_176" class="t s3_176">or </span><span id="t8_176" class="t s4_176">null</span><span id="t9_176" class="t s3_176">, if it doesn’t. In essence, an annotated element is a typesafe heterogeneous </span>
<span id="ta_176" class="t s3_176">container whose keys are annotation types. </span>
<span id="tb_176" class="t s3_176">Suppose you have an object of type </span><span id="tc_176" class="t s4_176">Class&lt;?&gt; </span><span id="td_176" class="t s3_176">and you want to pass it to a </span>
<span id="te_176" class="t s3_176">method that requires a bounded type token, such as </span><span id="tf_176" class="t s4_176">getAnnotation</span><span id="tg_176" class="t s3_176">. You could </span>
<span id="th_176" class="t s3_176">cast the object to </span><span id="ti_176" class="t s4_176">Class&lt;? </span><span id="tj_176" class="t s4_176">extends </span><span id="tk_176" class="t s4_176">Annotation&gt;</span><span id="tl_176" class="t s3_176">, but this cast is unchecked, so it </span>
<span id="tm_176" class="t s3_176">would generate a compile-time warning (Item 27). Luckily, class </span><span id="tn_176" class="t s4_176">Class </span><span id="to_176" class="t s3_176">provides </span>
<span id="tp_176" class="t s3_176">an instance method that performs this sort of cast safely (and dynamically). The </span>
<span id="tq_176" class="t s3_176">method is called </span><span id="tr_176" class="t s4_176">asSubclass</span><span id="ts_176" class="t s3_176">, and it casts the </span><span id="tt_176" class="t s4_176">Class </span><span id="tu_176" class="t s3_176">object on which it is called to </span>
<span id="tv_176" class="t s3_176">represent a subclass of the class represented by its argument. If the cast succeeds, </span>
<span id="tw_176" class="t s3_176">the method returns its argument; if it fails, it throws a </span><span id="tx_176" class="t s4_176">ClassCastException</span><span id="ty_176" class="t s3_176">. </span>
<span id="tz_176" class="t s3_176">Here’s how you use the </span><span id="t10_176" class="t s4_176">asSubclass </span><span id="t11_176" class="t s3_176">method to read an annotation whose type </span>
<span id="t12_176" class="t s3_176">is unknown at compile time. This method compiles without error or warning: </span>
<span id="t13_176" class="t s5_176">// Use of asSubclass to safely cast to a bounded type token </span>
<span id="t14_176" class="t s4_176">static Annotation getAnnotation(AnnotatedElement element, </span>
<span id="t15_176" class="t s4_176">String annotationTypeName) { </span>
<span id="t16_176" class="t s5_176">Class&lt;?&gt; annotationType </span><span id="t17_176" class="t s4_176">= null; // Unbounded type token </span>
<span id="t18_176" class="t s4_176">try { </span>
<span id="t19_176" class="t s4_176">annotationType = Class.forName(annotationTypeName); </span>
<span id="t1a_176" class="t s4_176">} catch (Exception ex) { </span>
<span id="t1b_176" class="t s4_176">throw new IllegalArgumentException(ex); </span>
<span id="t1c_176" class="t s4_176">} </span>
<span id="t1d_176" class="t s4_176">return element.getAnnotation( </span>
<span id="t1e_176" class="t s5_176">annotationType.asSubclass(Annotation.class)</span><span id="t1f_176" class="t s4_176">); </span>
<span id="t1g_176" class="t s4_176">} </span>
<span id="t1h_176" class="t s3_176">In summary, the normal use of generics, exemplified by the collections APIs, </span>
<span id="t1i_176" class="t s3_176">restricts you to a fixed number of type parameters per container. You can get </span>
<span id="t1j_176" class="t s3_176">around this restriction by placing the type parameter on the key rather than the </span>
<span id="t1k_176" class="t s3_176">container. You can use </span><span id="t1l_176" class="t s4_176">Class </span><span id="t1m_176" class="t s3_176">objects as keys for such typesafe heterogeneous </span>
<span id="t1n_176" class="t s3_176">containers. A </span><span id="t1o_176" class="t s4_176">Class </span><span id="t1p_176" class="t s3_176">object used in this fashion is called a type token. You can also </span>
<span id="t1q_176" class="t s3_176">use a custom key type. For example, you could have a </span><span id="t1r_176" class="t s4_176">DatabaseRow </span><span id="t1s_176" class="t s3_176">type repre- </span>
<span id="t1t_176" class="t s3_176">senting a database row (the container), and a generic type </span><span id="t1u_176" class="t s4_176">Column&lt;T&gt; </span><span id="t1v_176" class="t s3_176">as its key. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
