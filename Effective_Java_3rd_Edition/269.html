<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p269" style="overflow: hidden; position: relative; background-color: white; width: 809px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_269{left:109px;bottom:955px;letter-spacing:0.12px;word-spacing:0.03px;}
#t2_269{left:184px;bottom:955px;letter-spacing:0.14px;}
#t3_269{left:59px;bottom:952px;letter-spacing:0.11px;}
#t4_269{left:109px;bottom:902px;letter-spacing:-0.09px;}
#t5_269{left:148px;bottom:902px;letter-spacing:-0.1px;}
#t6_269{left:223px;bottom:902px;letter-spacing:-0.11px;word-spacing:-0.01px;}
#t7_269{left:109px;bottom:881px;letter-spacing:-0.09px;word-spacing:2.28px;}
#t8_269{left:486px;bottom:882px;letter-spacing:-0.16px;}
#t9_269{left:109px;bottom:859px;letter-spacing:-0.11px;word-spacing:2.06px;}
#ta_269{left:441px;bottom:861px;letter-spacing:-0.16px;}
#tb_269{left:607px;bottom:859px;letter-spacing:-0.1px;word-spacing:2.05px;}
#tc_269{left:109px;bottom:838px;letter-spacing:-0.12px;word-spacing:1.18px;}
#td_269{left:337px;bottom:839px;letter-spacing:-0.16px;}
#te_269{left:502px;bottom:838px;letter-spacing:-0.13px;word-spacing:1.25px;}
#tf_269{left:109px;bottom:816px;letter-spacing:-0.12px;word-spacing:2.88px;}
#tg_269{left:109px;bottom:795px;letter-spacing:-0.11px;}
#th_269{left:137px;bottom:763px;letter-spacing:-0.16px;}
#ti_269{left:137px;bottom:747px;letter-spacing:-0.16px;word-spacing:0.02px;}
#tj_269{left:170px;bottom:730px;letter-spacing:-0.16px;word-spacing:0.02px;}
#tk_269{left:203px;bottom:713px;letter-spacing:-0.16px;word-spacing:0.03px;}
#tl_269{left:137px;bottom:696px;}
#tm_269{left:137px;bottom:662px;letter-spacing:-0.09px;word-spacing:1.45px;}
#tn_269{left:109px;bottom:641px;letter-spacing:-0.11px;word-spacing:0.34px;}
#to_269{left:109px;bottom:619px;letter-spacing:-0.1px;word-spacing:2px;}
#tp_269{left:109px;bottom:598px;letter-spacing:-0.08px;word-spacing:0.03px;}
#tq_269{left:164px;bottom:599px;letter-spacing:-0.16px;}
#tr_269{left:226px;bottom:598px;letter-spacing:-0.08px;word-spacing:-0.02px;}
#ts_269{left:575px;bottom:599px;letter-spacing:-0.16px;}
#tt_269{left:641px;bottom:598px;}
#tu_269{left:137px;bottom:566px;letter-spacing:-0.16px;word-spacing:-0.01px;}
#tv_269{left:137px;bottom:549px;letter-spacing:-0.16px;word-spacing:0.02px;}
#tw_269{left:170px;bottom:533px;letter-spacing:-0.16px;word-spacing:0.03px;}
#tx_269{left:137px;bottom:516px;}
#ty_269{left:137px;bottom:482px;letter-spacing:-0.1px;word-spacing:0.64px;}
#tz_269{left:109px;bottom:460px;letter-spacing:-0.08px;word-spacing:-0.3px;}
#t10_269{left:109px;bottom:439px;letter-spacing:-0.1px;}
#t11_269{left:137px;bottom:407px;letter-spacing:-0.16px;}
#t12_269{left:137px;bottom:390px;letter-spacing:-0.15px;word-spacing:-3.32px;}
#t13_269{left:137px;bottom:363px;letter-spacing:-0.16px;word-spacing:0.02px;}
#t14_269{left:170px;bottom:346px;letter-spacing:-0.16px;word-spacing:-0.02px;}
#t15_269{left:137px;bottom:329px;}
#t16_269{left:109px;bottom:295px;letter-spacing:-0.09px;word-spacing:0.89px;}
#t17_269{left:343px;bottom:295px;letter-spacing:-0.1px;word-spacing:0.85px;}
#t18_269{left:408px;bottom:295px;letter-spacing:-0.11px;word-spacing:0.87px;}
#t19_269{left:568px;bottom:297px;letter-spacing:-0.16px;}
#t1a_269{left:631px;bottom:295px;letter-spacing:-0.08px;}
#t1b_269{left:109px;bottom:274px;letter-spacing:-0.09px;word-spacing:2.04px;}
#t1c_269{left:366px;bottom:275px;letter-spacing:-0.16px;}
#t1d_269{left:455px;bottom:274px;letter-spacing:-0.19px;}
#t1e_269{left:526px;bottom:275px;letter-spacing:-0.16px;}
#t1f_269{left:648px;bottom:274px;letter-spacing:-0.06px;}
#t1g_269{left:109px;bottom:253px;letter-spacing:-0.27px;word-spacing:2.94px;}
#t1h_269{left:189px;bottom:253px;letter-spacing:-0.1px;}
#t1i_269{left:217px;bottom:253px;letter-spacing:-0.09px;word-spacing:2.72px;}
#t1j_269{left:438px;bottom:254px;letter-spacing:-0.16px;}
#t1k_269{left:503px;bottom:253px;letter-spacing:-0.11px;word-spacing:2.72px;}
#t1l_269{left:109px;bottom:231px;letter-spacing:-0.12px;word-spacing:0.05px;}
#t1m_269{left:137px;bottom:200px;letter-spacing:-0.16px;word-spacing:0.01px;}
#t1n_269{left:137px;bottom:183px;letter-spacing:0.17px;word-spacing:0.02px;}
#t1o_269{left:137px;bottom:149px;letter-spacing:-0.21px;word-spacing:0.42px;}
#t1p_269{left:225px;bottom:149px;letter-spacing:-0.18px;word-spacing:0.29px;}
#t1q_269{left:320px;bottom:151px;letter-spacing:-0.18px;}
#t1r_269{left:357px;bottom:149px;letter-spacing:-0.09px;word-spacing:0.27px;}
#t1s_269{left:649px;bottom:149px;letter-spacing:-0.06px;}
#t1t_269{left:109px;bottom:128px;letter-spacing:-0.12px;word-spacing:2.98px;}
#t1u_269{left:109px;bottom:106px;letter-spacing:-0.11px;word-spacing:0.04px;}

.s1_269{font-size:12px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
.s2_269{font-size:15px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s3_269{font-size:17px;font-family:NLEJCK-2bTimes-2dRoman_6ps;color:#000;}
.s4_269{font-size:17px;font-family:NLEJCL-2bTimes-2dItalic_6pw;color:#000;}
.s5_269{font-size:14px;font-family:NLEKDK-2bLucidaSans-2dTypew_6pu;color:#000;}
.s6_269{font-size:14px;font-family:NLEMHM-2bLucidaSans-2dTypew_6qf;color:#000;}
.s7_269{font-size:13px;font-family:NLEKDK-2bLucidaSans-2dTypew_6pu;color:#000;}
.s8_269{font-size:17px;font-family:NLEKCK-2bTimes-2dBold_6pt;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts269" type="text/css" >

@font-face {
	font-family: NLEJCK-2bTimes-2dRoman_6ps;
	src: url("fonts/NLEJCK-2bTimes-2dRoman_6ps.woff") format("woff");
}

@font-face {
	font-family: NLEJCL-2bTimes-2dItalic_6pw;
	src: url("fonts/NLEJCL-2bTimes-2dItalic_6pw.woff") format("woff");
}

@font-face {
	font-family: NLEKCK-2bTimes-2dBold_6pt;
	src: url("fonts/NLEKCK-2bTimes-2dBold_6pt.woff") format("woff");
}

@font-face {
	font-family: NLEKDK-2bLucidaSans-2dTypew_6pu;
	src: url("fonts/NLEKDK-2bLucidaSans-2dTypew_6pu.woff") format("woff");
}

@font-face {
	font-family: NLEMHM-2bLucidaSans-2dTypew_6qf;
	src: url("fonts/NLEMHM-2bLucidaSans-2dTypew_6qf.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg269Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg269" style="-webkit-user-select: none;"><object width="809" height="1017" data="269/269.svg" type="image/svg+xml" id="pdf269" style="width:809px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_269" class="t s1_269">CHAPTER 8 </span><span id="t2_269" class="t s1_269">METHODS </span>
<span id="t3_269" class="t s2_269">248 </span>
<span id="t4_269" class="t s3_269">same </span><span id="t5_269" class="t s4_269">immutable </span><span id="t6_269" class="t s3_269">empty collection repeatedly, as immutable objects may be shared </span>
<span id="t7_269" class="t s3_269">freely (Item 17). Here is the code to do it, using the </span><span id="t8_269" class="t s5_269">Collections.emptyList </span>
<span id="t9_269" class="t s3_269">method. If you were returning a set, you’d use </span><span id="ta_269" class="t s5_269">Collections.emptySet</span><span id="tb_269" class="t s3_269">; if you </span>
<span id="tc_269" class="t s3_269">were returning a map, you’d use </span><span id="td_269" class="t s5_269">Collections.emptyMap</span><span id="te_269" class="t s3_269">. But remember, this is </span>
<span id="tf_269" class="t s3_269">an optimization, and it’s seldom called for. If you think you need it, measure </span>
<span id="tg_269" class="t s3_269">performance before and after, to ensure that it’s actually helping: </span>
<span id="th_269" class="t s6_269">// Optimization - avoids allocating empty collections </span>
<span id="ti_269" class="t s5_269">public List&lt;Cheese&gt; getCheeses() { </span>
<span id="tj_269" class="t s5_269">return cheesesInStock.isEmpty() ? Collections.emptyList() </span>
<span id="tk_269" class="t s5_269">: new ArrayList&lt;&gt;(cheesesInStock); </span>
<span id="tl_269" class="t s5_269">} </span>
<span id="tm_269" class="t s3_269">The situation for arrays is identical to that for collections. Never return null </span>
<span id="tn_269" class="t s3_269">instead of a zero-length array. Normally, you should simply return an array of the </span>
<span id="to_269" class="t s3_269">correct length, which may be zero. Note that we’re passing a zero-length array </span>
<span id="tp_269" class="t s3_269">into the </span><span id="tq_269" class="t s5_269">toArray </span><span id="tr_269" class="t s3_269">method to indicate the desired return type, which is </span><span id="ts_269" class="t s5_269">Cheese[]</span><span id="tt_269" class="t s3_269">: </span>
<span id="tu_269" class="t s6_269">//The right way to return a possibly empty array </span>
<span id="tv_269" class="t s5_269">public Cheese[] getCheeses() { </span>
<span id="tw_269" class="t s5_269">return cheesesInStock.toArray(new Cheese[0]); </span>
<span id="tx_269" class="t s5_269">} </span>
<span id="ty_269" class="t s3_269">If you believe that allocating zero-length arrays is harming performance, you </span>
<span id="tz_269" class="t s3_269">can return the same zero-length array repeatedly because all zero-length arrays are </span>
<span id="t10_269" class="t s3_269">immutable: </span>
<span id="t11_269" class="t s6_269">// Optimization - avoids allocating empty arrays </span>
<span id="t12_269" class="t s5_269">private static final Cheese[] EMPTY_CHEESE_ARRAY = new Cheese[0]; </span>
<span id="t13_269" class="t s5_269">public Cheese[] getCheeses() { </span>
<span id="t14_269" class="t s5_269">return cheesesInStock.toArray(EMPTY_CHEESE_ARRAY); </span>
<span id="t15_269" class="t s5_269">} </span>
<span id="t16_269" class="t s3_269">In the optimized version, we pass </span><span id="t17_269" class="t s4_269">the same </span><span id="t18_269" class="t s3_269">empty array into every </span><span id="t19_269" class="t s5_269">toArray </span><span id="t1a_269" class="t s3_269">call, </span>
<span id="t1b_269" class="t s3_269">and this array will be returned from </span><span id="t1c_269" class="t s5_269">getCheeses </span><span id="t1d_269" class="t s3_269">whenever </span><span id="t1e_269" class="t s5_269">cheesesInStock </span><span id="t1f_269" class="t s3_269">is </span>
<span id="t1g_269" class="t s3_269">empty. Do </span><span id="t1h_269" class="t s4_269">not </span><span id="t1i_269" class="t s3_269">preallocate the array passed to </span><span id="t1j_269" class="t s5_269">toArray </span><span id="t1k_269" class="t s3_269">in hopes of improving </span>
<span id="t1l_269" class="t s3_269">performance. Studies have shown that it is counterproductive [Shipilëv16]: </span>
<span id="t1m_269" class="t s6_269">// Don’t do this - preallocating the array harms performance! </span>
<span id="t1n_269" class="t s7_269">return cheesesInStock.toArray(new Cheese[cheesesInStock.size()]); </span>
<span id="t1o_269" class="t s3_269">In summary, </span><span id="t1p_269" class="t s8_269">never return </span><span id="t1q_269" class="t s6_269">null </span><span id="t1r_269" class="t s8_269">in place of an empty array or collection. </span><span id="t1s_269" class="t s3_269">It </span>
<span id="t1t_269" class="t s3_269">makes your API more difficult to use and more prone to error, and it has no </span>
<span id="t1u_269" class="t s3_269">performance advantages. </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
