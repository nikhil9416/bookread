<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p104" style="overflow: hidden; position: relative; background-color: white; width: 811px; height: 1017px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_104{left:710px;bottom:960px;letter-spacing:-0.13px;}
#t2_104{left:339px;bottom:960px;letter-spacing:-0.14px;word-spacing:0.04px;}
#t3_104{left:156px;bottom:917px;letter-spacing:0.11px;word-spacing:-0.05px;}
#t4_104{left:156px;bottom:898px;letter-spacing:0.1px;word-spacing:0.36px;}
#t5_104{left:156px;bottom:878px;letter-spacing:0.08px;word-spacing:0.03px;}
#t6_104{left:180px;bottom:858px;letter-spacing:0.12px;word-spacing:1.39px;}
#t7_104{left:156px;bottom:838px;letter-spacing:0.1px;word-spacing:-0.28px;}
#t8_104{left:441px;bottom:838px;letter-spacing:0.27px;}
#t9_104{left:539px;bottom:838px;letter-spacing:0.12px;word-spacing:-0.29px;}
#ta_104{left:156px;bottom:818px;letter-spacing:0.13px;word-spacing:3.08px;}
#tb_104{left:620px;bottom:819px;letter-spacing:-0.18px;}
#tc_104{left:664px;bottom:818px;letter-spacing:0.13px;word-spacing:3.14px;}
#td_104{left:156px;bottom:798px;letter-spacing:0.11px;}
#te_104{left:101px;bottom:764px;letter-spacing:-0.47px;}
#tf_104{left:156px;bottom:764px;letter-spacing:0.09px;word-spacing:-0.07px;}
#tg_104{left:156px;bottom:739px;letter-spacing:0.11px;word-spacing:0.02px;}
#th_104{left:156px;bottom:719px;letter-spacing:0.12px;word-spacing:0.44px;}
#ti_104{left:156px;bottom:699px;letter-spacing:0.11px;word-spacing:-0.01px;}
#tj_104{left:563px;bottom:699px;letter-spacing:0.11px;}
#tk_104{left:607px;bottom:699px;letter-spacing:0.12px;word-spacing:-0.02px;}
#tl_104{left:156px;bottom:679px;letter-spacing:0.12px;word-spacing:1.1px;}
#tm_104{left:156px;bottom:659px;letter-spacing:0.09px;word-spacing:0.02px;}
#tn_104{left:180px;bottom:639px;letter-spacing:0.1px;word-spacing:1.74px;}
#to_104{left:156px;bottom:620px;letter-spacing:0.11px;word-spacing:1.53px;}
#tp_104{left:448px;bottom:620px;letter-spacing:0.27px;}
#tq_104{left:540px;bottom:620px;letter-spacing:0.12px;word-spacing:1.5px;}
#tr_104{left:156px;bottom:600px;letter-spacing:0.12px;word-spacing:2.92px;}
#ts_104{left:437px;bottom:600px;letter-spacing:0.27px;}
#tt_104{left:592px;bottom:600px;letter-spacing:0.13px;word-spacing:2.92px;}
#tu_104{left:156px;bottom:580px;letter-spacing:0.27px;}
#tv_104{left:207px;bottom:580px;letter-spacing:0.09px;word-spacing:0.21px;}
#tw_104{left:250px;bottom:580px;letter-spacing:0.26px;}
#tx_104{left:293px;bottom:580px;letter-spacing:0.12px;word-spacing:0.22px;}
#ty_104{left:156px;bottom:560px;letter-spacing:0.01px;word-spacing:0.44px;}
#tz_104{left:270px;bottom:560px;letter-spacing:0.27px;}
#t10_104{left:349px;bottom:560px;letter-spacing:0.07px;word-spacing:0.37px;}
#t11_104{left:638px;bottom:560px;letter-spacing:0.27px;}
#t12_104{left:156px;bottom:540px;letter-spacing:0.12px;word-spacing:-0.01px;}
#t13_104{left:237px;bottom:540px;letter-spacing:0.27px;}
#t14_104{left:390px;bottom:540px;letter-spacing:0.1px;word-spacing:-0.03px;}
#t15_104{left:156px;bottom:511px;letter-spacing:0.13px;}
#t16_104{left:156px;bottom:477px;letter-spacing:0.09px;word-spacing:0.03px;}
#t17_104{left:156px;bottom:449px;letter-spacing:0.13px;}
#t18_104{left:156px;bottom:415px;letter-spacing:0.11px;word-spacing:-0.18px;}
#t19_104{left:326px;bottom:415px;letter-spacing:0.28px;}
#t1a_104{left:369px;bottom:415px;letter-spacing:0.11px;word-spacing:-0.2px;}
#t1b_104{left:654px;bottom:415px;letter-spacing:0.27px;}
#t1c_104{left:156px;bottom:395px;letter-spacing:0.27px;}
#t1d_104{left:248px;bottom:395px;letter-spacing:0.11px;word-spacing:1.63px;}
#t1e_104{left:335px;bottom:395px;letter-spacing:0.27px;}
#t1f_104{left:419px;bottom:395px;letter-spacing:0.12px;word-spacing:1.65px;}
#t1g_104{left:156px;bottom:375px;letter-spacing:0.12px;word-spacing:1.03px;}
#t1h_104{left:156px;bottom:356px;letter-spacing:0.27px;}
#t1i_104{left:238px;bottom:355px;letter-spacing:0.08px;}
#t1j_104{left:256px;bottom:356px;letter-spacing:0.27px;}
#t1k_104{left:287px;bottom:355px;}
#t1l_104{left:156px;bottom:327px;letter-spacing:0.13px;}
#t1m_104{left:156px;bottom:293px;letter-spacing:0.13px;word-spacing:0.05px;}
#t1n_104{left:156px;bottom:273px;letter-spacing:0.12px;word-spacing:-0.16px;}
#t1o_104{left:559px;bottom:273px;letter-spacing:0.27px;}
#t1p_104{left:672px;bottom:273px;letter-spacing:0.15px;}
#t1q_104{left:156px;bottom:253px;letter-spacing:0.12px;word-spacing:1.05px;}
#t1r_104{left:393px;bottom:254px;letter-spacing:-0.19px;}
#t1s_104{left:422px;bottom:253px;letter-spacing:0.12px;word-spacing:1.05px;}
#t1t_104{left:156px;bottom:233px;letter-spacing:0.12px;word-spacing:-0.01px;}
#t1u_104{left:178px;bottom:213px;letter-spacing:0.1px;word-spacing:0.03px;}
#t1v_104{left:156px;bottom:193px;letter-spacing:0.12px;word-spacing:-0.29px;}
#t1w_104{left:494px;bottom:194px;letter-spacing:0.27px;}
#t1x_104{left:630px;bottom:193px;letter-spacing:0.12px;word-spacing:-0.31px;}
#t1y_104{left:156px;bottom:173px;letter-spacing:0.1px;word-spacing:0.01px;}
#t1z_104{left:487px;bottom:174px;letter-spacing:0.27px;}
#t20_104{left:537px;bottom:173px;letter-spacing:0.11px;word-spacing:-0.01px;}
#t21_104{left:156px;bottom:142px;letter-spacing:0.13px;}
#t22_104{left:156px;bottom:126px;letter-spacing:0.13px;word-spacing:0.01px;}
#t23_104{left:224px;bottom:8px;letter-spacing:0.14px;}
#t24_104{left:341px;bottom:3px;letter-spacing:0.13px;}

.s1_104{font-size:14px;font-family:NewBaskerville-Bold_14a;color:#000;}
.s2_104{font-size:14px;font-family:NewBaskerville-BoldItalic_14b;color:#B38000;}
.s3_104{font-size:15px;font-family:NewBaskerville-Roman_-2;color:#000;}
.s4_104{font-size:14px;font-family:Courier_17x;color:#000;}
.s5_104{font-size:14px;font-family:NewBaskerville-Roman_-2;color:#000;}
.s6_104{font-size:16px;font-family:FranklinGothic-DemiItal_19k;color:#224867;}
.s7_104{font-size:15px;font-family:NewBaskerville-Italic_-1;color:#000;}
.s8_104{font-size:12px;font-family:Courier_17x;color:#000;}
.s9_104{font-size:15px;font-family:Helvetica, Arial, sans-serif;color:#000;}
.sa_104{font-size:15px;font-family:Helvetica, Arial, sans-serif;color:#00F;}
.t.v0_104{transform:scaleX(0.901);}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts104" type="text/css" >

@font-face {
	font-family: Courier_17x;
	src: url("fonts/Courier_17x.woff") format("woff");
}

@font-face {
	font-family: FranklinGothic-DemiItal_19k;
	src: url("fonts/FranklinGothic-DemiItal_19k.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-BoldItalic_14b;
	src: url("fonts/NewBaskerville-BoldItalic_14b.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Bold_14a;
	src: url("fonts/NewBaskerville-Bold_14a.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Italic_-1;
	src: url("fonts/NewBaskerville-Italic_-1.woff") format("woff");
}

@font-face {
	font-family: NewBaskerville-Roman_-2;
	src: url("fonts/NewBaskerville-Roman_-2.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg104Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg104" style="-webkit-user-select: none;"><object width="811" height="1017" data="104/104.svg" type="image/svg+xml" id="pdf104" style="width:811px; height:1017px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_104" class="t s1_104">87 </span><span id="t2_104" class="t s2_104">Testing a running application </span>
<span id="t3_104" class="t s3_104">started will be determined in the same way it would be if we were running the applica- </span>
<span id="t4_104" class="t s3_104">tion at the command line. By default, it starts Tomcat listening on port 8080. Option- </span>
<span id="t5_104" class="t s3_104">ally, however, it could start Jetty or Undertow if either of those is in the classpath. </span>
<span id="t6_104" class="t s3_104">The body of the test method is written assuming that the application is running </span>
<span id="t7_104" class="t s3_104">and listening on port 8080. It uses Spring’s </span><span id="t8_104" class="t v0_104 s4_104">RestTemplate </span><span id="t9_104" class="t s3_104">to make a request for a non- </span>
<span id="ta_104" class="t s3_104">existent page and asserts that the response from the server is an </span><span id="tb_104" class="t s5_104">HTTP </span><span id="tc_104" class="t s3_104">404 (not </span>
<span id="td_104" class="t s3_104">found). The test will fail if any other response is returned. </span>
<span id="te_104" class="t s6_104">4.3.1 </span><span id="tf_104" class="t s6_104">Starting the server on a random port </span>
<span id="tg_104" class="t s3_104">As mentioned, the default behavior is to start the server listening on port 8080. That’s </span>
<span id="th_104" class="t s3_104">fine for running a single test at a time on a machine where no other server is already </span>
<span id="ti_104" class="t s3_104">listening on port 8080. But if you’re like me, you’ve probably </span><span id="tj_104" class="t s7_104">always </span><span id="tk_104" class="t s3_104">got something lis- </span>
<span id="tl_104" class="t s3_104">tening on port 8080 on your local machine. In that case, the test would fail because </span>
<span id="tm_104" class="t s3_104">the server wouldn’t start due to the port collision. There must be a better way. </span>
<span id="tn_104" class="t s3_104">Fortunately, it’s easy enough to ask Spring Boot to start up the server on a ran- </span>
<span id="to_104" class="t s3_104">domly selected port. One way is to set the </span><span id="tp_104" class="t v0_104 s4_104">server.port </span><span id="tq_104" class="t s3_104">property to 0 to ask Spring </span>
<span id="tr_104" class="t s3_104">Boot to select a random available port. </span><span id="ts_104" class="t v0_104 s4_104">@WebIntegrationTest </span><span id="tt_104" class="t s3_104">accepts an array of </span>
<span id="tu_104" class="t v0_104 s4_104">String </span><span id="tv_104" class="t s3_104">for its </span><span id="tw_104" class="t v0_104 s4_104">value </span><span id="tx_104" class="t s3_104">attribute. Each entry in the array is expected to be a name/value </span>
<span id="ty_104" class="t s3_104">pair, in the form </span><span id="tz_104" class="t v0_104 s4_104">name=value</span><span id="t10_104" class="t s3_104">, to set properties for use in the test. To set </span><span id="t11_104" class="t v0_104 s4_104">server.port </span>
<span id="t12_104" class="t s3_104">you can use </span><span id="t13_104" class="t v0_104 s4_104">@WebIntegrationTest </span><span id="t14_104" class="t s3_104">like this: </span>
<span id="t15_104" class="t s8_104">@WebIntegrationTest(value={"server.port=0"}) </span>
<span id="t16_104" class="t s3_104">Or, because there’s only one property being set, it can take a simpler form: </span>
<span id="t17_104" class="t s8_104">@WebIntegrationTest("server.port=0") </span>
<span id="t18_104" class="t s3_104">Setting properties via the </span><span id="t19_104" class="t v0_104 s4_104">value </span><span id="t1a_104" class="t s3_104">attribute is handy in the general sense, but </span><span id="t1b_104" class="t v0_104 s4_104">@WebInte- </span>
<span id="t1c_104" class="t v0_104 s4_104">grationTest </span><span id="t1d_104" class="t s3_104">also offers a </span><span id="t1e_104" class="t v0_104 s4_104">randomPort </span><span id="t1f_104" class="t s3_104">attribute for a more expressive way of asking </span>
<span id="t1g_104" class="t s3_104">the server to be started on a random port. You can ask for a random port by setting </span>
<span id="t1h_104" class="t v0_104 s4_104">randomPort </span><span id="t1i_104" class="t s3_104">to </span><span id="t1j_104" class="t v0_104 s4_104">true</span><span id="t1k_104" class="t s3_104">: </span>
<span id="t1l_104" class="t s8_104">@WebIntegrationTest(randomPort=true) </span>
<span id="t1m_104" class="t s3_104">Now that we have the server starting on a random port, we need to be sure we use the </span>
<span id="t1n_104" class="t s3_104">correct port when making web requests. At the moment, the </span><span id="t1o_104" class="t v0_104 s4_104">getForObject() </span><span id="t1p_104" class="t s3_104">method </span>
<span id="t1q_104" class="t s3_104">is hard-coded with port 8080 in its </span><span id="t1r_104" class="t s5_104">URL</span><span id="t1s_104" class="t s3_104">. If the port is randomly chosen, how can we </span>
<span id="t1t_104" class="t s3_104">construct the request to use the right port? </span>
<span id="t1u_104" class="t s3_104">First we’ll need to inject the chosen port as an instance variable. To make this con- </span>
<span id="t1v_104" class="t s3_104">venient, Spring Boot sets a property with the name </span><span id="t1w_104" class="t v0_104 s4_104">local.server.port </span><span id="t1x_104" class="t s3_104">to the value of </span>
<span id="t1y_104" class="t s3_104">the chosen port. All we need to do is use Spring’s </span><span id="t1z_104" class="t v0_104 s4_104">@Value </span><span id="t20_104" class="t s3_104">to inject that property: </span>
<span id="t21_104" class="t s8_104">@Value("${local.server.port}") </span>
<span id="t22_104" class="t s8_104">private int port; </span>
<span id="t23_104" class="t s9_104">Licensed to Thomas Snead &lt;n.ordickan@gmail.com&gt; </span>
<span id="t24_104" class="t sa_104">www.it-ebooks.info </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
